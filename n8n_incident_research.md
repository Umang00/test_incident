# n8n Incident Management Workflow Research

## Executive Summary

This report identifies the optimal n8n workflow templates to build the **AI-Powered Incident Triage System** described in the `incident-management` repository.

**Key Finding:** No single template does _everything_ (PagerDuty + RAG + Gemini + Qdrant), but **Template 2840** ("Automate SIEM Alert Enrichment") provides the exact architectural skeleton needed. By combining it with **Template 5140** (Gemini + Qdrant RAG), we can achieve the desired system with minimal custom development.

---

## ðŸ† Top Recommendations

### 1. The Core Logic Skeleton: Template 2840

**Name:** Automate SIEM Alert Enrichment with MITRE ATT&CK, Qdrant & Zendesk  
**ID:** `2840`  
**URL:** [https://n8n.io/workflows/2840](https://n8n.io/workflows/2840)  
**Why it fits:**

- **Architecture Match:** Triggers on an alert $\rightarrow$ Queries Vector DB (Qdrant) for context $\rightarrow$ Updates a Ticket (Zendesk).
- **Adaptability:**
  - Replace **Chat Trigger** with **PagerDuty Trigger**.
  - Replace **Zendesk** with **PagerDuty (Update Incident)**.
  - The _logic_ (Embedding $\rightarrow$ Qdrant Search $\rightarrow$ LLM Analysis) is already built.

### 2. The RAG Engine: Template 5140

**Name:** Build and Update RAG System with Google Drive, Qdrant, and Gemini Chat  
**ID:** `5140`  
**URL:** [https://n8n.io/workflows/5140](https://n8n.io/workflows/5140)  
**Why it fits:**

- **Stack Match:** Specifically uses **Google Gemini** and **Qdrant**, exactly as requested in your repository's README.
- **Role:** This template handles the _ingestion_ side (loading documents into Qdrant) and the _retrieval_ logic specific to Gemini.

---

## ðŸ—ï¸ Proposed Architecture (The "Remix")

To build your **AI SOC Analyst**, we recommend merging these two templates:

**Workflow A: The Knowledge Builder (Ingestion)**

- _Based on Template 5140_
- **Trigger:** Schedule or Manual (when new runbooks/logs are added).
- **Action:** Read PDFs/Docs $\rightarrow$ Generate Embeddings (Gemini) $\rightarrow$ Upsert to Qdrant.

**Workflow B: The Incident Triage Bot (Runtime)**

- _Based on Template 2840_
- **Trigger:** **PagerDuty Trigger** (New Incident).
- **Step 1:** Extract Incident Title/Description.
- **Step 2 (RAG):** Query **Qdrant** for similar past incidents or runbooks (using logic from Tmpl 5140).
- **Step 3 (Analysis):** Send Incident + Retrieved Context to **Gemini Pro**.
  - _Prompt:_ "Analyze this incident based on these similar past cases and runbooks..."
- **Step 4:** **PagerDuty Node** (Update Incident Note) with the AI analysis.

---

## ðŸ¤– Gemma + Qdrant Specifics

User passed a specific request for **Gemma** (Google's open model) + **Qdrant**.

**Best Fit: Template 4219 ("Web Content to Vector DB")**

- **URL:** [https://n8n.io/workflows/4219](https://n8n.io/workflows/4219)
- **Native Stack:** Claude + **Ollama** + **Qdrant**.
- **Adaptation:** This is the closest starting point. You simply change the "Claude" node to an **Ollama Chat Model** node (set to `gemma`).
- **Why:** It already has the _Ollama Embeddings_ -> _Qdrant_ plumbing pre-configured.

**Alternative: Template 5858 (+ Qdrant)**

- **URL:** [https://n8n.io/workflows/5858](https://n8n.io/workflows/5858)
- **Native Stack:** **Gemma 3 (via Ollama)** + File Processing.
- **Adaptation:** Add a **Qdrant Vector Store** node to the end of this workflow to store the summaries/embeddings generated by Gemma.

---

## ðŸ“‚ Other Notable Findings

| ID       | Name                                         | Relevance | Use Case                                                                           | URL                                   |
| :------- | :------------------------------------------- | :-------- | :--------------------------------------------------------------------------------- | :------------------------------------ |
| **4379** | Website Downtime Alert via LINE + Supabase   | High      | Simple monitoring loop. Good if you need to _detect_ downtime, not just manage it. | [Link](https://n8n.io/workflows/4379) |
| **4400** | RAG System with Mistral OCR, Qdrant & Gemini | Medium    | Alternative RAG pipeline if you need to process scanned PDFs/images.               | [Link](https://n8n.io/workflows/4400) |
| **5768** | SSL Certificate Monitoring                   | Medium    | Specific use case (SSL expiry) that could feed into the main incident workflow.    | [Link](https://n8n.io/workflows/5768) |

## Next Steps

1.  **Install Template 2840** to understand the enrichment flow.
2.  **Install Template 5140** to set up the Qdrant/Gemini integration.
3.  **Configure PagerDuty Credential** in n8n (if not already set).
4.  **Merge** the PagerDuty Trigger into the logic of Template 2840.
