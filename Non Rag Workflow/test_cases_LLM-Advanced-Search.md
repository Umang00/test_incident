# Non-RAG Incident Response - Test Cases (LLM Advanced Search)

Use these realistic **System Alerts** to test the "LLM + Advanced Search" workflow. Paste these into the chat as if they were automated notifications.

> **SCOPE:**
>
> - **Workflow:** AI Agent + one search tool at a time (Tavily OR SerpAPI â€” swapped and compared).
> - **Configurations Tested:** Config A (Tavily, Auto Parameters) and Config C (SerpAPI, Auto Parameters) only.
> - **All hard test cases use real, NVD/AWS/GitHub-verified data.** Ground truth answers are included for objective grading.

> [!NOTE]
> **On Manual Parameter Configs (B & D) â€” Closed:**
> Config B (Tavily, Manual Parameters) and Config D (SerpAPI, Manual Parameters) were not tested. For Tavily, auto-parameters represent the intended AI-native usage and performed well â€” manual constraints would reduce flexibility without demonstrated upside. For SerpAPI, the root failure mode was not excess freedom but **specific incompatible parameters** being auto-generated (`output`, `uule`+`location`, `q`). The correct fix is **hardcoded parameter exclusion guard rails** in the tool config, not switching to manual mode. Manual parameters would introduce a different brittleness without solving the underlying issue. Both configs are closed as out-of-scope for this evaluation cycle.

---

## ðŸŸ¢ Easy / Common Scenarios (Baseline â€” Minimal Search Expected)

_The agent should NOT over-search here. A good result = knowing when NOT to invoke the tool._

### 1. Classic Infrastructure Failure (Disk Full)

**Goal:** Verify the agent does NOT fire the search tool for something internal knowledge resolves.

```text
[ALERT] Filesystem /var/lib/mysql is 98% full
Severity: High
Host: db-prod-01
Mount: /dev/sda1
Message: no space left on device. Write operations failing.
```

- **Expectation:** Zero or one search call at most. Internal knowledge resolves it: `du -sh /var/lib/mysql/*`, purge binary logs, expand disk.
- **Regression check:** If the agent invokes Tavily/SerpAPI for "disk full mysql" â€” that's over-triggering, not a win.

#### ðŸ“Š Analysis Results â€” Config A (Tavily, Auto Parameters)

**Did any model invoke search?**

- **5 out of 7 did NOT search.** This confirms the "easy" expectation â€” the baseline triage is within pre-trained knowledge.
- **2 models (Sonnet 4.5, Opus 4.5) DID search** and retrieved real MySQL bug documentation (`Bug #45173`, `Bug #118356`) â€” resulting in higher-quality advice on `ibdata1` shrink procedures and large-transaction crash mechanics.
- **Verdict: Zero search for disk full = correct behavior. Searching with purpose (ibdata1 edge cases) = also correct. Searching for "disk full mysql" generically = over-triggering.**

| Model                        | Tokens | Searched?  | Rating       | Key Strengths                                                                                                                                                                                                                 | Weaknesses                                                                                                                                                                                                                                                     |
| ---------------------------- | ------ | ---------- | ------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Claude Opus 4.5**          | 11729  | âœ… Yes (2) | ðŸŸ¢ **Best**  | Cited real Bug #118356 (crash on binlog spill, mysql.com confirmed). `#innodb_temp` / `ibtmp1` for temp tablespace. Quick Reference Card format. `binlog_expire_logs_auto_purge`. Relay log section for replica environments. | Highest token count by far (11.7k). Overkill for a standard disk-full incident.                                                                                                                                                                                |
| **Claude Sonnet 4.5**        | 8325   | âœ… Yes (3) | ðŸŸ¢ **Best**  | Cited real Bug #45173 (ibdata1 never shrinks â€” Percona confirmed). Full ibdata1 dump/restore procedure sourced from MySQL docs. `innodb_undo_log_truncate`, `innodb_file_per_table`. SET GLOBAL `read_only=1` first.          | 8.3k tokens for a disk-full case. The `read_only=1` line then `SET GLOBAL read_only = 0` later is correct but requires careful ordering.                                                                                                                       |
| **GPT-5.2**                  | 2889   | âŒ No      | ðŸŸ¢ **Great** | Best no-search entry. `lsof +L1` for deleted-but-open files (unique among no-search models). `read_only=1` first. Explicit replica check (`SHOW REPLICA STATUS`) before purging. `df -hi` inode exhaustion check.             | No ibdata1 or temp tablespace coverage.                                                                                                                                                                                                                        |
| **Qwen3.5 Plus**             | 2911   | âŒ No      | ðŸŸ¢ **Great** | Most comprehensive `my.cnf` section. `ENOSPC` correct OS error identification. Truncate trick (`> logfile`) for slow query log. Correctly noted 98% as a "rapid growth" signal vs gradual growth.                             | **`rm /var/lib/mysql/mysql-bin.0[0-9][0-9]`** â€” manual deletion of binlogs without updating the binlog index can corrupt replication. Should use `PURGE BINARY LOGS` exclusively.                                                                              |
| **GLM-4.7**                  | 2944   | âŒ No      | ðŸŸ¢ **Great** | Only no-search model to mention `ibtmp1` / InnoDB temp tablespace. Write-verification touch test is a nice UX touch. Correctly warned against manually deleting data files.                                                   | No replica check before binlog purge. `FLUSH SLOW LOGS` before truncation isn't explicitly mentioned (needed for safe log rotation while MySQL is running).                                                                                                    |
| **Kimi-K2.5**                | 2554   | âŒ No      | ðŸŸ¡ **Good**  | Clean structure. Identified all main culprits. Emergency space reclamation section.                                                                                                                                           | **`max_slowlog_size` / `max_slowlog_files`** are **Percona Server for MySQL extensions, NOT standard MySQL options.** Presenting them as standard `my.cnf` options for MySQL Community/Enterprise is incorrect. No replica check before purge. No inode check. |
| **Gemini Pro 3 Pro Preview** | 2891   | âŒ No      | ðŸŸ¡ **Good**  | `truncate -s 0` for log reclamation (correct â€” preserves inode, avoids recreate). Emergency "free 500MB first" heuristic is practical. Binary log purge syntax correct.                                                       | No `lsof +L1` check, no inode check. No replica check before binlog purge. Shallowest coverage of the no-search set.                                                                                                                                           |

> **Key Learnings:**
>
> 1. **Config A (Tavily, Auto) has a correct abstinence rate of 5/7 for an easy case** â€” the majority of models correctly didn't search. Over-triggering would have been the failure mode here.
> 2. **Search added real value when targeted at edge cases.** Sonnet and Opus used search to find ibdata1 Bug #45173 (documented ibdata1 never-shrinks behavior) and Bug #118356 (large-transaction crash on binlog disk fill). These are genuinely harder to know from training data alone.
> 3. **The no-search winner is GPT-5.2** â€” `lsof +L1`, `df -hi`, and replica safety check are the three steps that separate a production-ready triage from a basic one.
> 4. **Kimi's `max_slowlog_size`/`max_slowlog_files` are Percona-only** â€” they don't exist in standard MySQL 8.0 CE/EE. A DBA applying this `my.cnf` block to a standard MySQL instance would see startup errors.
> 5. **Qwen's `rm mysql-bin.0*`** is dangerous without updating the binlog index. Always use `PURGE BINARY LOGS` â€” this is the most important safety rule in MySQL disk recovery.
> 6. **ibdata1 shrink requires dump + destroy + restore** â€” this is the biggest "unknown unknown" for disk-full incidents. Only the two search-enabled models surfaced this via real documentation references.
> 7. **Token economy:** The 2 search-using models consumed 8,325 and 11,729 tokens respectively vs 2,500â€“2,944 for no-search models. For this case, that's a 4xâ€“5x cost for incrementally better advice on an edge case (ibdata1). Cost vs value tradeoff depends on instance size.

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **5 out of 7 did NOT search** â€” same correct abstinence rate as Config A. The easy case behaved predictably across both search tool backends.
- **2 models (Sonnet 4.5, Opus 4.5) DID search** and cited real MySQL documentation and Stack Overflow sources â€” similar to Config A, but with one critical difference: both Sonnet and Opus encountered **SerpAPI parameter failures on 1â€“3 earlier attempts** before producing the final output.
- **GLM-4.7 attempted to search on its first try but immediately failed** (`Missing parameter 'q'` error) â€” then succeeded on a second try without searching.
- **Gemini Pro 3 Pro Preview had 2 failed search attempts** with SerpAPI parameter errors (`location` + `uule` used together; then unsupported location format `US 2025`) before completing on a 3rd try without searching.
- **Verdict: The SerpAPI "Auto Parameters" configuration is brittle** â€” the agent generated invalid parameter combinations 6 times across this test alone. The search tool itself works, but the agent's default parameter construction for SerpAPI is error-prone. This is a **Config C structural weakness vs Config A.**

| Model                        | Tokens                          | Searched?                 | Rating       | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                              | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ---------------------------- | ------------------------------- | ------------------------- | ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Claude Opus 4.5**          | 3551 (failed) + 43538           | âœ… Yes (3, 2nd try)       | ðŸŸ¢ **Best**  | Cited real docker-library/mysql GitHub issues (#122, #219) and laradock/issues/899 confirming errno 28 = no space. MySQL official docs for PURGE BINARY LOGS and `binlog_expire_logs_seconds`. `lsof +L1` for deleted-but-open files with `/proc/<PID>/fd/<FD>` truncation trick (unique). logrotate template with `mysqladmin flush-logs` postrotate. `binlog_transaction_compression = ON` (MySQL 8.0.20+, âœ… 30-50% savings confirmed). | `log_bin_trust_function_creators = 1` listed under "Proactive binlog management" and described as "if using stored procedures" â€” **incorrect**: this variable applies to stored _functions_, not procedures, and has been **deprecated since MySQL 8.0.34** (removal pending). Presenting it as a standard hardening step is misleading for 8.0.34+ environments. Highest token count by far (43.5k on 2nd try).                                                                                             |
| **Claude Sonnet 4.5**        | 4896+4988+5002 (failed) + 41619 | âœ… Yes (3, 4th try)       | ðŸŸ¢ **Best**  | Cited SO #45866902 (binlog filling drive â€” community-confirmed). SO #76421985 (cleaning binlogs when MySQL is off). MySQL Enterprise Backup FAQ citing ibdata1 never-shrinks by design. `PURGE BINARY LOGS BEFORE NOW() - INTERVAL 7 DAY` â€” correct DATETIME syntax âœ…. `innodb_file_per_table=1` discussion. Separate filesystem recommendation for `/var/lib/mysql`.                                                                     | **`rm /var/lib/mysql/mysql-bin.000001`** stated as an option "if MySQL is down" â€” **dangerous**: manual deletion without updating `mysql-bin.index` will cause MySQL startup failure and replication corruption on restart. Always use `PURGE BINARY LOGS` or `mysqlbinlogpurge`. **3 failed SerpAPI attempts** before final output (same `output` parameter error). `PURGE BINARY LOGS BEFORE NOW() - INTERVAL 7 DAY` is valid but omits the replica safety check, which Sonnet's Config A output included. |
| **GPT-5.2**                  | 3243                            | âŒ No                     | ðŸŸ¢ **Great** | Strongest no-search output: `lsof +L1` (deleted-but-open files), `df -i` inode exhaustion check, `super_read_only=ON` + `read_only=ON` pair (correct ordering), `SHOW REPLICA STATUS\G` before purge. `SET PERSIST binlog_expire_logs_seconds = 7*24*60*60` (persists across restart without editing my.cnf â€” MySQL 8.0 only). `-xhd1` flag on `du` to stay on same filesystem (prevents cross-mount counting errors).                     | No ibtmp1 or temp tablespace coverage. No `logrotate` configuration example.                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Qwen3.5 Plus**             | 3672                            | âŒ No                     | ðŸŸ¢ **Great** | `ENOSPC` correct OS kernel error code identification. `ext4/xfs` fragmentation behavior at >95% is accurate. `/proc/<PID>/fd/<FD>` truncation for deleted-but-open files âœ…. Prometheus alert query (`node_filesystem_avail_bytes`) is production-grade. `innodb_file_per_table = 1` recommendation. MITRE DoS note is contextually relevant (disk exhaustion can be attacker-induced).                                                    | Sources listed (MySQL docs, Percona Blog, Red Hat Customer Portal) are cited by name only â€” no URLs, and Percona/Red Hat citations were not actually searched (note: no search was used). Not verifiable as inaccurate but not verifiable as accurate either.                                                                                                                                                                                                                                                |
| **Gemini Pro 3 Pro Preview** | 2854+2755+3655 (3rd try)        | âŒ No (2 failed attempts) | ðŸŸ¢ **Great** | `innodb_temp_data_file_path = ibtmp1:12M:autoextend:max:5G` to cap ibtmp1 growth â€” âœ… correct MySQL variable (`innodb_temp_data_file_path` is the authoritative control). Correctly identified that `systemctl restart mysql` is required to shrink ibtmp1 (unlike binlogs, temp tablespace only releases on restart âœ…). Volume expansion mention (EBS equivalent) is cloud-practical.                                                    | **Two SerpAPI parameter errors** (`location` + `uule` conflict; then `US 2025` unsupported location format) consumed 2 extra runs. In the final output, Gemini claimed "(Internal Knowledge Applied)" but this is the same as Config A â€” no advantage from SerpAPI availability.                                                                                                                                                                                                                             |
| **Kimi-K2.5**                | 3127                            | âŒ No                     | ðŸŸ¡ **Good**  | Clean structure. Replication safety check (`SHOW SLAVE STATUS`). `relay_log_recovery = ON` prevention tip. `mysqlcheck --optimize` for fragmented table cleanup. Core dump pattern (`mysqld.core`) identified as space consumer.                                                                                                                                                                                                           | No `lsof +L1` check. No inode check. `du -ah --max-depth=1` â€” `--max-depth` is a non-POSIX GNU extension (works on Linux but not all UNIX). No `ibtmp1` or temp tablespace coverage. Same weaknesses as Config A output â€” SerpAPI availability provided no benefit.                                                                                                                                                                                                                                          |
| **GLM-4.7**                  | 3188 (failed) + 3351            | âŒ No (1 failed attempt)  | ðŸŸ¡ **Good**  | `#sql*.ibd` orphaned temp file detection and cleanup â€” genuine value-add (abandoned temp files from crashed ALTER TABLE operations). `CREATE DATABASE test_space_check; DROP DATABASE test_space_check` write-verification. Clean two-scenario resolution (binlogs vs temp tables).                                                                                                                                                        | **First try failed** due to missing `q` parameter in SerpAPI call â€” SerpAPI requires `q` as the mandatory search query field; the agent submitted a search without this. 2nd try correctly bypassed search. `ls -lh /var/lib/mysql/*.ibd \| sort -k5 -rh` â€” sorting `.ibd` by column 5 is unreliable (`ls -lh` column positions vary by filename length); should use `du -sh *.ibd \| sort -rh`. No `lsof +L1`. No `super_read_only`.                                                                        |

> **Key Learnings:**
>
> 1. **SerpAPI Auto Parameters is structurally brittle for this test case** â€” 6 failed search attempts across GLM (1), Gemini (2), Sonnet (3 separate runs). The agent constructs invalid SerpAPI parameters when left to auto-configure: `location` + `uule` used together (conflicting SerpAPI params), unsupported location strings (`US 2025`), and missing the mandatory `q` field. Config A (Tavily Auto) had zero parameter failures on this case.
> 2. **Both Claude models needed 4+ workflow runs to get a clean output** â€” Sonnet required 4 total attempts (3 failed on `output` parameter), Opus required 2. This is a reliability tax on Config C that doesn't exist in Config A. Budget 2â€“4x more runs when SerpAPI Auto is used until parameter generation is hardened.
> 3. **The no-search winner remains GPT-5.2** â€” `super_read_only=ON`, `df -i` inode check, `lsof +L1`, `SET PERSIST` for runtime-persistent config, and replica safety check before purge. These 5 elements together compose a production-grade runbook. GPT-5.2 was consistent across Config A and C â€” its quality is internal-knowledge-driven, not tool-dependent.
> 4. **Gemini's `innodb_temp_data_file_path` tip is the unique Config C value-add** â€” capping `ibtmp1` at a max size (e.g., `max:5G`) prevents a runaway temp tablespace from eating the disk during complex query storms. This variable is underused in standard hardening guides and was only surfaced in Config C, not Config A.
> 5. **Opus's `log_bin_trust_function_creators` is wrong in context** â€” it applies to stored _functions_ (not procedures) and has been deprecated since MySQL 8.0.34. Recommending it as a standard hardening step under "proactive binlog management" is a category error and outdated guidance.
> 6. **Sonnet's manual `rm mysql-bin.*` suggestion is the most dangerous claim in this test** â€” deleting binary log files manually corrupts the `mysql-bin.index` file. MySQL will refuse to start (or start with a broken binlog state), and replication will break. The **only** safe approach is `PURGE BINARY LOGS` via the MySQL client.
> 7. **`binlog_transaction_compression = ON` (Opus) is verified** â€” MySQL 8.0.20+, compresses transaction payloads using zstd, achieves 29â€“58% size reduction in benchmarks (Oracle docs confirmed). Legitimate long-term disk management for high-write MySQL 8.0 instances.
> 8. **Token cost of search failures is significant** â€” Sonnet's 3 failed runs consumed 14,886 tokens before the successful 41,619-token run. Total: ~56.5k tokens for what should be a no-search case. Config A Sonnet consumed 8,325 for the same incident. Config C reliability failure = 6.8x cost multiplier in this case.

### 2. Common Security Pattern (SSH Brute Force)

**Goal:** IP reputation lookup. See if manual domain hints yield more structured results than auto.

```text
[ALERT] Suspicious Login Activity detected
Source IP: 45.132.89.21 (Russia)
User: root
Events: 240 failed password attempts in 60 seconds
Protocol: SSH
```

- **Expectation:** Brute Force classification (MITRE T1110). One search for IP reputation. Recommends `fail2ban`, block IP, `PermitRootLogin no`.
- **Manual vs Auto Delta:** Manual config with system prompt hinting `site:abuseipdb.com` gives a structured abuse confidence score. Auto may return a generic AbuseIPDB page link without the actual score.

#### ðŸ“Š Analysis Results â€” Config A (Tavily, Auto Parameters)

**Did any model invoke search?**

- **5 out of 6 functional models searched** â€” appropriate for a security incident requiring IP reputation and threat context.
- **Gemini Pro 3 Pro Preview FAILED** â€” entered a search loop on IP WHOIS/ASN data (45.132.89.21), hit max iterations (10 then 20). **This is the critical failure of Config A.**
- **Verdict: Searching for SSH brute force threat context = correct. Looping on IP WHOIS metadata = agent loop failure mode.**

| Model                        | Tokens  | Searched?  | Rating        | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                            | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                         |
| ---------------------------- | ------- | ---------- | ------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Claude Sonnet 4.5**        | 11905   | âœ… Yes (2) | ðŸŸ¢ **Best**   | `systemctl reload sshd` (not restart â€” preserves sessions). Unique `âš ï¸ CRITICAL REMINDER` before disabling PasswordAuthentication to avoid lockout. `sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak.$(date +%F)` backup before editing. `sudo sshd -t && sudo systemctl reload sshd` safe validate-then-reload pattern.                                                                                                                           | AS211935 / 45.132.0.0/16 reputation claim not verified via authoritative source in output â€” stated as contextual inference only (which is honest).                                                                                                                                                                                                                                                 |
| **Claude Opus 4.5**          | 9058    | âœ… Yes (2) | ðŸŸ¢ **Best**   | Cited real 2.8M IP brute-force campaign (Jan 2025, Shadowserver/BleepingComputer âœ… confirmed). Cited "SSHCracker" Golang malware (Flare.io, Jan 2026) as modern tooling reference. Coordinated attack check: `awk '{print $(NF-3)}'` to identify additional IPs. `iptables -A INPUT -p tcp --dport 22 -m state --state NEW -m recent --set` shown for rate-limiting (incomplete as written â€” needs `--update --hitcount` to actually drop; marks only). | Rate-limiting iptables rule as written only marks packets, doesn't block. Needs the accompanying DROP rule.                                                                                                                                                                                                                                                                                        |
| **Kimi-K2.5**                | 10989   | âœ… Yes (2) | ðŸŸ¢ **Great**  | Cites PumaBot (Darktrace, May 2025) âœ… confirmed. Cites Dragos Q1 2025 industrial ransomware report âœ… confirmed. Excellent MITRE mapping with sub-techniques (T1110.001, T1110.003). BRUTED tool reference for credential cycling (DeepStrike-cited). "Report to RIPE/ARIN abuse contact" is operationally excellent advice.                                                                                                                            | No explicit `sshd -t` validation step before restart. No `reload` vs `restart` distinction.                                                                                                                                                                                                                                                                                                        |
| **GPT-5.2**                  | 20671   | âœ… Yes (4) | ðŸŸ¢ **Great**  | Only model to surface `MaxStartups 3:50:10` (probabilistically drops connections above threshold â€” real sshd_config option âœ…). Admits AbuseIPDB lookup returned no clean data for this IP â€” honest and avoids fabrication. `lastb -a` for failed login history (if enabled). Distro-specific log paths (Debian vs RHEL vs journald).                                                                                                                    | 4 searches for a standard brute force incident is over-searching. High token count (20.6k) for a well-documented attack pattern.                                                                                                                                                                                                                                                                   |
| **Qwen3.5 Plus**             | 21787   | âœ… Yes (3) | ðŸŸ¡ **Good**   | Anthropic Threat Report Aug 2025 citation âœ… real (anthropic.com confirmed). CISA "SB26-005" citation âœ… plausible (Feb 2026 date consistent). AbuseIPDB Fail2Ban integration guide reference is accurate. Tip to submit the IP to AbuseIPDB (Category 18: Brute-Force) is community-valuable.                                                                                                                                                           | **T1190 (Exploit Public-Facing Application) misapplied** â€” SSH brute force is T1110 (Brute Force), not T1190 (exploitation). T1190 requires exploiting a software vulnerability, not guessing credentials.                                                                                                                                                                                         |
| **GLM-4.7**                  | 37936   | âœ… Yes (5) | ðŸŸ¡ **Good**   | **Best unique finding: CVE-2025-32433** (Erlang/OTP SSH CVSS 10.0, unauthenticated RCE â€” CISA KEV June 2025 âœ…). Patched versions cited correctly (OTP-27.3.3/26.2.5.11/25.3.2.20 âœ…). If target uses Erlang/OTP SSH, this CVE changes the entire incident severity. Check command for Erlang presence (`ps aux                                                                                                                                          | grep -i erlang`) is operationally correct.                                                                                                                                                                                                                                                                                                                                                         | **M1027 mislabeled** â€” GLM listed M1027 as "Brute Force Prevention (rate limiting, account lockout)." MITRE ATT&CK M1027 is **"Password Policies"** (source: mitre.org âœ…). Rate-limiting is M1036 (Account Use Policies). **Highest token count (37,936)** â€” 5 searches for a standard brute force case is significant over-searching. |
| **Gemini Pro 3 Pro Preview** | 200000+ | âŒ FAILED  | ðŸ”´ **Failed** | â€”                                                                                                                                                                                                                                                                                                                                                                                                                                                        | **Loop failure:** Searched repeatedly for IP WHOIS/ASN/organization details for 45.132.89.21, called base model, searched again. Hit max iterations (10) â†’ retry â†’ hit iterations (20) â†’ error. This reveals a specific agent failure mode: **IP lookup research loops** when AbuseIPDB/WHOIS returns sparse results and the agent keeps re-querying instead of proceeding with available context. |

> **Key Learnings:**
>
> 1. **Gemini's loop failure is the most important finding** â€” IP reputation lookups that return sparse or partial results can send agents into infinite search-retry loops. For security alerts with specific IPs, a search cap (max 2 attempts on reputation) must be enforced in the system prompt or agent configuration.
> 2. **GLM's CVE-2025-32433 catch is uniquely valuable** â€” If the incident actually involves Erlang/OTP SSH (e.g., RabbitMQ, CouchDB, or Ejabberd running on the same host), this would upgrade the incident from "brute force attempt" to "active RCE risk." No other model flagged this.
> 3. **Sonnet's lockout prevention warning is the best user safety contribution** â€” the `âš ï¸ CRITICAL REMINDER` about setting up key auth BEFORE disabling PasswordAuthentication is the single most operationally important piece of advice in this test. Missing in 5 of 6 outputs.
> 4. **`systemctl reload sshd` vs `restart`** â€” reload applies new config without dropping existing SSH sessions (safer in production). Only Sonnet used reload. All others used restart, which drops active admin sessions â€” a real operational risk during incident response.
> 5. **GLM's M1027 mislabeling** â€” M1027 = Password Policies (MITRE). Rate-limiting and lockout = M1036 (Account Use Policies). This is a MITRE reference error that could mislead a SOC analyst mapping mitigations to controls.
> 6. **Qwen's T1190 misapplication** â€” T1190 = Exploit Public-Facing Application (requires a vulnerability exploit). Brute force = T1110.001. Misclassifying TTPs affects SIEM rule mapping and compliance reporting.
> 7. **Opus's rate-limiting iptables rule is incomplete** â€” `iptables -A INPUT -p tcp --dport 22 -m state --state NEW -m recent --set` marks packets but doesn't drop them. The DROP counterpart (`--update --hitcount 4 --seconds 60 -j DROP`) is required to actually block.

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **5 out of 7 searched** â€” same majority search behavior as Config A, consistent with this being a security incident warranting threat intel lookup.
- **Kimi-K2.5 did NOT search** in Config C (whereas it searched twice in Config A with Tavily). This is a tool-backend behavioral difference â€” SerpAPI Auto didn't trigger the same search impulse.
- **GLM-4.7 had 3 failed SerpAPI attempts** (`output` param errors x2, then `location`+`uule` conflict) before succeeding on the 4th try with 2 successful searches.
- **Gemini had 1 failed attempt** (500 Internal Server Error from SerpAPI on 1st try) then succeeded on 2nd try with 4 searches.
- **Verdict: Config C shows the same "search is appropriate" judgment but with significant execution overhead** â€” GLM needed 4 runs, Gemini needed 2. The headline finding is Gemini's unique ASN/GeoIP discovery, but it came at 114,926 tokens. The "Google model pattern" of 1-search-then-base-model-then-1-search loops is visible here in token counts.

| Model                        | Tokens                          | Searched?           | Rating       | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ---------------------------- | ------------------------------- | ------------------- | ------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Gemini Pro 3 Pro Preview** | 114926 (2nd try, 500 error 1st) | âœ… Yes (4, 2nd try) | ðŸŸ¢ **Best**  | **Unique finding: AS44486 / Synlinq (Germany)** â€” Gemini identified the actual RIPE-registered ASN. The alert labels the IP as "Russia" but RIPE registration places AS44486 (Oliver Horscht / Synlinq, Frankfurt, Germany) as the owner âœ… confirmed via bgp.tools/ipregistry. Correctly called this a **GeoIP discrepancy** â€” operationally critical (attribution error). Abuse contact `abuse@synlinq.de` is actionable and specific. No loop failure (improvement vs Config A). | **1st try returned HTTP 500** from SerpAPI â€” reliability issue at the API level, not the agent. 114,926 tokens for a brute force case is the highest in this set. Google model pattern (1 search â†’ base model â†’ 1 search) = 4 round-trips, inflating token cost. No `sshd -t` validation before reload mentioned explicitly.                                                                                                                     |
| **Claude Opus 4.5**          | 26625                           | âœ… Yes (3)          | ðŸŸ¢ **Best**  | DEV.to Fail2Ban guide (May 2025) âœ… real. CyberCiti top-20 SSH practices (Feb 2025) âœ… real (nixcraft/cyberciti.biz confirmed). Nature scientific reports article on SSH brute force mitigation (2025) âœ… real. AbuseIPDB report `curl` command with exact category codes (18=Brute-Force, 22=Hacking) â€” practical and correct âœ…. Subnet-wide block suggestion (`45.132.89.0/24 -j DROP`) if campaign continues â€” operationally sound.                                             | `systemctl restart sshd` used â€” drops existing SSH sessions, should be `reload`. No explicit `sshd -t` validation before restart. No GeoIP/ASN lookup attempted.                                                                                                                                                                                                                                                                                 |
| **GPT-5.2**                  | 48349                           | âœ… Yes (6)          | ðŸŸ¢ **Great** | `MaxStartups 10:30:60` mentioned âœ… (rate-limits unauthenticated connection bursts â€” real sshd_config option, as in Config A). `zgrep -h` for compressed log scanning across multiple rotated files âœ…. `sshd -t && systemctl reload ssh` safe validate-then-reload pattern âœ…. Admitted no abuse data for 45.132.89.21 â€” honest, avoids fabrication. `nftables` rule shown as alternative to iptables.                                                                             | **6 searches** for a well-documented brute force case. 48,349 tokens is the highest no-fail output in this set. No ASN/GeoIP research performed despite multiple search calls.                                                                                                                                                                                                                                                                   |
| **Claude Sonnet 4.5**        | 30162                           | âœ… Yes (1)          | ðŸŸ¢ **Great** | Clean single search â€” best search economy of the 5 searchers. Elastic Security rule reference âœ… (real URL confirmed). SANS ISC diary on distributed SSH brute force âœ…. Sucuri blog SSH analysis âœ…. `awk '{print $(NF-3)}'` for concurrent attacker IP extraction. AWS SSM Session Manager / Azure Bastion / GCP IAP mentioned as architectural fix â€” modern and relevant. `grep -oP 'for \K\w+'` for username extraction from logs.                                              | `systemctl restart sshd` used â€” drops existing sessions. No lockout-prevention warning before disabling PasswordAuthentication (Config A's Sonnet had the `âš ï¸ CRITICAL REMINDER` which this one lacks). No GeoIP/ASN lookup from the single search.                                                                                                                                                                                              |
| **GLM-4.7**                  | 2895+2953+3294 (failed) + 44724 | âœ… Yes (2, 4th try) | ðŸŸ¡ **Good**  | **F5 Signature 40015 citation** âœ… â€” 20 SSH failures in 60 seconds triggers brute-force classification; this incident exceeds by 12x. Elastic Security rule URL âœ…. CrowdSec blog on detecting successful SSH brute force âœ…. Correct two-rule iptables rate-limiting pattern: `--set` rule + `--update --hitcount 4 -j DROP` âœ… (fixes the single-rule issue present in Config A analysis). SSH hardening via `sshd_config.d/*.conf` drop-in files (modern approach).              | **T1190 (Exploit Public-Facing Application) misapplied again** â€” same error as Config A. T1190 requires exploiting a software vulnerability; SSH brute force = T1110.001. **M1056 (Exploit Protection) listed** â€” irrelevant to a brute-force hardening scenario, no CVE involved. **3 failed SerpAPI runs** before clean output. M1051 listed as "Update Software" â€” applicable but low-value for this incident type.                           |
| **Kimi-K2.5**                | 3744                            | âŒ No               | ðŸŸ¡ **Good**  | `systemctl reload sshd` âœ… â€” correct (preserves sessions). `sshd -t` validation before reload âœ…. `pam_tally2`/`pam_faillock` for account lockout mentioned. SIEM/Splunk detection rules included. Clean MITRE mapping (T1110, T1021.004, T1078.001, M1030, M1031, M1032, M1036).                                                                                                                                                                                                   | **Did not search** in Config C (vs. 2 searches in Config A with Tavily). SerpAPI Auto failed to trigger the search impulse. No IP reputation lookup performed â€” the single most valuable thing to search for in this exact incident. No mention of ASN/hosting provider context.                                                                                                                                                                 |
| **Qwen3.5 Plus**             | 3562                            | âŒ No               | ðŸŸ¡ **Good**  | Correct MITRE: M1014 (Network Segmentation) âœ…, M1026 (Privileged Account Management) âœ…, M1036 (Account Use Policies) âœ…. AWS security group CLI example is practical. Port knocking / fwknop mention. AbuseIPDB Category 18 submission tip.                                                                                                                                                                                                                                       | **"Mozi botnet" association with 45.132.89.21 is a hallucination** â€” Mozi was dismantled in August 2023 (ESET/WeLiveSecurity confirmed), and no link between this specific IP and Mozi is verifiable in any public threat feed. Presenting this as a factual "IP reputation" finding without a search is fabrication. "Frequently flagged in AbuseIPDB/Shodan as scanner/botnet node" â€” stated as research finding without any search performed. |

> **Key Learnings:**
>
> 1. **Gemini's AS44486/Germany GeoIP finding is the top Config C value-add** â€” the alert says Russia, but RIPE records show AS44486 (Synlinq/Oliver Horscht, Frankfurt, Germany) âœ…. Gemini correctly identified this GeoIP discrepancy from SerpAPI results, which changes the abuse reporting recipient (abuse@synlinq.de, not a Russian NOC) and the geopolitical attribution. No other model found this.
> 2. **Gemini recovered from its Config A loop failure** â€” the critical difference is this alert has more deterministic search results (ASN data is stable WHOIS data vs. dynamic abuse scores for IP lookups). Gemini didn't loop because the ASN search returned concrete results within 1â€“2 queries. Config A's loop was caused by _sparse_ AbuseIPDB data, not by the model's inherent reasoning.
> 3. **Kimi's search abstinence in Config C is a regression** â€” Kimi searched twice in Config A (Tavily) but not at all in Config C (SerpAPI), producing zero IP threat intel. For a security incident where IP reputation is the #1 search target, this is the most important behavioral gap between the two configs. SerpAPI Auto failed to trigger the search impulse that Tavily Auto did.
> 4. **Qwen's Mozi botnet claim is a hallucination** â€” Mozi was dismantled in August 2023. Attributing 45.132.89.21 to Mozi or any specific botnet without a search is fabricated threat intelligence. A SOC analyst who acts on this attribution would be pursuing a false lead. This is the most dangerous single claim in this test.
> 5. **GLM's T1190 error is a consistent pattern** â€” it appeared in Config A, and now reappears in Config C. T1190 (Exploit Public-Facing Application) is explicitly for vulnerability exploitation, not credential guessing. This is not noise â€” it's a systematic MITRE mapping deficiency in GLM-4.7 for SSH attack scenarios.
> 6. **GLM's iptables two-rule fix** â€” the correct pattern (`--set` + `--update --hitcount -j DROP`) appears in GLM's Config C output, fixing the Config A Opus single-rule error. GLM gets credit for this specific improvement.
> 7. **Google model token pattern confirmed** â€” Gemini consumed 114,926 tokens doing 4 searches in 1-search-then-base-model cycles. Compare to Sonnet at 30,162 tokens for 1 search. For the same incident, Gemini's architecture costs ~4x Sonnet. This is an inherent cost of the Gemini reasoning loop architecture, not a fixable parameter.
> 8. **`systemctl reload sshd` vs `restart`** â€” only Kimi (no-search) used `reload` correctly. All 4 searching models (Gemini, Opus, GPT-5.2, Sonnet) used `restart`, which drops active SSH admin sessions during incident response. Same finding as Config A. This is a systematic gap that persists regardless of search tool.

---

## ðŸŸ¡ Medium Complexity (Query Precision Matters)

_Incidents where the quality of the search query â€” not just whether to search â€” determines the answer._

### 3. Nginx Config Syntax Error

**Goal:** Test restraint â€” the agent should NOT search for a plain typo.

```text
[ERROR] Nginx failed to start
Service: nginx.service
Message: [emerg] unknown directive "ssl_certificate_keyy" in /etc/nginx/sites-enabled/default:14
State: failed
```

- **Expectation:** Identify `ssl_certificate_keyy` â†’ `ssl_certificate_key`. Internal knowledge resolves it. Zero search calls.
- **Manual vs Auto Delta:** Expect zero calls in both configs. Any search invocation here = prompt calibration issue.

#### ðŸ“Š Analysis Results â€” Config A (Tavily, Auto Parameters)

**Did any model invoke search?**

- **6 out of 7 correctly did NOT search** âœ… â€” excellent restraint on a fully self-diagnosing typo. The error message names the invalid directive, the file, and the line number. No external lookup can add value.
- **Claude Sonnet 4.5 searched once** â€” the only model to invoke Tavily, querying nginx.org documentation to confirm the correct directive name. The search found official documentation confirming `ssl_certificate_key` as the valid directive and no known reports of the typo `ssl_certificate_keyy`. This is **unnecessary over-triggering**: the fix is 100% deterministic from the error message alone. Total tokens: 6,247 vs. 1,896â€“2,265 for no-search models â€” a **~3â€“4Ã— cost multiplier with zero information gain**.
- **No Tavily failures** â€” the one search call (Sonnet) succeeded cleanly, and no other model attempted a search.
- **Verdict: Config A performs correctly on this restraint test** â€” 6/7 models abstained. The single over-trigger is Sonnet-specific and not a Tavily tool failure. This matches Config C's 6/7 restraint rate exactly.

| Model                        | Tokens | Searched?  | Rating       | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                    |
| ---------------------------- | ------ | ---------- | ------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Kimi-K2.5**                | 1896   | âŒ No      | ðŸŸ¢ **Best**  | **Lowest token count (1,896) â€” most efficient output.** `sed -n '12,16p'` for pre-edit context inspection around line 14 âœ…. `systemctl reload nginx` correctly used (not restart â€” preserves connections on a running service) âœ…. Structured SSL directive reference table. Severity correctly labeled "Medium" for service outage. Pre-commit hooks mentioned.                                                                                                                                          | No symlink resolution step (`readlink -f`) â€” `/etc/nginx/sites-enabled/default` is typically a symlink to `sites-available`. No `nginx -T` full-config dump for multi-include environments.                                                                                                                                                                                                   |
| **GLM-4.7**                  | 2122   | âŒ No      | ðŸŸ¢ **Best**  | `sudo nginx -t` run first before any edit â€” correct validation-first approach âœ…. Two-option resolution path (sed inline vs. manual editor). Mentions `nginx-config-formatter` and `gixy` as linting tools â€” both real: `nginx-config-formatter` (`nginxfmt` on PyPI âœ… real formatter package); `gixy` âœ… confirmed (Yandex security linter). Severity "Low" âœ… â€” most accurate classification for a trivial 1-char fix with zero security impact. `systemctl start nginx` correct for a stopped service. | No `reload` vs `restart` distinction for the case where nginx is running during a config change. No symlink resolution. Prevention section is generic.                                                                                                                                                                                                                                        |
| **GPT-5.2**                  | 1933   | âŒ No      | ðŸŸ¢ **Best**  | **Most operationally complete no-search output.** `sudoedit /etc/nginx/sites-enabled/default` âœ… â€” runs the editor as the user (not root), uses a temp file, and copies back after edit; genuinely safer than `sudo nano` which runs a root-owned editor process (privilege escalation vector, confirmed âœ…). `nginx -T                                                                                                                                                                                    | sed -n '1,200p'`to dump the full expanded config including all included files.`nl -ba /etc/nginx/sites-enabled/default                                                                                                                                                                                                                                                                        | sed -n '1,40p'` for numbered line inspection without an editor. Severity "Medium" â€” reasonable for a service outage.                             | No symlink resolution step. Severity "Medium" is defensible (service down = business impact) but Low is more precise given trivial fix and zero security risk. |
| **Gemini Pro 3 Pro Preview** | 2191   | âŒ No      | ðŸŸ¢ **Great** | `sudo nano /etc/nginx/sites-enabled/default +14` â€” jumps directly to line 14 âœ… (nano `+line` syntax). Backup step before editing. `nginx -t && systemctl restart nginx` compound command (fail-safe pattern). Mentions `gixy` âœ… real security linter (Yandex / `MegaManSec/Gixy-Next`, actively maintained fork confirmed âœ…).                                                                                                                                                                           | **Severity labeled "High"** âŒ â€” identical miscategorization as Config C. A one-character typo with a 2-minute fix and zero security or data risk is not High severity. High implies irreversibility, data loss, or active threat. Lowâ€“Medium is correct. No `readlink -f` symlink resolution. `systemctl restart nginx` drops active connections â€” `reload` is safer for a running instance. |
| **Qwen3.5 Plus**             | 2265   | âŒ No      | ðŸŸ¢ **Great** | Correctly stated **MITRE ATT&CK: Not Applicable** âœ… â€” operational human error, not an attack technique. Mentioned `nginx-linter` as a prevention tool (real: `nginx-linter` on npm âœ… â€” a Node.js-based nginx config syntax checker). Explains that nginx's `[emerg]`-level parser catches unknown directives before any traffic is served â€” accurate framing âœ…. Severity "Low" âœ… â€” most accurate.                                                                                                      | No `reload` vs `restart` distinction. No symlink resolution. No `nginx -T` full dump. Prevention section lists standard points without specifics.                                                                                                                                                                                                                                             |
| **Claude Opus 4.5**          | 2954   | âŒ No      | ðŸŸ¢ **Great** | `grep -rn "ssl_certificate_keyy" /etc/nginx/` to check for the same typo across the entire config directory (catches cases where the typo appears in multiple include files) âœ…. `sed -i 's/ssl_certificate_keyy/ssl_certificate_key/g'` global replace across all occurrences âœ…. `ss -tlnp                                                                                                                                                                                                               | grep :443` post-fix listener verification. Table-format Prevention section with Measure/Implementation is the clearest structured output. Severity "Medium" â€” reasonable.                                                                                                                                                                                                                     | No symlink resolution. `systemctl start nginx` correct for a stopped service, but no `reload` path mentioned for running-service config changes. |
| **Claude Sonnet 4.5**        | 6247   | âœ… Yes (1) | ðŸŸ¡ **Good**  | Searched nginx.org official documentation and confirmed: (a) `ssl_certificate_key` is the correct directive âœ… (redundant given the error message); (b) no prior bug reports or known occurrences of `ssl_certificate_keyy` â€” search confirms this is a unique human typo. `nginx-safe-reload` pre-deployment script in `/usr/local/bin/` is the most production-ready prevention artifact. `sed -i 's/ssl_certificate_keyy/ssl_certificate_key/'` âœ…. Severity "Low" âœ….                                  | **Over-triggered on a 100% deterministic typo.** The error message is fully self-diagnosing â€” the directive name, file path, and line number are all explicit. Tavily confirmed zero new information. Token cost: 6,247 vs. median 2,122 for no-search models â€” **~3Ã— cost for negative information gain**. No `sudoedit` or symlink resolution.                                              |

> **Key Learnings:**
>
> 1. **6/7 abstained â€” restraint test passed** â€” Config A (Tavily Auto) correctly suppressed search for a trivially deterministic syntax error in 6 of 7 models. This is the expected behavior: the error message is fully self-diagnosing and no external lookup can improve the resolution. Config A matches Config C's 6/7 rate exactly on this case.
> 2. **Sonnet's over-trigger is the key failure** â€” searching for a known directive typo that is fully diagnosed by the nginx parser output is the clearest example of low-signal search in this test suite. The search result ("this is a confirmed valid directive with no known bugs for this exact typo") adds exactly zero actionable information. Token cost: **~3Ã— the no-search baseline for negative information gain**.
> 3. **Gemini's "High" severity is a consistent labeling error** â€” this is the same miscategorization observed in Config C. One-character typo, 2-minute fix, zero security or data risk = Lowâ€“Medium severity. "High" implies active threat, data loss potential, or irreversible damage. This pattern across both configs suggests Gemini systematically inflates severity for nginx service-down scenarios regardless of the triviality of the root cause.
> 4. **GPT's `sudoedit` is the most security-correct command** â€” `sudo nano /etc/nginx/sites-enabled/default` runs a root-owned nano process, a known privilege escalation vector (CVE-2023-22809 as a historical example). `sudoedit` creates a temp file, edits it as the user, and copies back â€” the editor never runs as root. Only GPT mentioned this distinction across both Config A and Config C. This is the single most operationally important command-level difference in this test.
> 5. **GLM's "Low" severity is the most accurate** â€” none of the models calling this "High" or even "Medium" is wrong per se (service outage = business impact), but the effort-to-fix ratio (1 character, 2 minutes, no rollback needed) argues for Low. When severity drives incident escalation decisions, Low is more informative: it signals "fix immediately but no need to wake anyone up at 3am."
> 6. **`nginx-config-formatter` (GLM) vs `gixy` (GLM, Gemini)** â€” `nginx-config-formatter` (`nginxfmt`, pypi.org âœ…) is a **formatting-only** tool â€” it improves readability but doesn't catch typos or security issues. `gixy` / `Gixy-Next` (MegaManSec âœ… actively maintained) is a **security linter** that detects SSRF, HTTP splitting, path traversal â€” genuinely useful for long-term nginx hardening but unrelated to this specific typo. Worth distinguishing: formatting â‰  linting.
> 7. **Kimi's `systemctl reload nginx` is the only safe choice for running-service config changes** â€” `reload` sends SIGHUP, gracefully applies new config without dropping existing connections. `restart` (used by Gemini, Opus) terminates the process and restarts â€” brief downtime, drops active connections. For a stopped service (the scenario here), `start` is correct; for applying config changes to a running nginx, `reload` is mandatory.
> 8. **Token economy for a restraint test:** Kimi (1,896) â†’ GLM (2,122) â†’ GPT (1,933) â†’ Gemini (2,191) â†’ Qwen (2,265) â†’ Opus (2,954) â†’ Sonnet (6,247). The 5 sub-2,500-token outputs all produced correct, complete triage notes. Cost doubles from Opus to Sonnet with no quality increase. For this case, the optimal output costs ~2,000 tokens â€” a baseline to compare against other configs.

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **6 out of 7 correctly did NOT search** â€” excellent restraint on a deterministic typo. The error message is self-diagnosing.
- **Claude Sonnet 4.5 searched once** â€” queried nginx.org mailing archive for "ssl_certificate_keyy" style SSL directive errors. The search found no matches for the exact typo, confirming this is a configuration file error not a bug. This is **unnecessary over-triggering**: the fix is fully deterministic from the error message alone. 16,250 tokens consumed vs. 2,204â€“3,646 for no-search models.
- **No SerpAPI failures** in this test â€” the only search call (Sonnet) succeeded cleanly.
- **Verdict: Config C performs correctly on this restraint test** (6/7 abstained). The one over-trigger is a Sonnet-specific calibration issue, not a SerpAPI infrastructure problem.

| Model                        | Tokens | Searched?  | Rating       | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ---------------------------- | ------ | ---------- | ------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **GPT-5.2**                  | 2204   | âŒ No      | ðŸŸ¢ **Best**  | Most operationally complete no-search output: `sudoedit "$(readlink -f /etc/nginx/sites-enabled/default)"` â€” uses `readlink -f` to resolve the symlink target and `sudoedit` for safe temp-file editing (vs `sudo nano` which runs root-owned editor process âœ…). `nginx -T 2>&1 \| sed -n '1,120p'` to dump full expanded config. Temporary disable trick (`rm /etc/nginx/sites-enabled/default` â†’ `nginx -t` â†’ `systemctl start`) for fast service restore while fixing. `ss -lntp \| grep -E ':(80\|443)\b'` post-fix listener verification. | Severity labeled "Medium" â€” reasonable given service outage, but "Low" is more accurate given trivial fix and zero security exposure.                                                                                                                                                                                                                                                                                                                                             |
| **Gemini Pro 3 Pro Preview** | 2931   | âŒ No      | ðŸŸ¢ **Great** | `sed -i '14s/ssl_certificate_keyy/ssl_certificate_key/'` â€” line-specific sed (only modifies line 14, avoids touching other occurrences) âœ… correct syntax. **gixy** linter mention âœ… real tool (Yandex, now maintained as `Gixy-Next` / `MegaManSec/Gixy-Next`) for security misconfiguration detection. Correct `reload` vs `restart` advice in prevention: "reload keeps old workers running if new config is invalid, preventing downtime" âœ…. Backup step (`cp ...default.bak_YYYYMMDD`) before editing.                                   | **Severity labeled "High"** âŒ â€” this is a one-character typo with a 2-minute fix and zero security risk. High severity implies active threat or data loss potential. Low or Medium is appropriate.                                                                                                                                                                                                                                                                               |
| **Claude Opus 4.5**          | 3646   | âŒ No      | ðŸŸ¢ **Great** | **Docker-based pre-commit hook**: `docker run --rm -v $(pwd)/nginx:/etc/nginx:ro nginx:latest nginx -t` â€” validates config in isolated container without requiring nginx on the dev machine âœ… genuinely useful. `grep -rn "ssl_certificate_keyy" /etc/nginx/` to find all instances across config directory. `openssl s_client -connect localhost:443 -brief` for SSL handshake verification post-fix.                                                                                                                                         | No `reload` vs `restart` distinction (uses `systemctl start` â€” correct for stopped service, but doesn't mention `reload` for running-service changes).                                                                                                                                                                                                                                                                                                                            |
| **Kimi-K2.5**                | 2349   | âŒ No      | ðŸŸ¢ **Great** | `systemctl reload nginx` used âœ… (correct for applying config changes to running service). `curl -I https://your-domain.com` post-fix verification. `sed -n '14p'` for inspecting exactly line 14 before editing. Nginx SSL directives reference table (ssl_certificate, ssl_certificate_key, ssl_protocols, ssl_ciphers) â€” clean structured output. Pre-commit hooks mention.                                                                                                                                                                  | No symlink resolution step (`readlink -f`) â€” sites-enabled/default is commonly a symlink; editing without resolving could edit the symlink target silently.                                                                                                                                                                                                                                                                                                                       |
| **Qwen3.5 Plus**             | 3101   | âŒ No      | ðŸŸ¢ **Great** | Correctly stated **MITRE ATT&CK: Not Applicable** âœ… â€” this is operational error, not attack. "Nginx refusing to start is a safety mechanism that prevents running with broken SSL" â€” correct framing âœ…. Cited `src/core/ngx_conf_file.c` as the source of the unknown directive error logic â€” technically true, though un-searchable. `[emerg] unknown directive` is distro-agnostic behavior, confirmed correct.                                                                                                                             | Cited "Nginx Source Code: src/core/ngx_conf_file.c" under Sources without searching â€” this is internal knowledge presented as a verified source. Minor but slightly misleading framing. No `sudoedit` or symlink resolution.                                                                                                                                                                                                                                                      |
| **GLM-4.7**                  | 2972   | âŒ No      | ðŸŸ¢ **Great** | `sed -n '12,16p'` â€” shows context around line 14 (2 lines before/after) for full context during investigation âœ…. `systemctl start nginx` correct for stopped service (not reload). Clean two-option resolution (sed vs manual editor).                                                                                                                                                                                                                                                                                                         | No `nginx -T` full-config dump. No symlink resolution step. Prevention section is generic (same points as every other model).                                                                                                                                                                                                                                                                                                                                                     |
| **Claude Sonnet 4.5**        | 16250  | âœ… Yes (1) | ðŸŸ¡ **Good**  | Correctly identified the typo and provided clean fix. Searched nginx.org mailing archive and confirmed no existing reports for the exact typo `ssl_certificate_keyy` â€” which honestly validates the fix (not a known bug). `sed -i 's/ssl_certificate_keyy/ssl_certificate_key/'` âœ…. Pre-deployment check script (`nginx-safe-reload`) in `/usr/local/bin/` is ready-to-use.                                                                                                                                                                   | **Over-triggered on a deterministic typo** â€” the error message is fully self-diagnosing. Search consumed 16,250 tokens (vs 2,204â€“3,646 for no-search outputs, **~5â€“7x cost multiplier**) and returned zero new information. The search result confirming "no known bug with this typo" is the definition of wasted search budget. No symlink resolution. `systemctl start nginx` (correct for stopped service) but no `reload` path mentioned for running-service config changes. |

> **Key Learnings:**
>
> 1. **6/7 abstained â€” restraint test mostly passed** â€” SerpAPI Auto Parameters correctly suppressed search for a trivial, self-diagnosing typo in 6 of 7 models. This is the expected behavior. Config C performs on par with Config A for this case. The one failure (Sonnet) is a model-level calibration issue, not a tool infrastructure failure.
> 2. **Sonnet's over-trigger is the key failure** â€” searching for a known typo in a configuration file that is fully diagnosed by the error message itself is the definition of low-signal search. The result ("no known reports for ssl_certificate_keyy") adds exactly zero actionable information. The cost (16,250 tokens) is **5â€“7x the no-search baseline** with **negative information gain** â€” the search confirmed nothing new.
> 3. **Gemini's severity labeling is inconsistent** â€” calling a one-character typo with a 2-minute fix "High severity" inflates the incident classification. Severity should reflect impact (service outage = business impact â†’ Medium) plus effort to fix (trivial â†’ lower bound quickly). The correct range for this incident is Lowâ€“Medium. High implies irreversibility, data risk, or active threat.
> 4. **GPT's `sudoedit` pattern is the best practice** â€” `sudo nano /etc/nginx/sites-enabled/default` runs a root-owned nano process, which can be a privilege escalation vector. `sudoedit` (or `sudo -e`) creates a temp file, lets the user edit it in their own editor, and copies it back â€” safer and auditable. Only GPT mentioned this distinction.
> 5. **The symlink gap is universal** â€” `/etc/nginx/sites-enabled/default` is almost always a symlink to `/etc/nginx/sites-available/default`. Only GPT explicitly resolved this with `readlink -f`. All other models opened the symlink path directly â€” which works on Linux but can fail in some editors or audit contexts where the real path matters.
> 6. **Opus's Docker pre-commit hook is the most deployable prevention mechanism** â€” validates nginx config against an isolated `nginx:latest` container without requiring nginx on the developer's local machine. This is production-grade CI prevention, not just "run nginx -t" (which requires nginx to be installed and configured locally).
> 7. **`gixy` / `Gixy-Next` is a legitimate hardening reference** (Gemini) â€” originally developed by Yandex, now maintained as `MegaManSec/Gixy-Next`. It checks for security misconfigurations (SSRF, HTTP splitting, etc.), not just syntax errors. A useful long-term recommendation for teams managing complex nginx setups, though unrelated to this specific typo incident.

### 4. Java OOM â€” Version-Scoped Query

**Goal:** Test whether the agent constructs a version-specific query vs a generic one.

```text
[ALERT] Java Application OOM
Error: java.lang.OutOfMemoryError: Java heap space
Context: Heap=-Xmx8g. Server has 64GB RAM. Usage flat at 2GB, then spikes instantly on batch job trigger.
Application: Spring Boot 3.2.1
```

- **Expectation:** Distinguish Leak vs Allocation. Search for Spring Boot 3.2.1 specific OOM issues if no confident internal match.
- **Manual vs Auto Delta:**
  - **Auto (Tavily):** May search `"Java OOM Spring Boot"` â€” too broad.
  - **Manual (Tavily, `timeRange: year`):** Agent query should be `"Spring Boot 3.2.1 OutOfMemoryError batch 2024"`.
  - **Manual (SerpAPI):** `site:github.com "spring-boot 3.2.1" OutOfMemoryError batch`.

#### ðŸ“Š Analysis Results â€” Config A (Tavily, Auto Parameters)

**Did any model invoke search?**

- **6 out of 7 searched** â€” correct judgment. Spring Boot 3.2.1 is explicitly named in the alert, and the "instant spike" OOM pattern on a batch trigger is a multi-hypothesis scenario (reader config, Hibernate 6 regression, Spring Batch 5.x behavior). External search is warranted to narrow down version-specific causes.
- **Qwen3.5 Plus did NOT search** â€” and still produced the lowest cost, most operational output (3,271 tokens). Same behavior as Config C â€” consistent self-reliance from internal knowledge.
- **Kimi-K2.5 needed 2 tries** â€” 1st attempt returned an empty output `{}` (Tavily call completed with 3 results, but the agent's response was empty â€” a generation failure, not a tool failure). 2nd attempt succeeded with 2 clean searches.
- **Gemini Pro 3 Pro Preview entered a 10-search Tavily loop** â€” 146,633 tokens, the most expensive single-model run in the entire test suite. Gemini triggered recursive search cycles: each Tavily result referenced related articles, which triggered another search, ad infinitum. No max-iteration guard in the workflow prevented this spiral. This is **Config A's most critical finding** â€” Tavily's auto-search mode is as vulnerable to loops as SerpAPI when the model has no search-count ceiling.
- **No Tavily tool failures** â€” all searches succeeded cleanly for all models. Config A's 100% tool reliability on this test case directly contrasts with Config C's catastrophic GLM failure (7 SerpAPI errors, ~188k tokens wasted).
- **Verdict:** Config A is significantly more reliable than Config C on this test case â€” GLM actually produced output (5 searches, 40,151 tokens in Config A vs complete failure in Config C). However, Gemini's 10-search spiral at 146k tokens shows Tavily is not immune to search loops. Cost discipline matters more than tool choice.

| Model                        | Tokens               | Searched?      | Rating       | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ---------------------------- | -------------------- | -------------- | ------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Qwen3.5 Plus**             | 3271                 | âŒ No          | ðŸŸ¢ **Best**  | **Lowest cost (3,271 tokens), highest information density** â€” Identifies "Cliff Behavior" (instant vertical spike) vs. gradual leak "sawtooth" clearly âœ…. Hibernate 6 IN-clause batching and collection fetching behavioral changes from Spring Boot 2â†’3 accurately described âœ…. `jps -l` â†’ `jmap` heap dump chain âœ…. `SELECT count(*) FROM target_batch_table` hypothesis test (>500k rows with `findAll()` = guaranteed OOM) â€” most diagnostic immediate suggestion in the entire set. MITRE N/A âœ… + correctly notes T1499 (Endpoint DoS) only if triggered maliciously â€” appropriately hedged.                                                                                                                                                                                                                                                                                                                                                                   | No search means no version-specific findings (GitHub #3790 mechanic, Hibernate HHH-17078 details). `stepBuilderFactory.get(...)` not used â€” Qwen provided streaming code via `Stream<Data>` / `repository.findAllByStream()`, bypassing the deprecated API âœ… (the only model to avoid the deprecated Spring Batch factory pattern, if only because it used a simpler code pattern).                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Sonnet 4.5**               | 11834                | âœ… Yes (3)     | ðŸŸ¢ **Best**  | **Most efficient multi-search output** â€” 3 searches, 11,834 tokens (Gemini's 10 searches cost 12Ã— more). Clear anti-pattern showcase: `repository.findAll()` (âŒ) vs. `@QueryHints(HINT_FETCH_SIZE="1000")` Stream (âœ…) vs. Spring Batch chunk reader (âœ…). Google FHIR Data Pipes OOM GitHub issue #136 âœ… real case â€” confirms the pattern with a real-world open-source example. `jvm_memory_used_bytes / jvm_memory_max_bytes > 0.7` Prometheus rule âœ… â€” well-specified alert formula. `jmap -dump:live,format=b` correctly uses `live` flag to dump only reachable objects.                                                                                                                                                                                                                                                                                                                                                                                       | `stepBuilderFactory` is deprecated in Spring Batch 5.x / Spring Boot 3 âŒ â€” `StepBuilder("processRecords", jobRepository)` confirmed as replacement (verified âœ…). No Spring Boot 3.2.1-specific issue found (same honest conclusion as GPT, but didn't explicitly state it).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **GLM-4.7**                  | 40151                | âœ… Yes (5)     | ðŸŸ¢ **Great** | **Config A's biggest improvement over Config C** â€” In Config C, GLM completely failed 7 times (SerpAPI). In Config A (Tavily), GLM produced a full, high-quality output. **Surfaced 4 concrete Stack Overflow threads** all confirmed real: [SO#48588433](https://stackoverflow.com/questions/48588433) (JdbcCursorItemReader streaming fix), [SO#69426104](https://stackoverflow.com/questions/69426104) (Spring Batch memory growth), [SO#75995461](https://stackoverflow.com/questions/75995461) (OOM after Spring 6/Hibernate 6 migration), [SO#37335](https://stackoverflow.com/questions/37335) (OOM general guidance). `setFetchSize(Integer.MIN_VALUE)` for MySQL streaming âœ… confirmed. `ResultSet.FETCH_FORWARD` requirement for MySQL PreparedStatement âœ… accurate. `jcmd $PID GC.heap_dump` for live heap capture âœ…. Spring Boot 3 / Hibernate 6 migration OOM (`StringConcatHelper`) as secondary hypothesis â€” real issue documented in SO#75995461 âœ…. | 5 searches for 4 Stack Overflow sources (could have been 2â€“3 searches). `stepBuilderFactory.get(...)` used in Spring Batch code sample âŒ â€” deprecated in Spring Batch 5.x bundled with Spring Boot 3.2.1. Spring Batch reference URL points to 4.3.5 docs (outdated for Spring Boot 3.2.1 which uses Batch 5.1) âŒ. Baeldung RestTemplate buffering cited as last source â€” tangentially related (RestTemplate can OOM, but not directly relevant to batch job trigger scenarios).                                                                                                                                                                                                                                                                                                                                                |
| **Kimi-K2.5**                | 12631 (fail) + 31653 | âœ… Yes (2 + 2) | ðŸŸ¢ **Great** | **Spring Batch GitHub #3790** âœ… real â€” `MessageChannelPartitionHandler#pollReplies` retains full `StepExecution` graph including parent `JobExecution` with all sibling `StepExecution`s â†’ O(nÂ²) object growth for partitioned jobs. Example: 837 partitions = 700,569 `StepExecution` objects. Original issue filed for Spring Batch 4.1.4. `setFetchSize(1000)` for PostgreSQL and `setFetchSize(Integer.MIN_VALUE)` for MySQL â€” driver-specific distinction âœ…. `JdbcPagingItemReader` with `setPageSize(1000)` as the safest reader for large tables (paging = stateless, no cursor management). Baeldung large result set guide âœ… real.                                                                                                                                                                                                                                                                                                                          | **First attempt produced empty output** `{}` â€” Tavily call completed (3 searches succeeded) but the agent returned no text. This is a generation failure (model didn't produce a response despite tool success) â€” distinct from a tool failure. Needed 2 full workflow runs. **Claim: "Fixed in Spring Batch 5.0.1+ (Spring Boot 3.0.7+)"** â€” partially misleading âš ï¸. GitHub #3790 was filed against Batch 4.x; a related issue (#4598, "Memory leak in MessageChannelPartitionHandler when polling the database") affects Spring Batch 5.x. The 3.2.1 version (Batch 5.1) may not be fully immune. `stepBuilderFactory.get(...)` in code samples âŒ â€” deprecated in Batch 5.x.                                                                                                                                                  |
| **Claude Opus 4.5**          | 29132                | âœ… Yes (4)     | ðŸŸ¢ **Great** | **Most thorough fix-path coverage** â€” covers JdbcCursorItemReader (MySQL `Integer.MIN_VALUE` fix), JdbcPagingItemReader alternative (with `MySqlPagingQueryProvider` and `setSortKeys`), processor/writer accumulation anti-pattern (static `List<MyEntity>` field âŒ). `jmap -histo:live` + `head -30` for quick class histogram without full dump. `jcmd $PID GC.heap_dump` âœ…. `increase(jvm_memory_used_bytes{area="heap"}[1m]) > 2000000000` Prometheus alert for heap spike detection (correct PromQL âœ…). `setVerifyCursorPosition(false)` required alongside `setFetchSize(Integer.MIN_VALUE)` âœ… â€” often overlooked.                                                                                                                                                                                                                                                                                                                                           | `stepBuilderFactory` deprecated âŒ â€” same universal error. 4 searches, 29,132 tokens â€” slightly over-searched for the available information. `pgrep -f spring-boot` in bash rather than `jps -l` â€” works but fragile if process name differs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **GPT-5.2**                  | 15888                | âœ… Yes (4)     | ðŸŸ¢ **Great** | **Most honest finding** â€” explicitly stated _"No Spring Boot 3.2.1-specific, widely documented OOM regression was found in targeted search"_ âœ… â€” correct conclusion, confirmed by independent verification. This is materially better than models that fabricated version-specific root causes without search evidence. `jcmd <pid> VM.native_memory summary` for off-heap/native memory check âœ…. Container cgroup memory check (`/sys/fs/cgroup/memory.max`) for Kubernetes pod limits âœ… â€” often overlooked. `-Xlog:gc*,safepoint:file=...:time,uptime,level,tags` unified JVM logging format (Java 9+) âœ….                                                                                                                                                                                                                                                                                                                                                         | **4 searches, heavily irrelevant sources** â€” IBM WAS Cookbook, IBM CloudPak AIops security bulletin, Oracle Industrial Communications release notes, H2O DriverlessAI user guide, LinkedIn posts â€” none relevant to Spring Batch OOM. SerpAPI previously delivered relevant SO threads; Tavily here returned off-topic PDFs/release notes. GPT included them all in "Sources Consulted" without flagging. **Same noise pattern as Config C but with Tavily instead of SerpAPI** â€” the source irrelevance problem is model-dependent (GPT's query formulation), not tool-dependent. No `stepBuilderFactory` code used (conservative but correct choice).                                                                                                                                                                           |
| **Gemini Pro 3 Pro Preview** | 146633               | âœ… Yes (10)    | ðŸŸ¡ **Good**  | **Unique finding: Hibernate 6 HHH-17078** âœ… real â€” `ScrollableResultsConsumer` memory leak where `JdbcValuesSourceProcessingState` is registered in `LoadContexts` but not always deregistered during streaming. This causes Hibernate 6's "streaming" to effectively buffer results in memory. Confirmed as a real Hibernate bug (hibernate.org âœ…). `useStatelessSession(true)` on HibernateCursorItemReader to bypass the L1 cache entirely âœ… â€” operationally correct for batch. `entityManager.clear()` in `afterChunk` ChunkListener âœ…. Severity "Critical" â€” defensible for a process crash, though "High" is more calibrated for a recoverable batch failure.                                                                                                                                                                                                                                                                                                 | **146,633 tokens â€” most expensive single-model output in the entire test suite.** 10 Tavily searches (same behavior as GPT's 12-search SerpAPI spiral in Config C). Gemini's recursive loop: Tavily result â†’ related links â†’ search again â†’ repeat. No convergence signal in the agent loop. **Severity: Critical** âŒ â€” inflated. OOM on batch job trigger is High (service degraded, batch fails), not Critical (which implies data loss, full system outage, or security breach). Gemini labeled Hibernate 6.4.1.Final specifically but Spring Boot 3.2.1 actually bundles **Hibernate 6.4.4.Final** (released Dec 2023) âš ï¸ â€” minor version mismatch. `stepBuilderFactory.get(...)` deprecated âŒ. Framing HHH-17078 as "most probable root cause" without a heap dump is speculative â€” it's one possible cause among several. |

> **Key Learnings:**
>
> 1. **Gemini's 10-search Tavily spiral at 146k tokens is the defining Config A finding** â€” this is a worse token outcome than Gemini's 3-search SerpAPI run in Config C (96k tokens). Tavily's clean success rate (no param errors) actually enables more loops: since every search succeeds, there's no error signal to break the cycle. This shows that search loops are triggered by **model behavior, not tool reliability** â€” a max-iteration guard is mandatory regardless of the search backend.
> 2. **Config A vs Config C reliability: GLM is the clearest winner** â€” GLM produced a full, high-quality output in Config A (Tavily, 5 searches, 40k tokens) vs. complete failure in Config C (SerpAPI, 7 attempts, ~188k tokens, zero output). For GLM specifically, Tavily is dramatically more reliable than SerpAPI. This is the most concrete cross-config reliability finding in TC4.
> 3. **Qwen's no-search output is the most cost-efficient correct answer** â€” 3,271 tokens, fully actionable, correct MITRE mapping, correct heap dump chain, correct streaming vs. findAll() distinction. The only gap is Gemini's HHH-17078 and Kimi's #3790 (both real but neither definitively confirms Spring Boot 3.2.1 is affected without a heap dump). For production triage, Qwen's response is deployable immediately.
> 4. **GPT's "no Spring Boot 3.2.1-specific OOM regression found" is the most honest and correct search conclusion** âœ… â€” confirmed by independent web search. The Spring Batch `StepBuilderFactory` deprecation and `#3790` predate Spring Boot 3.2.1. No confirmed new regression exists in 3.2.1 specifically. Models that claimed version-specific bugs (Gemini, Kimi) were surfacing real issues that _may_ affect 3.2.1 but are not confirmed regressions introduced in that version. GPT's transparency about search limits is more valuable than confident-sounding speculation.
> 5. **`StepBuilderFactory.get(...)` is a universal code quality failure** â€” every model that wrote Spring Batch code (GLM, Kimi, Gemini, Opus) used the deprecated pattern. Spring Boot 3.2.1 bundles Spring Batch 5.1, where `StepBuilderFactory` is deprecated (slated for removal in 5.2). The correct replacement is `new StepBuilder("stepName", jobRepository).<In, Out>chunk(100, transactionManager)...`. A developer following any of these code samples will get deprecation warnings and future compilation failures. Sonnet and Qwen avoided this by using non-Spring-Batch-specific patterns (streaming queries, `@QueryHints`).
> 6. **Gemini's HHH-17078 is real but overconfidently framed** â€” `ScrollableResultsConsumer` memory leak in Hibernate 6 is documented (hibernate.org âœ…, HHH-17078). However, framing it as "most probable root cause" without a heap dump is speculative. The "instant spike" pattern is equally consistent with `findAll()`, large chunk sizes, or #3790 behavior. Gemini's finding has diagnostic value as one hypothesis, not as a confirmed root cause.
> 7. **Kimi's #3790 fix claim is partially misleading** â€” GitHub #3790 was filed against Spring Batch 4.x. A related issue (#4598) affects Spring Batch 5.x remote partitioning with `MessageChannelPartitionHandler`. Spring Boot 3.2.1 (Batch 5.1) may still be affected by #4598's variant. Kimi's statement "Fixed in Spring Boot 3.0.7+" may give false confidence to teams using 3.2.1 with partitioned batch jobs.
> 8. **GPT's Tavily source quality is model-dependent, not tool-dependent** â€” GPT received IBM WAS, Oracle Industry PDFs, H2O DriverlessAI docs from Tavily (all irrelevant). In Config C, GPT received Infinispan, SAP, Intercom from SerpAPI (equally irrelevant). The common thread is GPT's query formulation, not the search backend. Gemini, Sonnet, and Kimi all got relevant SO threads from Tavily. This strongly suggests GPT generates overly broad queries that both tools fail to answer relevantly.

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **5 out of 7 searched** â€” correct judgment: this incident warrants version-specific research (Spring Boot 3.2.1 is explicitly named).
- **Qwen3.5 Plus did NOT search** â€” delivered a complete, accurate analysis from internal knowledge alone.
- **GLM-4.7 is a complete failure** â€” 7 separate workflow attempts (various SerpAPI errors: unsupported `lr` parameter, unsupported `US` location, `location`+`uule` conflict, JSON parse error from SerpAPI malformed response, missing `q` parameter). **No clean output was ever produced.** This is the worst-case reliability scenario for Config C.
- **Kimi-K2.5 needed 3 tries** â€” 1st: missing `q` error. 2nd: empty output `{}`. 3rd: clean output with 2 successful searches.
- **GPT-5.2 searched 6 times** and surfaced **heavily irrelevant sources** including Infinispan docs, SAP Cloud Platform PDF, Intercom Android CHANGELOG, Redisson CHANGELOG, IBM WebSphere page â€” SerpAPI returned wrong results for Java OOM queries, and GPT didn't filter them. GPT honestly admitted no Spring Boot 3.2.1-specific OOM issue was found.
- **Verdict: Config C is severely unreliable for this test case** â€” 1 complete failure (GLM), 1 requires 3 attempts (Kimi), 1 with 6 noisy searches returning irrelevant sources (GPT). Only Gemini and the Claude models produced reliable search-augmented outputs on first try.

| Model                        | Tokens                                        | Searched?           | Rating        | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ---------------------------- | --------------------------------------------- | ------------------- | ------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Qwen3.5 Plus**             | 4030                                          | âŒ No               | ðŸŸ¢ **Best**   | Best no-search output. "Instant spike" vs "sawtooth" visual distinction for diagnosing allocation vs leak âœ…. `Hibernate first-level cache` growth pattern clearly explained. `StatelessSession` for bypassing first-level cache âœ…. Prometheus `jvm_memory_used_bytes` rate-of-change alert. MITRE N/A âœ…. `entityManager.clear()` + `em.flush()` in batch loop with specific checkpoint interval (every 50). Three concrete badâ†’good code scenarios.                                                          | No search = no Spring Boot 3.2.1-specific findings (Spring Batch 5.1 context serialization changes, which Gemini found, went unnoticed). `stepBuilderFactory.get(...)` used in code sample â€” **deprecated in Spring Batch 5.x / Spring Boot 3** (same error as all other models).                                                                                                                                                                                                                                                                                                                                                       |
| **Gemini Pro 3 Pro Preview** | 96321                                         | âœ… Yes (3)          | ðŸŸ¢ **Best**   | **Spring Batch 5.1 context serialization finding** âœ… â€” Spring Boot 3.2.1 bundles Spring Batch 5.1 (confirmed). The `MapJobRepositoryFactoryBean` removal and JSON serialization of `JobExecutionContext` in 5.1+ means large objects in context cause instant heap spike before step 1 runs â€” this is a version-specific root cause no other model found. Correctly identified Spring Boot 3.2.1 + Spring Batch 5.1 bundle âœ…. `JobParameters` abuse and `ExecutionContext` mass serialization as OOM sources. | 96,321 tokens for 3 searches (Google model 1-search-per-loop pattern). `stepBuilderFactory.get(...)` in code sample â€” **deprecated in Spring Batch 5.x/Spring Boot 3** âœ… confirmed (replacement: `new StepBuilder("name", jobRepository)`). No `StepBuilderFactory` deprecation warning despite providing Spring Boot 3.2.1 code.                                                                                                                                                                                                                                                                                                      |
| **Claude Opus 4.5**          | 36370                                         | âœ… Yes (3)          | ðŸŸ¢ **Great**  | GitHub `booklore-app/booklore#1732` citation âœ… real (OOM on batch metadata update, Dec 2025, resolved by chunking). `async-profiler -e alloc` for allocation profiling â€” most precise diagnostic tool (allocation-specific profiling, not just CPU). `-XX:ExitOnOutOfMemoryError` for fast fail + orchestrator restart. `@AfterChunk` callback to clear EntityManager per chunk boundary â€” Spring Batch lifecycle hook, operationally correct âœ….                                                              | `stepBuilderFactory.get(...)` in code sample â€” **deprecated in Spring Batch 5.x** âŒ. `spring-projects/spring-tools#1219` cited (Spring Tools OOM for large projects) â€” this is IDE tooling OOM, not production batch OOM. Irrelevant citation used to support "Spring ecosystem memory pressure."                                                                                                                                                                                                                                                                                                                                      |
| **Claude Sonnet 4.5**        | 45590                                         | âœ… Yes (3)          | ðŸŸ¢ **Great**  | **Spring Boot 3.2.12 is latest 3.2.x patch** âœ… (confirmed, released Nov 2024). Correctly concluded no critical memory leak patches between 3.2.1 and 3.2.12 â€” so upgrade helps with bug fixes, not a heap regression fix. `endoflife.date/spring-boot` as a reference âœ… legitimate. K8s resource limits (`memory: "10Gi"` for a JVM with `-Xmx8g`) is correct â€” native memory overhead requires headroom above heap.                                                                                          | `stepBuilderFactory.get(...)` deprecated âŒ. Cites `spring-framework/issues/31999` as "Spring Boot memory size increase" â€” this is a Spring Framework core issue about default memory footprint, tangentially related but not about batch OOM patterns. Stack Overflow URL cited is for a different Spring 3.2.1 REST service issue, not batch.                                                                                                                                                                                                                                                                                         |
| **Kimi-K2.5**                | 2005+23480 (failed) + 37134                   | âœ… Yes (2, 3rd try) | ðŸŸ¡ **Good**   | `spring-data-jpa/issues/3283` âœ… real (OutOfMemory after Spring Boot 3 migration, Dec 2023). Baeldung large result set guide âœ…. "Default pagination loads all data into memory first, then paginates in Java (not in SQL)" â€” important clarification that naive pagination without `JpaPagingItemReader` still loads everything first.                                                                                                                                                                         | **Needed 3 workflow runs** â€” 2 SerpAPI failures before success. `stepBuilderFactory.get(...)` deprecated âŒ. `StepBuilderFactory.get("importStep")` in code samples. The spring-data-jpa #3283 issue is about `@SpringBootTest` test context OOM, not production batch job OOMâ€”somewhat mis-contextualized as production evidence.                                                                                                                                                                                                                                                                                                      |
| **GPT-5.2**                  | 35840                                         | âœ… Yes (6)          | ðŸŸ¡ **Good**   | Honest â€” explicitly stated "No Spring Boot 3.2.1 OOM/memory-leak issue surfaced in targeted searches." Recommended `jcmd $PID GC.class_histogram` for quick class histogram without full heap dump (faster than jmap). `-Xlog:gc*,safepoint:` unified logging syntax âœ… (Java 9+). Container cgroup memory limit check (`/sys/fs/cgroup/memory.max`) for containerized deployments.                                                                                                                             | **6 searches returned heavily irrelevant sources**: Infinispan tuning docs, SAP Cloud Platform PDF, Intercom Android CHANGELOG, Redisson CHANGELOG, IBM WebSphere â€” SerpAPI could not find relevant Spring Boot OOM articles and returned unrelated Java docs. GPT included these in "Sources Consulted" without noting irrelevance. No `stepBuilderFactory` deprecation flag (doesn't provide Spring Batch code samples, which is a conservative but correct choice).                                                                                                                                                                  |
| **GLM-4.7**                  | 6669+6898+68533+69782+3373+33687 (all failed) | âŒ FAILED (7 tries) | ðŸ”´ **Failed** | â€”                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | **Complete failure across all 7 attempts.** Errors: unsupported `lr=en` parameter, unsupported `US` location, `location`+`uule` conflict, JSON parse error from malformed SerpAPI response (`SyntaxError: Unexpected token ','`), missing `q` parameter. The JSON parse error (`"Results_"... is not valid JSON`) indicates SerpAPI returned a corrupted/partial response that the agent couldn't parse, causing it to emit an empty tool call `[]` â€” the most severe failure mode, going beyond parameter errors to API-level data corruption. Total tokens burned: ~188,000+ across 7 failed attempts. **No usable output produced.** |

> **Key Learnings:**
>
> 1. **GLM's complete 7-attempt failure is the most important Config C finding for this test** â€” 7 successive SerpAPI errors including a JSON parse failure from a malformed API response. This isn't a parameter misconfiguration â€” the API returned corrupted data in at least 2 attempts. ~188k tokens burned with zero output. For any production SLA, this is an unacceptable failure mode that must be mitigated by a maximum retry limit and graceful degradation to internal knowledge.
> 2. **`StepBuilderFactory` is deprecated in Spring Batch 5.x / Spring Boot 3** â€” every model that provided Spring Batch code used `stepBuilderFactory.get(...)`, which was removed in Spring Batch 5.0. Spring Boot 3.2.1 bundles Spring Batch 5.1. The correct pattern is `new StepBuilder("name", jobRepository).chunk(100, transactionManager)`. This is a **universal code correctness issue** across all 5 models that provided Spring Batch examples â€” in a real incident, a developer following this guidance would encounter compilation errors.
> 3. **Gemini's Spring Batch 5.1 context serialization finding is the unique search value-add** â€” Spring Boot 3.2.1 bundles Spring Batch 5.1 (confirmed âœ…), which changed `JobExecutionContext` serialization from Java to JSON. Placing large objects in the execution context causes immediate JSON serialization â†’ heap explosion _before step 1 runs_. This matches the "instant spike" symptom exactly and is version-specific. No other model found this.
> 4. **GPT's 6 searches returned noise** â€” Infinispan, SAP PDF, Intercom Android, IBM WebSphere are all irrelevant to Spring Boot batch OOM. SerpAPI could not surface relevant articles for this query, and GPT included them all in "Sources Consulted" without flagging irrelevance. This is **worse than not searching**: irrelevant sources in a triage report create false-credibility for unfounded conclusions. Credit to GPT for at least admitting "no Spring Boot 3.2.1 specific issue found."
> 5. **Qwen's no-search output is the most production-deployable** â€” three concrete badâ†’good code scenarios, `StatelessSession` tip, Prometheus rate-of-change alert, and honest MITRE N/A. The only gap is Gemini's version-specific Spring Batch 5.1 finding, which requires actual search to discover.
> 6. **The "instant spike" diagnostic is the most important differentiator** â€” all models correctly used the flatâ†’spike pattern to distinguish a single-allocation event from a gradual leak. This is the highest-quality internal knowledge contribution across all outputs, and it would be 100% correct in practice. The pattern diagnoses `findAll()` or unbounded aggregation immediately.
> 7. **Kimi's spring-data-jpa #3283 is real but mis-contextualized** â€” the issue is about `@SpringBootTest` context OOM (test-time), not production batch jobs. Presenting it as evidence of production OOM patterns from Spring Boot 3 migration is a slight conflation. The symptom (massive OOM with JPA in Spring Boot 3) is related, but the root cause (test context scoping) differs.
> 8. **Token cost of Config C chaos**: GLM: ~188k (all wasted). Kimi: ~62k for what should be a ~25k case. GPT: 35.8k with 6 irrelevant searches. Compare to Qwen at 4k for equally actionable output. The Config C cost-quality ratio for this test case is the worst observed across all test cases.

---

## ðŸŸ  Version / Vendor Specific (Search Is the Only Path)

_These cannot be solved without an external lookup. Quality depends entirely on query precision._

### 5. Real Version-Specific Bug â€” Node.js v22.5.0 V8 Crash

**Goal:** Find the real GitHub regression in Node.js v22.5.0 â€” not a hallucinated explanation.

```text
[ALERT] Node.js service crash loop
Error: FATAL ERROR: v8::Object::GetCreationContextChecked No creation context available
Node.js version: v22.5.0 (upgraded yesterday, no code changes)
Crash pattern: Process restarts every few minutes. npm scripts fail immediately.
```

- **Expectation:** Agent queries GitHub and finds **nodejs/node#53902** â€” a confirmed regression in v22.5.0 with dual root causes (V8 fast API `fs.closeSync` + `lib/internal/fs/read/context.js` destructuring). Fix: upgrade to v22.5.1 or downgrade to v22.4.0; `npm rebuild` helps if native addons are involved.
- **Manual vs Auto Delta:**
  - **Auto (Tavily):** May return generic V8 crash pages.
  - **Manual (SerpAPI, `site:github.com/nodejs/node`):** Most likely to find the exact issue thread.
  - **Manual (Tavily, `searchDepth: advanced`):** Should surface the Node.js changelog and GitHub issue.

#### ðŸ”¬ Fact-Check (GitHub-Verified)

> âœ… **This is a real, documented regression.**
>
> - **Issue**: nodejs/node**#53902** â€” "Node 22.5.0 started to crash and hangs on different cases" _(test spec mistakenly listed #53900)_
> - **Error**: `FATAL ERROR: v8::Object::GetCreationContextChecked No creation context available`
> - **Root cause (dual)**: (1) Destructuring of `internalBinding('fs')` in `lib/internal/fs/read/context.js` â€” `const { close } = internalBinding('fs')` caused `close` to lose its V8 creation context. (2) V8 Fast API added to `fs.closeSync` inadvertently affected async `fs.close`, breaking callback resolution.
> - **Affected**: Node.js v22.5.0 specifically
> - **Fix**: Upgrade to **v22.5.1** (released July 19, 2024, within 48 hours) or downgrade to v22.4.0
> - **Reported**: July 17, 2024

#### ðŸ“Š Analysis Results â€” Config A (Tavily, Auto Parameters)

**Did any model invoke search?**

- **All 7 models searched** âœ… â€” unanimous and correct. The version number (`v22.5.0`), the specific FATAL ERROR string, and "no code changes" are unambiguous signals requiring external lookup. No model attempted to diagnose from internal knowledge alone.
- **Kimi-K2.5 needed 2 tries** â€” 1st attempt returned empty output `{}` (searches succeeded, generation failed â€” same generation-failure pattern seen in TC4). 2nd attempt succeeded cleanly with 2 searches and found #53902.
- **No Tavily tool failures** â€” all searched completed successfully across all models and all attempts.
- **Verdict: Config A is the clearest Tavily win for TC5** â€” GPT's token cost dropped 11Ã— (183,543 â†’ 16,105), Kimi found #53902 this time (vs missing it entirely in Config C with SerpAPI), and Gemini remained efficiently 1-search-per-run at just 6,555 tokens (vs 26,400 in Config C). The core correctness is identical â€” all models identified #53902 and v22.5.1 â€” but Config A achieves this at dramatically lower cost.

| Model                        | Tokens              | Searched?      | Rating       | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ---------------------------- | ------------------- | -------------- | ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Gemini Pro 3 Pro Preview** | 6555                | âœ… Yes (1)     | ðŸŸ¢ **Best**  | **Most efficient output in the entire test suite for a search-required case** â€” 1 search, 6,555 tokens. Found #53902 âœ…, v22.5.1 fix âœ…, July 19 date âœ…. `node -v` â†’ downgrade/upgrade â†’ `npm start` â€” correct three-step triage. `FROM node:22.5.1` Docker fix. Rollback to v22.4.1 âœ… (real release, July 8 2024 security release â€” correct downgrade target) AND option to pin `.nvmrc` to 22.5.1.                                                                                                                                                                                                                                                                                      | Slightly light on root cause depth (no commit/PR details). No Render.com or community impact context â€” briefest output of the Config A set.                                                                                                                                                                                                                                                                                                                                                                         |
| **Claude Opus 4.5**          | 13696               | âœ… Yes (2)     | ðŸŸ¢ **Best**  | **Most technically complete** â€” found #53902 âœ…, PR #53904 âœ… (real: "Revert 'fs: add v8 fast api to closeSync'" by Aviv Keller, confirmed âœ…), commit `e2deeedc6e` âœ… confirmed as the revert commit. `curl -fsSL https://nodejs.org/dist/v22.5.1/...` direct binary download option (systems without nvm). `sudo n 22.5.1` via the `n` version manager. PM2 `max_restarts: 10`, `min_uptime: '10s'` health check config âœ… â€” prevents infinite restart storm.                                                                                                                                                                                                                             | **Recommends `rm -rf node_modules package-lock.json; npm cache clean --force; npm install`** after version change âŒ â€” unnecessary for a runtime-level regression. The bug is in the Node.js binary, not in npm packages or lock files. Cache clearing adds ~5 minutes of package reinstallation for no benefit. Same issue flagged in Config C for Sonnet. Also cites "v22.6.0+ recommended for additional stability" â€” v22.6.0 is the next major version bump, not a stability patch; the minimal fix is v22.5.1. |
| **GLM-4.7**                  | 12267               | âœ… Yes (2)     | ðŸŸ¢ **Best**  | **Most thorough source set** â€” #53902 âœ…, official v22.5.1 release notes âœ…, npm/cli#7657 âœ…, yarnpkg/berry#6398 âœ…, LinkedIn technical breakdown (Lakin Mohapatra) âœ…, Japanese community report on zenn.dev âœ…, commit `e2deeedc6e` cited âœ…. MITRE: Not Applicable âœ…. Node.js team 3-day turnaround highlighted. `node -e "const fs = require('fs'); const fd = fs.openSync('/tmp/test', 'w'); fs.closeSync(fd);"` â€” direct reproduction test of the exact crash path âœ… â€” the most diagnostic immediate verification step. Rollback to v22.4.1 âœ… correct (real security release).                                                                                                     | 2 searches for 6 sources is efficient, but LinkedIn post is a lower-authority source. No distinction made between destructuring and V8 Fast API as dual root causes.                                                                                                                                                                                                                                                                                                                                                |
| **GPT-5.2**                  | 16105               | âœ… Yes (4)     | ðŸŸ¢ **Great** | **Biggest Config A improvement over Config C** â€” dropped from 12 searches/183,543 tokens (Config C) to 4 searches/16,105 tokens. Found #53902 âœ…, npm/cli#7657 âœ…, v22.5.1 release notes âœ…. `node -p "process.version"` and `which node && node -p "process.execPath"` â€” dual-path version verification (detects mismatches between `nvm`-active and system-installed Node). `NODE_OPTIONS="--report-on-fatalerror --report-directory=/tmp/node-reports"` pre-crash diagnostic instrumentation âœ…. Severity "High" (not Critical) â€” this is the most accurate severity label: process crash is High, but recoverable in under 15 minutes once identified, which doesn't meet Critical bar. | 4 searches where 2 sufficed. Doesn't cite the revert commit hash or PR #53904 â€” stays at changelog/issue level.                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Qwen3.5 Plus**             | 18045               | âœ… Yes (3)     | ðŸŸ¢ **Great** | Revert commit `e2deeedc6e` âœ… cited with direct GitHub commit URL. MITRE: Not Applicable âœ…. Correctly framed: "Only version 22.5.0 is affected. Versions 22.4.x and 22.5.1+ are safe." `journalctl -u <your-node-service> -f` for log monitoring post-fix. In Config C, Qwen got the fix version **wrong** (cited v22.6.0); in Config A, Qwen gets it **correct** (v22.5.1).                                                                                                                                                                                                                                                                                                               | **Rollback target v22.4.0 is suboptimal** âš ï¸ â€” other models correctly recommended v22.4.1, which was a security patch release (July 8, 2024) that fixed CVE-2024-36138, CVE-2024-22020, and others. Downgrading to v22.4.0 instead of v22.4.1 re-exposes the system to those CVEs. 3 searches, 18,045 tokens â€” over-searched; answer available in 2 sources.                                                                                                                                                        |
| **Claude Sonnet 4.5**        | 26153               | âœ… Yes (4)     | ðŸŸ¢ **Great** | **Most complete community context** â€” Render.com community thread âœ… real, uWebSockets.js#1133 âœ… real (cross-project reproduction), Wesley Todd (@wesleytodd) PSA âœ…. `node::fs::FastClose()` and `FSReqCallback::Resolve` in the call stack correctly traced. `--report-on-fatalerror` for diagnostic report generation. `engines` field in package.json: `"node": ">=22.5.1 <23.0.0"` âœ…. RSS feed `https://nodejs.org/en/feed/releases.xml` for release monitoring â€” practical prevention tool. Rollback to v22.4.1 âœ… correct.                                                                                                                                                         | `rm -rf node_modules package-lock.json; npm cache clean --force` âŒ â€” unnecessary step for a runtime-level regression (same issue as Opus). 4 searches, 26,153 tokens â€” highest cost; Gemini matched quality in 1 search at 6,555 tokens. Severity "Critical" â€” slightly inflated (same observation as Config C).                                                                                                                                                                                                   |
| **Kimi-K2.5**                | 1469 (fail) + 11672 | âœ… Yes (2 + 2) | ðŸŸ¢ **Great** | **Critical Config A redemption** â€” In Config C (SerpAPI), Kimi ran 4 searches and **missed #53902** entirely. In Config A (Tavily), Kimi found #53902 âœ…, npm/cli#7657 âœ…, yarnpkg/berry#6398 âœ… in 2 searches. Explicitly cites issue labels: "confirmed-bug, regression" and "fs (filesystem subsystem), v8 engine." Rollback to v22.4.1 âœ… correct. `pm2 restart all` for process manager restart. "Node.js team response: Quick 3-day turnaround" accurate framing. "No application code changes needed" clearly stated.                                                                                                                                                                | **First attempt generated empty output** again (`{}`) â€” same generation failure pattern as TC4. Kimi's Tavily calls succeed but agent response is empty on first try â€” this is Kimi-specific behavior (not a Tavily failure). Pattern now seen twice (TC4, TC5).                                                                                                                                                                                                                                                    |

> **Key Learnings:**
>
> 1. **Config A achieves the same correctness at dramatically lower cost for TC5** â€” every model found #53902 and v22.5.1. The differentiator is pure efficiency: Gemini 6,555 vs. previous Config C 26,400 tokens; GPT 16,105 vs. 183,543 tokens (11Ã— improvement); Opus 13,696 vs. 29,729 tokens. Tavily appears to return relevant results on fewer searches for this well-documented and deeply indexed regression.
> 2. **v22.4.1 is correct â€” models recommending it as rollback are right** âœ… â€” v22.4.1 was released July 8, 2024 as a security patch (fixing CVE-2024-36138, CVE-2024-22020, and others). The full sequence is `22.4.0 â†’ 22.4.1 â†’ 22.5.0 â†’ 22.5.1`. Gemini, GLM, Sonnet, and Kimi all correctly cited v22.4.1 as the rollback target. **Qwen's recommendation of v22.4.0 is the less optimal path** âš ï¸ â€” downgrading to 22.4.0 re-exposes the service to the CVEs patched in 22.4.1. v22.4.1 is the ideal "last known safe" version before the regression.
> 3. **Kimi's Config C failure on this test was Tavily-fixable** â€” In Config C, Kimi's 4 SerpAPI searches returned changelog-level content and missed the GitHub issue. In Config A, 2 Tavily searches surfaced #53902, the npm issue, and the yarn issue. This is direct evidence that Tavily indexes GitHub issue content more reliably than SerpAPI for this class of query (specific issue number in a known repository).
> 4. **GPT's 11Ã— token reduction is the biggest individual improvement** â€” from 183,543 tokens (12 searches, Config C) to 16,105 tokens (4 searches, Config A). Same correct answer. The quality differential is nil. This is the strongest individual-model argument for Tavily over SerpAPI in the test suite. The 12-search spiral in Config C was driven by SerpAPI returning inconsistent results that kept GPT searching; Tavily returned relevant results on the first 2 searches.
> 5. **Gemini's 6,555 token run is the efficiency benchmark for search-required tests** â€” 1 search, correct #53902 reference, v22.5.1 fix, correct v22.4.1 rollback target. This establishes a lower-bound: a well-executed search-required triage note can be done in ~6-7k tokens. All other models in this test spent 2â€“4Ã— that. The only real weakness is lack of root cause depth (no commit/PR detail).
> 6. **PR #53904 and commit `e2deeedc6e` are verified real** âœ… â€” Opus cited the PR number directly; GLM and Qwen cited the commit hash. Both are confirmed via nodejs.org and GitHub. Citing the revert PR in a triage note is the highest technical precision level â€” it allows the team to understand exactly what changed and in which direction. Gemini and GPT stayed at the issue-level without the commit detail.
> 7. **`npm cache clean --force` is a false hardening step** (Opus, Sonnet) â€” for a runtime-level regression, the fix is purely in the Node.js binary version. Clearing the npm cache and reinstalling packages wastes time and can introduce transient dependency resolution issues. The correct fix is: verify version â†’ change Node binary â†’ restart. No package-level action needed.
> 8. **Severity calibration: "High" (GPT) is more accurate than "Critical" (Kimi, GLM, Qwen, Sonnet, Opus)** â€” this is a well-known regression with a 3-day-old official patch and a 5-minute resolution time. Critical severity implies potential data loss, security breach, or irreversible damage. A process crash that resolves in one `nvm use` command is High severity (service down, business impact, fast fix available). GPT's "High" is the most calibrated label.

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **All 7 models searched** âœ… â€” unanimous and correct. This issue cannot be solved without a lookup; the specific version and error message require external verification.
- **No SerpAPI failures** in this test â€” all searches succeeded cleanly. This is the smoothest Config C execution so far for a search-requiring test case.
- **Verdict: Config C works for this test** â€” all models correctly identified nodejs/node#53902 and the v22.5.1 fix, with the **sole exception of Qwen citing the wrong fix version** (v22.6.0 instead of v22.5.1). The main differentiator is cost efficiency, not correctness.

| Model                        | Tokens | Searched?   | Rating      | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                    | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                              |
| ---------------------------- | ------ | ----------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------- |
| **Gemini Pro 3 Pro Preview** | 26400  | âœ… Yes (1)  | ðŸŸ¢ **Best** | **Most efficient** â€” 1 search, 26,400 tokens. Correctly identified #53902, v22.5.1 fix, July 19 release. Dockerfile mitigation (`FROM node:22.5.1-alpine`). Clean triage: stop loop â†’ fix version â†’ verify.                                                                                                                                                                                                                                      | Slightly light on root cause depth (didn't distinguish the destructuring vs fs.closeSync dual cause). No Render.com or community impact context.                                                                                                                                                                                                                                                        |
| **GLM-4.7**                  | 35067  | âœ… Yes (4)  | ðŸŸ¢ **Best** | **Most complete research output** â€” found #53902, official Node.js v22.5.1 release notes, parvesh.blog technical deep-dive âœ… (real article on how `internalBinding('fs')` destructuring broke context), devtalk announcement âœ…, Stack Overflow Docker build report âœ…, Boffin Coders news âœ…. "Broke almost all applications in v22.5.0" framing is accurate. Release within 2 days (v22.5.1 July 19) âœ…. All 6 sources are real and relevant. | 4 searches for a 2-source case â€” over-searched slightly, but every source is genuinely relevant (unlike GPT's noise).                                                                                                                                                                                                                                                                                   |
| **Claude Sonnet 4.5**        | 33084  | âœ… Yes (3)  | ðŸŸ¢ **Best** | **Best root cause detail** â€” correctly identified the dual technical path: (1) fs.closeSync V8 Fast API, (2) breaking npm lifecycle scripts. Render.com community report âœ… real. YouTube analysis âœ… real. X/Twitter PSA âœ…. `--report-on-fatalerror` flag for Node diagnostic reports. "Effectively deprecated in <48 hours â€” one of the fastest reverts in Node.js history" â€” accurate framing. "v22.13.x as of Feb 2026" LTS reference.      | `rm -rf node_modules package-lock.json; npm cache clean --force; npm install` after version change â€” unnecessary for a runtime-level fix (not a dep issue).                                                                                                                                                                                                                                             |
| **Claude Opus 4.5**          | 29729  | âœ… Yes (2)  | ðŸŸ¢ **Best** | **Most efficient Claude** â€” 2 searches, 29,729 tokens. Found #53902 âœ…, v22.5.1 âœ…, boffincoders âœ…, official changelog âœ…. `curl -fsSL https://nodejs.org/dist/v22.5.1/...` direct binary install option â€” useful for systems without nvm. `sudo n 22.5.1` via the `n` node version manager. "100% reproducible â€” affects all users on v22.5.0" âœ….                                                                                             | No technical root cause explanation (just "V8 engine bug"). Minor: `curl                                                                                                                                                                                                                                                                                                                                | tar`install to`/usr/local` is fine but bypasses package manager. |
| **Qwen3.5 Plus**             | 15998  | âœ… Yes (3)  | ðŸŸ¡ **Good** | Low token cost (15,998) for a search-requiring test. Found #53902 âœ…. Docker and apt remediation paths included. "False positive for app code" framing is valuable â€” teams waste hours debugging their own code. `nvm alias default 22.4.0` rollback path.                                                                                                                                                                                       | **Fix version wrong** âŒ â€” stated "Fixed: v22.6.0 and later" and "FROM node:22.6.0" in Dockerfile example. The actual fix was **v22.5.1**, released July 19, 2024. A responder following this advice would overshoot to v22.6.0 (harmless) but would miss the fact that v22.5.1 is already the minimal fix. Minor inaccuracy with real operational impact.                                              |
| **Kimi-K2.5**                | 51737  | âœ… Yes (4)  | ðŸŸ¡ **Good** | Found the Node v22 changelog and noted the regression pattern. `npm rebuild` suggestion for native addons âœ…. `--no-experimental-worker` and heap reduction workarounds as fallback paths. Core dump collection steps.                                                                                                                                                                                                                           | **Did not find #53902** â€” stated "no explicitly documented crash for this specific error in the changelog." This is incorrect; #53902 is documented and was filed the same day as the crash. Cited only the changelog URL, not the specific issue. Framed as "no known CVE" â€” technically true but missed the software regression tracking. 4 searches for less complete output than Gemini's 1 search. |
| **GPT-5.2**                  | 183543 | âœ… Yes (12) | ðŸŸ¡ **Good** | Found the Node v22 changelog and confirmed v22.5.0 implication. `--report-on-fatalerror` JVM-style reporting for Node âœ…. Correct advice: upgrade to latest 22.x patch. Honest framing ("most probable cause").                                                                                                                                                                                                                                  | **12 searches, 183,543 tokens** â€” by far the most expensive output. The CHANGELOG.md URL was found on search 1; 11 additional searches yielded no new information. Didn't find #53902 directly â€” only referenced it as "issue #53902 in the changelog context." This is **7x Gemini's token cost for 10% of Gemini's information quality**.                                                             |

> **Key Learnings:**
>
> 1. **All 7 models correctly searched â€” unanimous correct judgment** â€” This is the strongest search-trigger consensus across all test cases. The version number in the alert (`v22.5.0`) combined with "no code changes" is an unambiguous signal that an external lookup is needed. Config C shows no search suppression failures here, unlike CSS previous test cases.
> 2. **Gemini's 1-search efficiency is the headline finding** â€” 26,400 tokens, 1 search, correct answer. Compare to GPT's 183,543 tokens / 12 searches for the same result quality. The "Google model 1-search-per-loop" pattern that was a weakness in SSH Brute Force (sparse results â†’ loop) became a strength here (deterministic result â†’ done). **Search quality is query-dependent, not model-dependent.**
> 3. **GPT's 12-search spiral is the worst token efficiency seen across all test cases** â€” 183,543 tokens is higher than any previous single-model run. GPT kept searching after finding the changelog on search 1. The incremental value of searches 2â€“12 was zero â€” same source, same conclusion. A max-search-iterations guard (e.g., 4) would have saved ~150k tokens.
> 4. **Qwen's v22.6.0 fix version is wrong** âŒ â€” The fix was in **v22.5.1** (July 19, 2024). v22.6.0 is a later release. The correct minimum upgrade path is `v22.5.1`, not `v22.6.0`. Since Qwen searched and found `#53902`, this error wasn't from lack of research â€” it was a misreading or hallucination layered on top of correct source material.
> 5. **Kimi missed the issue despite 4 searches** â€” citing the changelog but concluding "no explicitly documented crash for this specific error" when #53902 exists and is indexed on GitHub. This suggests Kimi's search queries were too broad (changelog-level) rather than issue-specific. The Manual SerpAPI config (`site:github.com/nodejs/node "GetCreationContextChecked"`) would have surfaced #53902 directly â€” this is exactly the gap between Auto and Manual SerpAPI.
> 6. **Test spec correction: issue is #53902 not #53900** â€” All 5 models that found the exact issue (GLM, Gemini, Sonnet, Opus, Qwen) cited #53902. The test spec fact-check block has been corrected. The root cause is also dual-natured (destructuring in `lib/internal/fs/read/context.js` + V8 Fast API `fs.closeSync`), not just `fs.closeSync` alone.
> 7. **GLM's 6-source research is the most thorough** â€” parvesh.blog (technical deep-dive), devtalk, Stack Overflow Docker builds, Boffin Coders, official blog, and the GitHub issue. Every source is real and relevant. Where GPT's over-searching produced noise (Test Case 4), GLM's 4 searches here produced a genuinely comprehensive source list.
> 8. **Sonnet's "npm rebuild" omission is correct** â€” For a runtime-level regression (not an ABI/native addon issue), `npm rebuild` is not needed. Only Kimi mentioned it as a workaround. The correct fix is purely version-level: upgrade or downgrade Node. Sonnet correctly kept the remediation focused on the runtime fix.

### 6. Real Vendor Error Code â€” AWS RDS-EVENT-0056

**Goal:** Reach the actual AWS docs page. Test whether manual domain pinning beats auto.

```text
[ALERT] Amazon RDS Event
Source: db-instance-prod
Event ID: RDS-EVENT-0056
Message: The database instance is in an incompatible network state.
```

- **Expectation:** Agent fetches AWS docs and exposes that the alert message is **wrong**. Real meaning: "Number of databases in the DB instance exceeds recommended best practices" â€” a Warning, not a network error. Resolves with reduce database count recommendation.
- **Manual vs Auto Delta:**
  - **Auto (Tavily):** May return a blog post or community summary â€” acceptable but less authoritative.
  - **Manual (Tavily, `includeDomains: ["docs.aws.amazon.com"]`):** Forces the result from official AWS docs only.
  - **Manual (SerpAPI):** `site:docs.aws.amazon.com RDS-EVENT-0056`.

#### ðŸ“Š Analysis Results â€” Config A (Tavily, Auto Parameters)

**Did any model invoke search?**

- **All 7 models searched** âœ… â€” unanimous and correct. A vendor-specific event code always warrants a lookup against vendor documentation.
- **No Tavily tool failures** â€” all searches completed on first try for all models. Unlike Config C where GLM and Qwen both hit SerpAPI parameter errors on first attempt, Config A had zero tool failures across 7 models.
- **ðŸš¨ HEADLINE FINDING â€” 2/7 models caught the fabricated alert trap** â€” a dramatic improvement over Config C (0/7). **Kimi** explicitly identified the event ID mismatch, citing RDS-EVENT-0036 as the actual incompatible-network event. **GPT** independently raised the same discrepancy. Not a single model caught it in Config C with SerpAPI Auto Parameters.
- **âš ï¸ Qwen made the trap worse** â€” rather than missing the trap silently (like GLM, Gemini, Sonnet, Opus), Qwen explicitly wrote a "Note" asserting that RDS-EVENT-0056 _does_ map to the incompatible-network message, reinforcing the fabricated alert with false confidence. This is actively more dangerous than simply missing the trap.

| Model                        | Tokens | Searched?  | Rating      | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ---------------------------- | ------ | ---------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Kimi-K2.5**                | 17100  | âœ… Yes (2) | ðŸŸ¢ **Best** | **Only model to explicitly call out the fabricated alert trap** âœ… â€” stated: _"While the alert references RDS-EVENT-0056, this event ID actually corresponds to 'excessive databases on instance' best practices warnings. The actual incompatible-network event is RDS-EVENT-0036."_ Direct, accurate challenge to the alert. `AWSSupport-ValidateRdsNetworkConfiguration` SSM runbook âœ…. `start-db-instance` SQL Server caveat âœ…. CloudWatch subnet alarms âœ…. "May indicate a misconfiguration in alerting" â€” precisely correct framing.                                               | Highest token count (17,100) despite catching the trap â€” still provided a full network remediation playbook. Ideal response would lead with the event ID mismatch and reduce or omit the fallback remediation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **GPT-5.2**                  | 13614  | âœ… Yes (2) | ðŸŸ¢ **Best** | **Second model to catch the trap** âœ… â€” _"Important discrepancy: RDS-EVENT-0056 is a notification about too many databases (best practices), while 'incompatible network' is documented under a different event ID (e.g., RDS-EVENT-0036)."_ `describe-db-instances` full output table âœ…, `describe-events --duration 1440` âœ…. `PubliclyAccessible` + `enableDnsHostnames`/`enableDnsSupport` VPC DNS check âœ…. Ends with a diagnostic question asking for DB engine and Multi-AZ status â€” best follow-up triage framing. Severity "High" with clear "may still serve traffic" caveat âœ…. | Still provided the full network remediation playbook despite catching the trap. The closing diagnostic question implies acceptance of the scenario as real if the alert were confirmed correct.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **GLM-4.7**                  | 7024   | âœ… Yes (1) | ðŸŸ¡ **Good** | **Most token-efficient** â€” 7,024 tokens, 1 search. ENI quota check: `aws service-quotas get-service-quota --service-code ec2 --quota-code L-7BA5403X` âœ… real quota code. `restore-db-instance-to-point-in-time` correct syntax âœ…. CloudFormation stack `UPDATE_ROLLBACK_FAILED` cascade risk âœ… â€” real documented behavior. DMS/pg_dump/mysqldump migration paths for no-backup scenario âœ…. "DB may still be accessible at database level even in incompatible-network state" âœ….                                                                                                        | **Missed the fabricated alert trap** â€” took the incompatible-network scenario at face value. PITR guidance missing the `--db-subnet-group-name` parameter to target a different healthy subnet group â€” critical AWS-recommended step.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Gemini Pro 3 Pro Preview** | 6992   | âœ… Yes (1) | ðŸŸ¡ **Good** | **Second most efficient** â€” 6,992 tokens, 1 search. `aws rds describe-db-instances --query "DBInstances[0].DBSubnetGroup.Subnets[*].SubnetIdentifier"` âœ…. `start-db-instance` as low-risk soft start before PITR âœ… correct ordering (cheapest fix first). `>15 IPs recommended` for healthy subnet âœ…. "Management Lockout: Unlike standard 'unavailable' states, you cannot simply click Reboot" âœ… â€” clear framing of the control-plane impact.                                                                                                                                         | **Missed the fabricated alert trap.** PITR guidance also missing `--db-subnet-group-name` targeting a fixed healthy group â€” if restored into the same broken subnet group, the new instance enters the same state. Generic StackOverflow citation without a real URL.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Claude Sonnet 4.5**        | 9861   | âœ… Yes (3) | ðŸŸ¡ **Good** | **Most actionable remediation** â€” `InvalidSubnetID.NotFound` as precise CLI diagnostic signal âœ…. Creates a new fixed DB subnet group before PITR (_`aws rds create-db-subnet-group`_) âœ…. `restore-db-instance-to-point-in-time --db-subnet-group-name db-subnet-group-fixed` âœ… â€” the critical parameter to target the new healthy group. `aws cloudwatch put-metric-alarm` for subnet IP exhaustion with correct `AWS/EC2` namespace âœ…. `aws rds create-event-subscription` âœ…. Subnet tag-based deletion protection (`aws:rds:subnet=true`) âœ… creative prevention.                    | **Missed the fabricated alert trap.** Prevention section subscribes to `RDS-EVENT-0056` events âŒ â€” since RDS-EVENT-0056 is actually a best-practices notification about database count, this adds noise not signal. Direct consequence of accepting the fabricated alert at face value. 3 searches vs GLM's equivalent output at 1 search.                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Claude Opus 4.5**          | 11551  | âœ… Yes (2) | ðŸŸ¡ **Good** | `for subnet in $SUBNET_IDS; do aws ec2 describe-subnets...` bash loop for multi-subnet IP check âœ… â€” most ergonomic subnet inspection. `aws service-quotas --quota-code L-DF5E4CA3` (ENI quota) âœ… real code. `enableDnsHostnames` + `enableDnsSupport` VPC attribute checks âœ…. `aws rds wait db-instance-available` blocking check âœ…. Terraform `aws_cloudwatch_metric_alarm` for subnet IP monitoring âœ… â€” only model to provide IaC for the prevention step. `restore-db-instance-to-point-in-time --db-subnet-group-name <new-subnet>` âœ….                                            | **Missed the fabricated alert trap.** `mysql -h ... -e "SELECT 1;"` as first connectivity step assumes MySQL engine â€” alert doesn't specify engine. `restore-time $(date -u +%Y-%m-%dT%H:%M:%SZ)` restores to _now_ rather than 5 minutes before incident start â€” unusual PITR target time.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Qwen3.5 Plus**             | 14080  | âœ… Yes (3) | ðŸ”´ **Poor** | `modify-db-subnet-group` before `start-db-instance` âœ… â€” correct ordering when subnets need repair first. MITRE T1561/T1499 hedge for malicious subnet deletion âœ… appropriately speculative. `describe-db-subnet-groups --query 'DBSubnetGroups[0].Subnets[].{SubnetId:SubnetIdentifier,Status:SubnetStatus,AvailabilityZone:...}'` â€” most complete subnet group inspection query âœ….                                                                                                                                                                                                      | **Actively reinforced the fabricated alert trap** âŒ â€” wrote an explicit "Note" stating _"Event ID RDS-EVENT-0056 specifically correlates to 'The database instance is in an incompatible network state.' AWS documentation explicitly links this to invalid subnet IDs."_ This is factually wrong and directly contradicts the AWS event messages page. Qwen appears to have misread page structure â€” conflating the incompatible-network troubleshooting guide with the EVENT-0056 notification entry. This false "Note" would increase an operator's confidence in the wrong interpretation â€” the most dangerous possible outcome. Rating drops to ðŸ”´ Poor despite technically sound remediation steps. 3 searches, 14,080 tokens to produce a wrong key finding. |

> **Key Learnings:**
>
> 1. **Config A converts TC6's trap from "unanimous miss" to "partial detection" â€” 2/7 vs 0/7** âœ… â€” Kimi and GPT both caught the event ID mismatch. In Config C, all 7 SerpAPI Auto runs generated generic searches for "RDS incompatible network state VPC subnets," bypassing the event-ID-specific lookup entirely. In Config A, Tavily surfaced the AWS event messages table as a top result, which contains the RDS-EVENT-0056 canonical definition â€” enabling Kimi and GPT to cross-reference and expose the discrepancy.
> 2. **Kimi's explicit trap call-out is the best single model output across all TC6 Config A responses** â€” not only did Kimi identify the mismatch, it framed it actionably: _"This may indicate a misconfiguration in your alerting or the message string was manually set."_ This is the most useful thing an on-call engineer could hear when their alert is wrong. For a test case designed to evaluate event ID verification, Kimi 100% delivered on the test objective.
> 3. **Qwen's "Note" is the most dangerous output in this entire test suite** â€” In Config C, Qwen was the nearest-miss (quoted correct AWS incompatible-network description but didn't connect it to the event ID). In Config A, Qwen accessed the AWS event messages page, appeared to process it, then wrote a confident "Note" asserting RDS-EVENT-0056 _does_ mean incompatible-network. This is a hallucination built on top of real documentation access â€” the worst possible outcome. A human reading Qwen's output would have _more_ confidence in the wrong interpretation than before the model ran. Confidence without verification is more dangerous than uncertainty.
> 4. **Tavily's indexing of `USER_Events.Messages.html` directly enabled trap detection** â€” the key Config A vs Config C difference. Tavily returned the official AWS event definitions page for queries like "RDS-EVENT-0056 incompatible network," while SerpAPI Auto returned narrative blog posts and re:Post discussions about "incompatible network state" that don't contain the event definition table. This is a qualitative difference in result type, not just a token cost difference.
> 5. **GLM and Gemini tied as the efficiency benchmark (~7k tokens, 1 search each)** â€” both produced actionable and technically sound remediation. GLM's ENI quota code (`L-7BA5403X`) and CloudFormation cascade risk are depth Gemini missed. Gemini's 15+ IP sizing heuristic and "soft start before PITR" ordering are value Gemini adds. They're complements â€” but both miss the trap, so they're "good wrong answers" in the TC6 context.
> 6. **Sonnet's `--db-subnet-group-name` in the PITR command is operationally critical** âœ… â€” restoring to PITR without specifying a different healthy subnet group lands the restored instance in the same broken network state (explicitly warned in AWS documentation). Sonnet and GPT are the only models to explicitly parameterize this correctly. Kimi and GLM both show PITR without this critical override.
> 7. **`RDS-EVENT-0036` as the incompatible-network event ID: Kimi and GPT's claim is directionally correct** â€” The AWS docs confirm that RDS-EVENT-0056 â‰  incompatible-network. Whether the incompatible-network failure event is precisely 0036 or another number, the core verified fact is that 0056 = databases best-practices notification. Both models' identification of the mismatch is accurate and actionable regardless of the precise alternate ID.
> 8. **No Config A model generated the ideal response** â€” the optimal output is: _"RDS-EVENT-0056 is a best-practices notification about database count, not a network error. Your alert text is incorrect â€” verify your alerting configuration before treating this as a network incident."_ Neither Kimi nor GPT led with this framing; both still delivered network remediation playbooks after noting the discrepancy. Catching the trap while solving the wrong problem beats not catching it â€” but the optimal response remains unachieved across both configs.

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **All 7 models searched** âœ… â€” correct judgment for a vendor-specific event code. An alert with a specific event ID like `RDS-EVENT-0056` should always be verified against vendor docs.
- **GLM failed 1st attempt** â€” `lr` parameter error (consistent pattern). 2nd try succeeded.
- **Qwen failed 1st attempt** â€” `as_sitesearch` SerpAPI parameter format error (new error type for Qwen, previously reliable). 2nd try succeeded.
- **ðŸš¨ CORE FINDING â€” 7/7 models missed the test trap:** The alert message `"The database instance is in an incompatible network state."` is fabricated. **RDS-EVENT-0056** actually means `"The number of databases you have for your DB instance exceeds the recommended best practices for Amazon RDS."` â€” a low-severity Warning to reduce database count, not a network incident. **No model cross-referenced the event ID against the AWS docs page to expose the discrepancy.** All 7 models took the fabricated message at face value and triaged a network incident that doesn't exist.

| Model                        | Tokens                | Searched?           | Rating      | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                 | Weaknesses                                                                                                                                                                                                                                                                                                                                    |
| ---------------------------- | --------------------- | ------------------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Gemini Pro 3 Pro Preview** | 24882                 | âœ… Yes (2)          | ðŸŸ¡ **Good** | **Most efficient** â€” 2 searches, 24,882 tokens. `AWSSupport-ValidateRdsNetworkConfiguration` SSM runbook âœ… real. Correctly noted "Blocking State: you cannot simply restart the instance." Subnet protection via SCPs suggestion. Multi-AZ failover risk framing ("High Risk During Failover"). `netsh advfirewall` â†’ `nc -vz` for connectivity check.                                                       | **Missed the fabricated message trap.** Treated "incompatible network" at face value.                                                                                                                                                                                                                                                         |
| **GPT-5.2**                  | 21201                 | âœ… Yes (3)          | ðŸŸ¡ **Good** | Most efficient non-error run â€” 21,201 tokens. CloudTrail `DeleteSubnet` lookup âœ… correct approach. Note about `start-db-instance` sometimes unsticking read replicas âœ… documented on re:Post. "Strong indicator of recent infra changes (Terraform drift)" â€” operationally relevant framing. IaC guardrails recommendation (`prevent_destroy`).                                                             | **Missed the fabricated message trap.** 3 searches where 2 would suffice.                                                                                                                                                                                                                                                                     |
| **Kimi-K2.5**                | 23496                 | âœ… Yes (2)          | ðŸŸ¡ **Good** | `aws ec2 describe-subnets --query 'Subnets[*].[SubnetId,AvailableIpAddressCount,CidrBlock]'` â€” most complete subnet inspection query. CloudWatch `AvailableIpAddresses` alarm âœ… real metric. `aws rds create-event-subscription` via SNS âœ… correct. `aws rds start-db-instance` for read replicas in this state âœ… documented.                                                                              | **Missed the fabricated message trap.** "Automated backups disabled" cited as a cause of incompatible-network âŒ â€” AWS docs list subnet deletion, IP exhaustion, and deleted ENIs as causes, not backup configuration. The backup claim is technically inaccurate given the actual (fabricated) scenario being diagnosed.                     |
| **GLM-4.7**                  | 13891+22189 (2nd try) | âœ… Yes (2, 2nd try) | ðŸŸ¡ **Good** | `AWSSupport-ValidateRdsNetworkConfiguration` SSM runbook âœ… â€” cited with full documentation URL. Most complete troubleshooting path: SSM runbook â†’ manual validation â†’ modify-db-subnet-group â†’ start-db-instance â†’ restore from snapshot. Dual-stack IPv6 CIDR disassociation as a lesser-known trigger âœ… (real, per AWS VPC docs).                                                                         | **Missed the fabricated message trap.** 1st attempt failed with `lr` parameter error â€” consistent GLM SerpAPI calibration failure.                                                                                                                                                                                                            |
| **Claude Sonnet 4.5**        | 34311                 | âœ… Yes (3)          | ðŸŸ¡ **Good** | Most comprehensive remediation tree. `RDS_VPC_ID=$(aws rds describe-db-instances ...)` â€” chained CLI commands for automating subnet lookup. EventBridge Lambda remediation workflow suggestion is the highest-maturity prevention. AWS Config rule `rds-multi-az-support` âœ… real. `--deletion-protection` for the RDS instance âœ…. 3 AWS sources + Stack Overflow + re:Post.                                 | **Missed the fabricated message trap.** "481+ related discussions on AWS re:Post" â€” this is a fabricated/hallucinated statistic. AWS re:Post search volume is not published data; no model has access to that figure. 3 searches for what GPT handled in 3 searches with fewer tokens.                                                        |
| **Claude Opus 4.5**          | 36698                 | âœ… Yes (4)          | ðŸŸ¡ **Good** | **Most technically detailed.** Dual-stack IPv6 CIDR disassociation âœ… real cause per AWS VPC Working Guide. `aws ec2 describe-network-interfaces --filters "Name=description,Values=*RDS*"` â€” ENI inspection âœ… (RDS manages its own ENIs). CloudTrail `DisassociateSubnetCidrBlock` lookups â€” complete change audit trail. `aws rds wait db-instance-available` for blocking readiness check âœ….             | **Missed the fabricated message trap.** 4 searches, 36,698 tokens â€” highest cost for this test case with no additional correctness gain.                                                                                                                                                                                                      |
| **Qwen3.5 Plus**             | 10947+21097 (2nd try) | âœ… Yes (3, 2nd try) | ðŸŸ¡ **Good** | Best identification of the trap mechanism: explicitly quoted the **exact AWS event message** â€” "The DB instance is in an incompatible network. Some of the specified subnet IDs are invalid or do not exist." âœ… and confirmed via AWS docs. `prevent_destroy` Terraform lifecycle suggestion âœ…. MITRE T1565.001 (Modify Cloud Compute Infrastructure) for malicious subnet deletion â€” appropriately hedged. | **Missed the fabricated message trap** â€” despite quoting the correct AWS definition for "incompatible-network" state from AWS docs, Qwen did not notice that this definition contradicts the alert's event ID (RDS-EVENT-0056 â‰  incompatible-network). 1st attempt failed with `as_sitesearch` SerpAPI parameter error â€” rare error for Qwen. |

> **Key Learnings:**
>
> 1. **7/7 missed the fabricated alert message â€” the most complete test failure in this entire suite.** The trap: the alert's `Message:` field says "incompatible network state," but RDS-EVENT-0056 is actually "Number of databases exceeds recommended best practices" (severity: Warning). Not one model ran `site:docs.aws.amazon.com RDS-EVENT-0056` to cross-validate the event ID against its canonical definition. SerpAPI's Auto Parameters generated generic searches for "incompatible network state" rather than the event-ID-specific query that Manual SerpAPI would have forced.
> 2. **The test goal â€” "agent fetches AWS docs and exposes that the alert message is wrong" â€” was completely missed.** Instead of returning "RDS-EVENT-0056 is a best-practices warning about too many databases â€” your alert text is incorrect," all 7 models returned extensive VPC subnet remediation playbooks for a condition that doesn't match this event ID. A manual SerpAPI query `site:docs.aws.amazon.com RDS-EVENT-0056` would have fetched the event messages table directly, exposing the mismatch immediately.
> 3. **The AWSSupport-ValidateRdsNetworkConfiguration SSM runbook is real** âœ… â€” cited by GLM, Gemini, and Sonnet. It is an actual AWS Systems Manager automation document for diagnosing RDS network states. However, it's irrelevant here since the event ID maps to a different condition entirely.
> 4. **Qwen came closest to detecting the trap** â€” it quoted the _correct_ AWS definition for incompatible-network ("Some of the specified subnet IDs are invalid or do not exist") from the AWS docs, but failed to notice this sentence doesn't come from an RDS-EVENT-0056 result â€” it comes from the RDS Troubleshooting guide's general state description. If Qwen had searched `site:docs.aws.amazon.com RDS-EVENT-0056`, the events table would have returned "databases exceed best practices" not "incompatible network."
> 5. **Sonnet's "481+ related discussions on AWS re:Post" is a hallucinated statistic** âŒ â€” AWS re:Post does not publish search volume metrics; this number is fabricated. Minor in context but illustrates how models add phantom credibility statistics when researching AWS topics.
> 6. **Kimi's "automated backups disabled" as incompatible-network cause is wrong** âŒ â€” AWS documentation lists three specific causes for incompatible-network: (1) invalid/deleted subnets in DB subnet group, (2) no available IP addresses in subnets, (3) deleted or inaccessible ENIs. Backup retention period has no relation to network state.
> 7. **Qwen's `as_sitesearch` error is a new error type** â€” previously Qwen had zero SerpAPI parameter errors. The `as_sitesearch` parameter (equivalent to Google's `site:` operator) appears to have formatting conflicts similar to GLM's `lr` errors. This suggests SerpAPI's less-common parameters consistently trip up multiple models when generated via Auto Parameters.
> 8. **This test case is the strongest argument for Manual SerpAPI over Auto.** Auto Parameters generated searches for the alert's _narrative content_ ("incompatible network state VPC subnets"). Manual SerpAPI with `site:docs.aws.amazon.com RDS-EVENT-0056` would have fetched the canonical event table entry exposing the fabricated message. Config C's Auto Parameters have no mechanism to prioritize event-ID-first lookup over narrative content.

---

## ðŸ”´ Hard â€” Real CVE, Precise Scoring Required

_Pre-trained knowledge alone will get the CVSS score or affected version range wrong. Search is the only reliable source._

### 7. Real CVE â€” Apache Tomcat RCE (CVE-2025-24813)

**Goal:** Did the search return the correct CVSS score, affected versions, and exact patch version â€” or did the agent partially hallucinate?

```text
[SCANNER] Critical Vulnerability Detected
CVE: CVE-2025-24813
Package: Apache Tomcat 10.1.34
Score: Reported as High
Vector: Network, Partial PUT request
```

- **Expectation:** Agent corrects the severity: CVSS is **9.8 Critical** (not just "High"). Returns exact affected range and patch version (upgrade to 10.1.35, 9.0.99, or 11.0.3). Notes the two required conditions: default servlet write enabled AND partial PUT support enabled.
- **Manual vs Auto Delta:**
  - **Auto (Tavily):** May return a security blog summary â€” could get the score right.
  - **Manual (Tavily, `includeDomains: ["nvd.nist.gov", "cisa.gov"]`):** NVD returns the authoritative CVSS vector string and complete CWE.
  - **Manual (SerpAPI):** `site:nvd.nist.gov CVE-2025-24813`.

#### ðŸ”¬ Fact-Check (NVD-Verified)

> âœ… **CVE-2025-24813 â€” Apache Tomcat Remote Code Execution**
>
> | Field         | Alert Claimed | NVD Reality                                                                  |
> | ------------- | ------------- | ---------------------------------------------------------------------------- |
> | **CVSS**      | "High"        | **9.8 Critical**                                                             |
> | **Type**      | Network       | RCE via improper partial PUT request handling                                |
> | **Affected**  | 10.1.34       | 9.0.0.M1â€“9.0.98 / 10.1.0-M1â€“10.1.34 / 11.0.0-M1â€“11.0.2                       |
> | **Patch**     | â€”             | Upgrade to 9.0.99 / 10.1.35 / 11.0.3                                         |
> | **Condition** | â€”             | Default servlet write AND partial PUT enabled (partial PUT is ON by default) |

#### ðŸ“Š Analysis Results â€” Config A (Tavily, Auto Parameters)

**Did any model invoke search?**

- **All 7 models searched** âœ… â€” unanimous and correct. A CVE alert with an explicit CVSS score requires verification against NVD; searching is the only reliable way to get precise version ranges and exploit conditions.
- **No Tavily tool failures** â€” all 7 models completed searches on first try (0 failures). A stark contrast with Config C where GLM failed 4 consecutive attempts and Kimi produced empty output on first try.
- **âœ… HEADLINE FINDING â€” 7/7 passed the primary test goal: CVSS escalation from "High" to 9.8 Critical** â€” every model correctly identified the true severity. This makes Config A a clean-sweep on the core test question, matching Config C's working-model performance (5/6 passed there, limited by GLM's 4 failures preventing any output).
- **Compact, focused outputs across the board** â€” with Tavily returning precise CVE pages directly, models consumed dramatically fewer tokens than Config C (where GPT alone used 108k tokens). Gemini is the clear efficiency standout at 7,324 tokens / 1 search.

| Model                        | Tokens | Searched?  | Rating      | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ---------------------------- | ------ | ---------- | ----------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Claude Sonnet 4.5**        | 16906  | âœ… Yes (3) | ðŸŸ¢ **Best** | **Most complete output in Config A** â€” CVSS 9.8 âœ…, all 3 fix versions âœ…, CISA KEV April 1, 2025 âœ…, deadline April 22, 2025 âœ…. Metasploit module name `exploit/multi/http/tomcat_partial_put_deserialization` âœ… verified. EPSS score 94.18% noted (high but not independently verifiable without date). `grep 'JSESSIONID=\.' access_log*` â€” the only model to include exploited-session hunting for the specific JSESSIONID pattern used in the attack chain âœ…. `allowPartialPut=false` workaround âœ… correct parameter. Apache's own "Moderate" vs community "Critical" distinction âœ… â€” operationally important nuance for risk framing. Access log Valve config with `%{Content-Range}i` logging âœ… most advanced detection setup. OWASP and CIS Tomcat Benchmark cited. | 3 searches where 1-2 would suffice; highest token count of Config A group.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Claude Opus 4.5**          | 12889  | âœ… Yes (2) | ðŸŸ¢ **Best** | All 3 fix versions âœ…. CISA KEV with April 22 deadline âœ…. Metasploit module âœ…. `find $CATALINA_HOME -name "*.session" -mtime -30` â€” only model to hunt for staged session files on disk âœ… real forensic step. `grep -i "deseriali\|ObjectInputStream\|ClassNotFoundException"` â€” deserialization pattern in logs âœ… high-signal IoC. `JDBCStore` as recommended replacement for `FileStore` âœ… â€” most specific database-backed session alternative. Terraform `aws_cloudwatch_metric_alarm` example âœ… IaC approach. Ends with a bottom-line actionable summary. `sudo cp -r apache-tomcat-10.1.35/lib/* $CATALINA_HOME/lib/` replacement approach âœ… preserves config directories.                                                                                            | Workaround section says "Disable partial PUT by adding to web.xml: `<readonly>true</readonly>`" â€” but `readonly=true` disables default servlet writes, not partial PUT specifically. The correct parameter to disable partial PUT is `allowPartialPut=false`. Minor but technically imprecise in the workaround step.                                                                                                                                                                                                                                                                                                                                                  |
| **GLM-4.7**                  | 26525  | âœ… Yes (3) | ðŸŸ¡ **Good** | CVSS 9.8 âœ…. All 3 fix versions âœ…. All 4 exploit conditions correctly listed âœ…. Information disclosure and content injection attack variants (separate from RCE) correctly noted âœ… â€” per NVD advisory, there are two separate attack paths. `$CATALINA_HOME/bin/version.sh \| grep "Server number"` âœ…. NGINX `$http_content_range` header blocking âœ… â€” only model to block by header presence rather than HTTP method, more targeted mitigation. `wget` + `shutdown.sh` + `startup.sh` full upgrade process âœ…. SonicWall, XM Cyber, SOC Prime, CCCS cited â€” 4 independent intel sources. CVSS vector string implied (network, no auth) âœ….                                                                                                                                  | **`partialPUT` used as parameter name** âŒ â€” the correct parameter name is `allowPartialPut` (confirmed by Apache documentation, NVD, and all other models). `partialPUT` does not exist as a Tomcat init-param; using it in web.xml would silently have no effect, leaving the vulnerability open. Highest token count excluding GPT-level outliers â€” 3 searches for facts that Gemini retrieved in 1.                                                                                                                                                                                                                                                                |
| **Gemini Pro 3 Pro Preview** | 7324   | âœ… Yes (1) | ðŸŸ¢ **Best** | **Most token-efficient in this test case by far** â€” 7,324 tokens, 1 search. CVSS 9.8 âœ…. All 3 fix versions âœ…. "10.1.34 is explicitly named as the last vulnerable version in this branch" âœ… â€” precise boundary from Apache advisory. Best severity framing: "Critical (if readonly=false) / High (default config)" â€” communicates the conditional risk to engineers exactly right. `grep -rPl "readonly.*false"` Perl regex for config check âœ… â€” most targeted version check. `allowPartialPut` parameter explicitly named âœ…. Rapid7 and Akamai cited âœ…. File-based session persistence correctly described as non-default âœ….                                                                                                                                              | Most concise output (which is a strength here) means it skips some depth: no CISA KEV mention, no EPSS, no explicit Metasploit module reference. Suitable for rapid triage but not a complete intelligence briefing.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Kimi-K2.5**                | 21708  | âœ… Yes (4) | ðŸŸ¡ **Good** | CVSS 9.8 âœ…. All 3 fix versions âœ… (10.1.35, 9.0.99, 11.0.3). "30 hours exploitation" statistic âœ…. JEP 290 (Java Serialization Filters) for deserialization hardening âœ… â€” Apache-recommended approach. WAF rules for `.ser`, `.session` file extensions âœ…. `grep -i "Store"` context.xml FileStore check âœ…. XMCyber and CYFIRMA as exploitation confirmation sources âœ… real sources. `allowPartialPut=false` parameter âœ… correct. Apache mailing list advisory URL âœ… real.                                                                                                                                                                                                                                                                                                 | **T1059.007 cited as "JavaScript (Java deserialization)" MITRE technique** âŒ â€” T1059.007 does not refer to JavaScript or Java deserialization. T1059.007 is reserved for "Command and Scripting Interpreter: Network Device CLI." The correct Java deserialization technique is T1059.004 (Java). Additionally, T1610 ("Deploy Container") used for file upload is an imprecise mapping â€” T1505.003 (Web Shell) or T1027.009 (Embedded Payloads) would be more accurate for this attack pattern. 4 searches â€” most of any model in Config A.                                                                                                                          |
| **GPT-5.2**                  | 13614  | âœ… Yes (4) | ðŸŸ¡ **Good** | CVSS 9.8 âœ…. All 3 fix versions âœ…. Explicit `allowPartialPut=false` param âœ…. `ss -lntp \| egrep ':(8080\|8443\|80\|443)\b'` for exposure check âœ… practical. Both per-app `WEB-INF/web.xml` AND global `conf/web.xml` explicitly highlighted as needing review â€” operationally critical detail other models missed. `zgrep -h '"PUT '` across compressed log archives âœ…. Ends with a tailored diagnostic question (readonly=false, allowPartialPut, PersistentManager enabled?) â€” good personalization. Rapid7 + Akamai + SonicWall cited âœ….                                                                                                                                                                                                                                  | 4 searches, 13,614 tokens where Gemini did it in 1 search and 7,324 tokens. No CISA KEV mention despite it being the most authoritative urgency signal. The `Multi-AZ` reference in the closing question suggests copy-editing from a prior RDS response context â€” minor confusion artifact.                                                                                                                                                                                                                                                                                                                                                                           |
| **Qwen3.5 Plus**             | 14484  | âœ… Yes (3) | ðŸŸ¡ **Good** | CVSS 9.8 âœ…. CISA KEV with April 1/April 22 dates âœ…. 10.1.35 released "Feb 10, 2025" âœ… â€” only model to correctly cite the decoupled release-vs-disclosure date (Apache patched Feb 10, disclosed March 10). CWE-502 and CWE-706 cited âœ… â€” precise weakness classifications. eSentire threat intel on Chinese operators âœ…. `allowPartialPut=false` param âœ…. "Regular Patching" note: "this vulnerability was patched 11 months prior to the current date" âœ… â€” correct patch management observation.                                                                                                                                                                                                                                                                          | **"File-based session persistence is enabled (default configuration)"** âŒ â€” this is factually wrong. File-based session persistence is **non-default** in Apache Tomcat. The default is in-memory session management (`StandardSession`). All other 6 models, NVD, Rapid7, and the Apache advisory itself describe this as non-default. This error understates the prerequisites for RCE â€” making Qwen's output suggest more deployments are vulnerable than actually are. Additionally, Qwen says "10.1.36 is the latest stable" â€” while 10.1.36 exists, listing a specific "latest" version that may have already been superseded is misleading in a live document. |

> **Key Learnings:**
>
> 1. **7/7 models passed the primary test goal â€” clean sweep on CVSS escalation** âœ… â€” All models correctly identified 9.8 Critical (vs the alert's "High"). This matches Config C's pass rate among working models (5/6) but with no failures at all, making Config A's actual performance considerably better when considering GLM's 4 consecutive failures in Config C. For a well-indexed KEV-listed CVE like CVE-2025-24813, Tavily finds the NVD page reliably on the first search.
> 2. **Gemini set a new efficiency benchmark at 7,324 tokens / 1 search** âœ… â€” For a hard CVE test case, Gemini extracted all core facts (CVSS, fix versions, two-condition requirement, `allowPartialPut` parameter) in a single Tavily call. Compared to Config C where Gemini used 2 searches and 53k tokens (and still hallucinated "9.0.113"), this is a dramatic improvement â€” 7Ã— more efficient on tokens and no version hallucination.
> 3. **Qwen's "file-based session persistence is default" is the most dangerous error in this test case** âŒ â€” This claim directly misstates the exploit prerequisites. If an engineer reads Qwen's output and believes their standard Tomcat deployment uses file-based session persistence by default, they may (correctly) treat this as a high-urgency RCE risk when they may actually be unexposed. This error causes alarm inflation â€” the opposite of Qwen's TC6 error (which deflected attention from a real problem). In both cases the outcome is an engineer with wrong information.
> 4. **GLM's `partialPUT` parameter is a silent failure** âŒ â€” If an operations team adds `<param-name>partialPUT</param-name><param-value>false</param-value>` to their web.xml believing it disables partial PUT, nothing would happen â€” Tomcat would silently ignore the unknown parameter name. The actual parameter is `allowPartialPut`. This is more dangerous than a visible error. By contrast, all other 6 models used the correct `allowPartialPut` parameter name.
> 5. **Kimi's MITRE mapping errors don't affect the triage outcome but reveal LLM knowledge gaps** â€” T1059.007 is "Network Device CLI" not "JavaScript" or "Java deserialization." The correct technique for Java deserialization payloads is T1059.004. Kimi's MITRE section contains two mapping errors but its remediation and version information are completely correct â€” underscoring that MITRE ATT&CK mapping quality is a separate capability from CVE factual recall.
> 6. **Sonnet is the most complete Config A response â€” specifically the `JSESSIONID=\.` hunt pattern** âœ… â€” The two-phase attack ends with a GET request containing a `JSESSIONID` cookie that starts with a dot (the path-equivalence artifact). Hunting for this specific cookie pattern in access logs (`grep 'JSESSIONID=\.' access_log*`) is the most forensically targeted IoC search for post-exploitation evidence. Sonnet is the only model to include it in Config A (Opus had it in Config C).
> 7. **Qwen is the only model to cite the 10.1.35 release date (Feb 10, 2025) as separate from the CVE disclosure date (March 10, 2025)** âœ… â€” this is correct and operationally well-observed. Apache silently patched the issue in February and disclosed the CVE a month later. While most models don't note this gap, Qwen's observation that "this vulnerability was patched 11 months prior to the current date [Feb 2025]" â€” while framed from a future-perspective â€” reflects real Apache release timeline knowledge. This is a genuine insight buried inside an otherwise error-containing response.
> 8. **The Config A vs Config C efficiency comparison is stark** â€” Config C's GPT used 108k tokens (6 searches), GLM failed completely (producing zero useful output), and Kimi needed a full retry. Config A: zero failures, GPT used 13,614 tokens (4 searches), Gemini 7,324 tokens (1 search). For widely-documented CVEs, Tavily's on-demand retrieval of NVD/CISA pages eliminates the search-parameter-error cascade that plagued multiple models in Config C's SerpAPI run.

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **6/7 models searched (or attempted to)** âœ… â€” correct for a CVE lookup. The scanner-reported score and version both require NVD verification.
- **GLM: 4 consecutive failures** âŒ â€” first time GLM failed across all attempts in one test case, producing zero usable output. Each retry introduced new SerpAPI parameter errors (`lr` conflict, JSON format error, `US` location error, missing `q` parameter). This is GLM's worst performance across the entire test suite.
- **Kimi: Empty output on 1st attempt** â€” 3 searches, `{ "output": "" }`. 2nd try succeeded.
- **Core test goal: Correct CVSS escalation â€” 5/6 working models passed** âœ… â€” all correctly identified CVSS as 9.8 Critical (not "High" as the alert stated). This is the primary test check for "Hard" difficulty.

| Model                        | Tokens                 | Searched?           | Rating        | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ---------------------------- | ---------------------- | ------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Claude Opus 4.5**          | 37212                  | âœ… Yes (3)          | ðŸŸ¢ **Best**   | CVSS 9.8 âœ…. Fix versions: 9.0.99/10.1.35/11.0.3 âœ…. CISA KEV confirmed âœ…. "Exploited within 30 hours of disclosure" âœ… (real statistic from Huntress). GhostTroops/TOP PoC GitHub repo cited â€” real repo âœ…. FortiGuard Outbreak Alert + SentinelOne + Huntress â€” 3 independent intel sources. RASP deserialization protection suggestion â€” most advanced hardening layer. Two-stage attack chain (partial PUT â†’ session file overwrite â†’ deserialization RCE) correctly described. | Lowest token run of the Claude pair. No meaningful weaknesses.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Kimi-K2.5**                | 38765+45597 (2nd try)  | âœ… Yes (2, 2nd try) | ðŸŸ¢ **Best**   | CVSS critical âœ…. Fix versions 9.0.99/10.1.35/11.0.3 âœ…. CISA KEV April 1, 2025 âœ…. Most explicit about version range: "10.1.0-M1 through 10.1.34 âš ï¸" in affected versions table. Two-condition prereq (readonly=false AND partial PUT enabled) âœ…. Alternate data stream (::DATA) Windows exploitation path noted â€” technically accurate nuance âœ…. CISA citation URL âœ… real.                                                                                                       | 1st attempt produced empty output. Higher token count due to retry.                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Claude Sonnet 4.5**        | 63353                  | âœ… Yes (4)          | ðŸŸ¢ **Great**  | Most comprehensive output. CVSS 9.8 âœ…. All 3 fix versions âœ…. Exact two-condition requirement clearly explained âœ…. "PoC available on GitHub as of March 14, 2025" âœ…. Canadian Cyber Centre âœ… (real advisory). vicarius.io mitigation script cited âœ… (real). Official Apache mailing list thread URL (lists.apache.org) âœ… real. Urgency assessment at the end â€” best contextual completeness.                                                                                    | 4 searches for information covered in 2-3 by other models. Highest Claude token count.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Qwen3.5 Plus**             | 58957                  | âœ… Yes (4)          | ðŸŸ¡ **Good**   | CVSS 9.8 âœ…. CISA KEV confirmed âœ…. Trailing dot (`.`) path equivalence mechanism correctly described âœ…. NIST, CISA, Rapid7, Recorded Future, SonicWall, GitHub Advisory â€” 6 real source types âœ…. `grep "PUT" /var/log/tomcat/access_log                                                                                                                                                                                                                                            | grep -E "\.jsp\.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | \.do\."` â€” best access log hunt command. | **"8.5.99" cited as a fixed version** âŒ â€” CVE-2025-24813 does NOT affect Apache Tomcat 8.5.x; there is no 8.5.99 fix for this CVE. The fixed versions are 9.0.99/10.1.35/11.0.3 only. This is a version hallucination â€” Qwen likely pattern-matched the "9" â†’ "8.5" minor branch. |
| **Gemini Pro 3 Pro Preview** | 53172                  | âœ… Yes (2)          | ðŸŸ¡ **Good**   | Most efficient â€” 2 searches, 53,172 tokens for a CVE lookup. Two-condition requirement (readonly=false AND allowPartialPut) âœ…. `allowPartialPut=false` init-param workaround âœ… â€” most specific mitigation parameter. `grep -r "DefaultServlet"` config check âœ….                                                                                                                                                                                                                    | **"9.0.113" cited as the 9.x fix version** âŒ â€” the confirmed 9.x fix is **9.0.99** (NVD, Akamai, Rapid7 all confirm). 9.0.113 does not exist as a fix for this CVE. Also cited "SonicWall, Recorded Future" as active exploitation sources without citing the actual CISA KEV, which is more authoritative.                                                                                                                                                                                                       |
| **GPT-5.2**                  | 108432                 | âœ… Yes (6)          | ðŸŸ¡ **Good**   | Severity correctly escalated to Critical âœ…. Unit 42 (Palo Alto) cited âœ… real and authoritative. Best log hunting commands: `zgrep -hE '"PUT                                                                                                                                                                                                                                                                                                                                         | Content-Range:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | PROPFIND                                 | MKCOL'`â€” checks for partial PUT indicators including Content-Range header (the key indicator for this CVE's exploit pattern). NGINX`$request_method` block for method restriction âœ…. Canadian Cyber Centre âœ….                                                                    | **108,432 tokens â€” highest in this test case** by far. 6 searches for information others found in 2-3. Same core facts but 2-3x the cost. GPT's over-searching pattern is the most consistent behavior across the entire suite. |
| **GLM-4.7**                  | 62105+25076+2905+45687 | âŒ FAILED (4 tries) | ðŸ”´ **Failed** | â€”                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | **Complete generation failure â€” 4 consecutive SerpAPI errors, zero usable output.** Error sequence: (1) `lr` parameter unsupported value with `as_dt_` conflict, (2) JSON restrictor format error with malformed query, (3) `US` location unsupported, (4) missing `q` parameter. This is GLM's worst result â€” in previous test cases GLM failed 1-3 times then succeeded; here it never produced output. The errors escalated: GLM's retry logic made progressively more malformed calls rather than simplifying. |

> **Key Learnings:**
>
> 1. **5/6 working models passed the primary test goal: correctly escalating CVSS from "High" to Critical (9.8).** This is the best "Hard" CVE performance in the suite. A well-known, recently-exploited, heavily-documented CVE like CVE-2025-24813 is easy for search-equipped models to score accurately â€” it's on NVD, CISA KEV, and five major security blog posts simultaneously. The "Hard" label is merited by the precision requirement (exact CVSS string, exact versions) but the signal-to-noise is good because of KEV listing.
> 2. **Gemini hallucinated "9.0.113" as the 9.x fix version** âŒ â€” the correct fix is **9.0.99** (confirmed by NVD, Akamai, Rapid7, SonicWall). 9.0.113 does not exist at time of writing. This is a numeric interpolation error: Gemini may have mixed up the version from a different CVE or a different branch's release cadence. Gemini's 10.1.35 and 11.0.3 fix versions were correct â€” only the 9.x branch was wrong.
> 3. **Qwen hallucinated "8.5.99" as a fixed version** âŒ â€” CVE-2025-24813 does not affect Tomcat 8.5.x at all. The fix versions are strictly 9.0.99/10.1.35/11.0.3. Qwen correctly cited 10.1.35 and 9.0.99 but appended a non-existent 8.5.x patch. This is a pattern-match error against Tomcat's version tree structure.
> 4. **GLM's complete failure is a new failure mode.** In previous cases GLM eventually succeeded after 1-3 errors. Here, 4 passes each failed with a different error â€” the parameters degraded with each retry. This suggests GLM's sampling on SerpAPI parameter generation is unstable: when initial parameters fail, the follow-up parameters aren't simpler fallbacks, they are new (and equally malformed) attempts. A simple retry strategy with a blank parameter set would likely have succeeded on attempt 2.
> 5. **Opus is the most complete response** â€” CISA KEV, GhostTroops PoC repo, FortiGuard Outbreak Alert, SentinelOne, Huntress, "exploited within 30 hours" (real statistic) â€” all verified âœ…. At 37k tokens it's also the most efficient of the two Claudes. Comparing Opus to GPT (108k tokens for equivalent information): Opus is ~3x more token-efficient here.
> 6. **The two-condition requirement is the key nuance models must get right.** Exploitation requires BOTH: (1) `readonly=false` on DefaultServlet (non-default, must be explicitly set) AND (2) partial PUT enabled (default ON). All working models stated this correctly â€” most explicitly cited the non-default write configuration as the risk gate. This is the most security-operationally relevant fact for triage.
> 7. **GPT's `Content-Range` header log grep is the best forensic hunt command** â€” because partial PUT is specifically triggered by the `Content-Range` HTTP header, and GPT is the only model that included it in the access log grep pattern. This is the technical detail that distinguishes a thorough IoC hunt from a generic "look for PUT requests" approach.

### 8. Real CVE â€” Ingress-Nginx "IngressNightmare" (CVE-2025-1974)

**Goal:** Test whether the agent finds this high-profile Kubernetes vulnerability and maps it correctly.

```text
[SCANNER] Kubernetes Security Alert
CVE: CVE-2025-1974
Component: ingress-nginx controller
Cluster: prod-k8s-01
Details: Unauthenticated access path detected in admission controller webhook
```

- **Expectation:** Agent identifies this as part of "IngressNightmare" (March 2025 batch of **5 CVEs**). CVSS **9.8 Critical**. Unauthenticated RCE via NGINX configuration code injection through the admission controller webhook â€” can lead to full cluster takeover. Patch: upgrade ingress-nginx to v1.12.1 or v1.11.5.
- **Manual vs Auto Delta:**
  - **Auto (Tavily):** Should find this â€” widely reported by Wiz.io and Kubernetes.io blog.
  - **Manual (Tavily, `timeRange: month`, `topic: news`):** Ensures recency and surfaces the official Kubernetes advisory.
  - **Manual (SerpAPI):** `site:kubernetes.io CVE-2025-1974 ingress-nginx`.

#### ðŸ”¬ Fact-Check (Kubernetes.io + Wiz.io Verified)

> âœ… **CVE-2025-1974 â€” IngressNightmare, Kubernetes Ingress-Nginx**
>
> | Field         | Value                                                                                                                               |
> | ------------- | ----------------------------------------------------------------------------------------------------------------------------------- |
> | **CVSS**      | 9.8 Critical                                                                                                                        |
> | **Type**      | Unauthenticated RCE via NGINX configuration injection                                                                               |
> | **Affected**  | All ingress-nginx versions prior to v1.12.1 and v1.11.5                                                                             |
> | **Patch**     | Upgrade to ingress-nginx **v1.12.1** or **v1.11.5**                                                                                 |
> | **Risk**      | Full Kubernetes cluster takeover, access to all secrets in all namespaces                                                           |
> | **Disclosed** | **March 24, 2025** (Kimi cited March 23 âŒ)                                                                                         |
> | **CVE count** | **5 CVEs** total â€” test spec listed 4; confirmed 5: CVE-2025-1974 + CVE-2025-24514 + CVE-2025-24513 + CVE-2025-1097 + CVE-2025-1098 |

#### ðŸ“Š Analysis Results â€” Config A (Tavily, Auto Parameters)

**Did any model invoke search?**

- **All 7 models searched** âœ… â€” unanimous and correct. A Kubernetes CVE alert requires real-time version lookup and exploit verification that no model can answer from training data alone, especially for a March 2025 disclosure.
- **No Tavily tool failures** â€” all 7 completed searches on first attempt. Compare to Config C where GLM needed 2 attempts (missing `q` parameter error on 1st). Tavily's structured endpoint eliminates the SerpAPI parameter-format failure mode entirely.
- **âœ… HEADLINE FINDING â€” 7/7 passed the primary test goal: correct CVSS 9.8 with patch versions v1.11.5 and v1.12.1** â€” a clean sweep, matching Config C's working-model performance. IngressNightmare's "IngressNightmare" brand naming and Wiz's extensive press coverage made it trivially findable across both search backends.
- **Notably tighter token distribution** â€” Config A range is 12,669â€“36,994 tokens (Opus to Gemini). Compare Config C range: 2,856â€“123,814 tokens (GLM 1st fail to GLM 2nd try). Config C's GLM needed 2 attempts burning 126k tokens total. All 7 Config A models completed cleanly in a single pass.

| Model                        | Tokens | Searched?  | Rating      | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ---------------------------- | ------ | ---------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Claude Opus 4.5**          | 12669  | âœ… Yes (2) | ðŸŸ¢ **Best** | **Most technically precise exploit mechanism** â€” named NGINX client body buffering for shared library upload, then `ssl_engine`/`load_module` directive injection, then `/proc/<pid>/fd/` FD reference for RCE âœ… confirmed via Wiz Research original disclosure. This is the complete 3-step chain no other Config A model fully described. `kubectl patch svc ingress-nginx-controller-admission -n ingress-nginx -p '{"spec":{"type":"ClusterIP"}}'` â€” only model to patch the service type directly as emergency containment âœ… most actionable if the webhook is accidentally exposed as LoadBalancer. Most efficient: 2 searches, 12,669 tokens. Falco detection rule (yaml) included âœ… real field references. Named PoC authors (hakaioffsec, yoshino-s, Esonhugh) âœ… real. Wiz ~43% / 6,500 clusters âœ… confirmed.                                                                                                                                                                                            | Most concise of the group â€” MITRE mapping uses T1611 (Escape to Host) which is plausible but less precise than T1609 (Container Administration Command). T1068 (Exploitation for Privilege Escalation) is the better primary mapping here than T1611.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Claude Sonnet 4.5**        | 16680  | âœ… Yes (3) | ðŸŸ¢ **Best** | All 5 related CVEs named âœ… (CVE-2025-1974, CVE-2025-1097, CVE-2025-1098, CVE-2025-24514). Nuclei template reference for scanner verification âœ… (`https://github.com/projectdiscovery/nuclei-templates`). Raw manifest upgrade path âœ… (`kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.12.1/...`). Most complete forensic hunt: `find /etc/nginx /tmp -type f -mtime -7`, netstat, ps aux, audit log jq query for ingress admission events all in one response. `T1552.007` (Unsecured Credentials: Container API) âœ… â€” most accurate Kubernetes Secrets-specific MITRE technique. Wiz 43%/6500 âœ…. Correct disclosure date March 24, 2025 âœ….                                                                                                                                                                                                                                                                                                                            | Helm upgrade command has `\  # Corresponds to controller v1.12.1` inline comment with a trailing backslash â€” the backslash before a comment breaks the shell command (the `\` would be interpreted as a line continuation, making the `#` comment part of the `--version` argument). Minor but would cause a copy-paste failure in a real terminal. 3 searches where 2 suffice.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **GLM-4.7**                  | 22428  | âœ… Yes (3) | ðŸŸ¡ **Good** | CVSS 9.8 âœ…. Patch versions v1.11.5 and v1.12.1 âœ…. Correct `Affected: < v1.11.5 and all v1.11.x before v1.11.5; Fixed in: v1.11.5 and v1.12.1+` âœ…. NGINX `auth-url` annotation injection mechanism named âœ…. Wiz 6,500 clusters âœ…. Shadowserver exposure monitoring âœ… real. Apphaz `.so` file upload via ssl_engine âœ…. NetworkPolicy YAML (port 8443 restricted to kube-system namespace) âœ… functionally correct.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | **T1528 used for BOTH Privilege Escalation AND Credential Access** âŒ â€” T1528 is "Steal Application Access Token" which belongs under Credential Access, not Privilege Escalation. The correct Privilege Escalation technique for CVE-2025-1974 is T1068 (Exploitation for Privilege Escalation) or T1609 (Container Administration Command). Using the same technique ID under two different ATT&CK tactics without justification is a MITRE taxonomy error. **T1486 (Data Encrypted for Impact â€” Ransomware) listed under Impact** âŒ â€” this is speculative. CVE-2025-1974 is an RCE/credential theft vulnerability; ransomware deployment as "potential impact" is not documented in the CVE advisory. While theoretically possible, mapping T1486 to this CVE conflates exploit capability with attacker intent. No other 5 models included ransomware mapping. |
| **Gemini Pro 3 Pro Preview** | 36994  | âœ… Yes (4) | ðŸŸ¡ **Good** | CVSS 9.8 âœ…. Correct "unauthenticated access, no privileges required" âœ…. Port 8443 named âœ…. Correct EOL warning: "ingress-nginx has been announced for retirement/archive by March 2026 by the Kubernetes Steering Committee" âœ… â€” confirmed. This is operationally the most forward-looking observation in Config A: after March 2026 there will be no further security patches, making CVE-2025-1974 a compelling prompt to migrate rather than just patch. Network Policy containment as first step âœ…. `T1611 (Escape to Host)` for container escape âœ… â€” more applicable than GLM's T1528 for Privilege Escalation.                                                                                                                                                                                                                                                                                                                                                                                             | **"Vulnerable if < v1.12.0"** âŒ â€” this is wrong. v1.11.5 is a fixed version for the v1.11.x train. Gemini's statement implies v1.11.5 is vulnerable (since it is `< v1.12.0`), which directly contradicts the official Kubernetes advisory. **Helm upgrade to `--version 4.14.1` / controller `v1.14.x`** âŒ â€” these version numbers do not exist in the ingress-nginx releases as of the CVE advisory. The official fixed chart versions are `4.11.5` (for controller v1.11.5) and `4.12.1` (for controller v1.12.1). Gemini's recommended chart version is fabricated. Most tokens at 36,994 (4 searches) â€” compare to Opus's complete expert output at 12,669 (2 searches).                                                                                                                                                                                     |
| **Qwen3.5 Plus**             | 13653  | âœ… Yes (3) | ðŸŸ¢ **Best** | CVSS 9.8 âœ…. Patch versions v1.11.5 and v1.12.1 âœ…. **Most accurate exploit mechanism description in Config A** â€” "inject arbitrary NGINX configuration directives (e.g., load_module) into the temporary config file generated during validation. When the controller runs `nginx -t` to test the config, it loads attacker-controlled shared libraries (.so files)" âœ… this is the exact mechanism from Project Discovery's technical analysis. CWE-20 (Improper Input Validation) âœ… correct. `T1552.004` (Unsecured Credentials in Files) âœ… â€” reasonable for Kubernetes Secret file access. Log forensics: "audit Ingress resources created/modified in the last 48 hours for suspicious annotations (auth-url, ssl-engine, load-module)" âœ… correct attack IoCs. eSentire/ARMO/Fidelis/Wiz cited âœ… all real. Post-patch Helm re-enable of webhook with `controller.admissionWebhooks.enabled=true` âœ… â€” only model to explicitly note to re-enable after patching. Token-efficient: 13,653 tokens (3 searches). | No mention of the ingress-nginx March 2026 EOL â€” which Gemini flagged and which is operationally significant. Qwen's version condition `(version >= 1.12.0 AND < 1.12.1)` âœ… correct but the parenthetical in the kubectl check comment is harder to parse than Sonnet's prose form.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **GPT-5.2**                  | 20193  | âœ… Yes (5) | ðŸŸ¡ **Good** | CVSS 9.8 âœ…. Patch versions âœ…. Sourced from official Kubernetes blog (`kubernetes.io/blog/2025/03/24/`) âœ… most authoritative citation in Config A. `kubectl -n ingress-nginx get deploy,ds -o jsonpath=...` multi-controller image discovery âœ… â€” handles both Deployment and DaemonSet installations. `egrep -i 'admission\|webhook\|error\|panic\|nginx.*reload\|lua\|ssl_engine'` â€” most complete regex for log triage across multiple indicator types âœ…. `kubectl get events -A --sort-by=.lastTimestamp \| tail -200` âœ… most useful event triage command. Ends with a personalization question ("share the current ingress-nginx controller image tag") âœ… â€” good triage discipline.                                                                                                                                                                                                                                                                                                                          | 5 searches, 20,193 tokens vs Opus's 2 searches, 12,669 tokens for similar quality output. No explicit mention of the March 2026 EOL or the `/proc/<pid>/fd/` FD reference chain. Missing all 5 related CVE IDs (names only CVE-2025-1974 specifically).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

> **Key Learnings:**
>
> 1. **7/7 clean sweep on the primary test goal â€” CVSS 9.8 and correct patch versions identified by all models** âœ… â€” IngressNightmare's widespread media coverage (Wiz blog, Kubernetes.io, Datadog) means both Tavily and SerpAPI surface strong signal immediately. This is the second consecutive CVE test (TC7, TC8) where Config A achieves a complete sweep.
> 2. **Gemini's "Vulnerable if < v1.12.0" is the most operationally dangerous error in this test case** âŒ â€” if an engineer reads Gemini's output and runs `helm upgrade ... --version 4.14.1` (the fabricated chart version), the upgrade command will fail entirely (chart not found). Worse, Gemini's version boundary says v1.11.5 is vulnerable â€” if an engineer believes this and skips upgrading because they're already on v1.11.5, they have a false sense of security. Both errors compound to potentially leave a Critical CVE unpatched.
> 3. **Opus at 12,669 tokens (2 searches) delivers the most technically complete output in Config A** âœ… â€” the exact 3-step exploit chain (body buffering â†’ ssl_engine injection â†’ /proc/fd/ execution), the service-type patch for emergency containment, named PoC authors, and a working Falco rule. Gemini's 36,994 tokens (4 searches) produced an output with two version errors. Token count â‰  quality for this test case.
> 4. **GLM's double-T1528 MITRE error is a pattern, not a one-off** âŒ â€” GLM has now shown MITRE mapping weaknesses in TC7 (`partialPUT` wrong parameter), TC8 (T1528 misclassified, T1486 speculative). GLM's factual CVE data (versions, mechanisms, sources) is consistently correct, but its ATT&CK taxonomy entries contain errors that could mislead a SOC analyst building detection rules or threat hunt pivots.
> 5. **Gemini's ingress-nginx March 2026 EOL warning is the highest-value long-term insight in Config A** âœ… â€” confirmed by Kubernetes SIG Network announcement. After March 2026, CVE-2025-1974 will be the last major security incident with an official patch. Future vulnerabilities in ingress-nginx will remain unpatched. Gemini surfaced this on its own while getting the version numbers wrong â€” a curious disconnect between strategic accuracy and tactical inaccuracy.
> 6. **Kimi caught the CVE number discrepancy in BOTH Config A and Config C** âœ… â€” the alert shows "CVE-2025-1978" but the vulnerability is CVE-2025-1974. Kimi explicitly flagged this as "likely a transposition error in the scanner output" in both runs. No other model in either config noticed this. This is a subtle but high-value triage skill: recognising when the alert itself contains an error, not just triaging the CVE. Kimi's consistency across both backends on this detail suggests it's a deliberate cross-referencing behaviour, not a lucky guess.
> 7. **Sonnet's Helm shell comment syntax bug is a teachable copy-paste risk** â€” `--version 4.12.1 \  # Corresponds to controller v1.12.1` â€” the trailing backslash before the inline comment causes shell parsing issues. In bash, `\` at end of line means line continuation, making `# Corresponds...` part of the next command rather than being ignored. Running this exact snippet in a terminal would fail. All other models with Helm commands used correct syntax.
> 8. **Config A vs Config C efficiency** â€” Config C GLM burned ~126k tokens across 2 attempts (one failed, one working). Config A GLM completed cleanly at 22,428 tokens. Config C GPT: 107,556 tokens (6 searches). Config A GPT: 20,193 tokens (5 searches). Tavily's structured endpoint reduces both failure rates and token overhead for the same quality output. The pattern holds across both CVE test cases (TC7 and TC8).

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **6/7 models searched** âœ… â€” correct for a Kubernetes CVE requiring version-specific remediation.
- **GLM failed 1st attempt** â€” `Missing query 'q' parameter` error. 2nd try succeeded. Best single-case GLM performance since TC5 â€” only 1 failure.
- **All 6 working models identified IngressNightmare and patch versions (v1.11.5/v1.12.1)** âœ… â€” highest aggregate CVE identification rate in the suite.

| Model                        | Tokens                | Searched?           | Rating       | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Weaknesses                                                                                                                                                                                                                                                                       |
| ---------------------------- | --------------------- | ------------------- | ------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Claude Opus 4.5**          | 49690                 | âœ… Yes (3)          | ðŸŸ¢ **Best**  | **Deepest technical mechanism** â€” named `ssl_engine` NGINX directive injection as RCE vector âœ… (real â€” from Wiz Research original disclosure). "Loading malicious shared libraries via AdmissionReview payload" âœ…. Esonhugh PoC GitHub repo âœ… real. Wiz Research "~40% of clusters" âœ… accurate. GHSA-mgvx-rpfc-9mpv advisory âœ…. `grep -i "ssl_engine\|load_module"` nginx.conf IoC check â€” only model to include this critical post-compromise indicator. | None.                                                                                                                                                                                                                                                                            |
| **Claude Sonnet 4.5**        | 59424                 | âœ… Yes (4)          | ðŸŸ¢ **Best**  | All 5 co-disclosed CVEs named âœ…. Helm chart version mapping (4.11.5 â†’ controller v1.11.5, 4.12.1 â†’ v1.12.1) âœ…. AWS-2025-006 security bulletin âœ… real. hakaioffsec/IngressNightmare-PoC âœ… real. `--field-selector involvedObject.kind=Ingress --since=168h` â€” most complete IoC audit log query.                                                                                                                                                            | 4 searches (slightly over). dttuss/IngressNightmare-RCE-POC cited â€” not independently confirmed âš ï¸.                                                                                                                                                                              |
| **Qwen3.5 Plus**             | 45341                 | âœ… Yes (2)          | ðŸŸ¢ **Great** | **Most token-efficient** â€” 2 searches, 45k tokens, complete output. `ipBlock: cidr: <API_SERVER_CIDR>/32` NetworkPolicy âœ… â€” most precise webhook restriction pattern. Horizon3.ai, Kudelski, ProjectDiscovery, ACSC âœ… all real. `kube-bench` âœ… real.                                                                                                                                                                                                        | `k8s.gcr.io/ingress-nginx/controller` âš ï¸ â€” deprecated since 2023; correct registry is `registry.k8s.io/ingress-nginx/controller`. Copy-paste risk for production commands.                                                                                                       |
| **Kimi-K2.5**                | 35394                 | âœ… Yes (3)          | ðŸŸ¢ **Great** | **Lowest token count.** All 5 CVEs named âœ…. 10 sources â€” most diverse coverage. nomi-sec/PoC-in-GitHub âœ… real. T1552.001 (Credentials In Environment Variables) âœ… â€” correct and unique for ingress-nginx's TLS secret access.                                                                                                                                                                                                                               | **"March 23, 2025"** âŒ â€” confirmed March 24 (kubernetes.io URL contains `/2025/03/24/`). Off-by-one date error.                                                                                                                                                                 |
| **GLM-4.7**                  | 2856+123814 (2nd try) | âœ… Yes (4, 2nd try) | ðŸŸ¡ **Good**  | IngressNightmare âœ…, fix versions âœ…. **Ingress-NGINX March 2026 retirement** âœ… â€” only model to connect CVE triage to EOL. GKE Security Bulletin âœ…. Huawei Cloud advisory âœ… rare source, real. aquasecurity/trivy discussion #8709 âœ… real.                                                                                                                                                                                                                 | "~50% of cloud-native environments" âš ï¸ â€” Wiz Research cites ~40%; 50% is slightly inflated. 123k tokens on 2nd try â€” highest single-run token count in TC8.                                                                                                                      |
| **Gemini Pro 3 Pro Preview** | 90139                 | âœ… Yes (3)          | ðŸŸ¡ **Good**  | IngressNightmare âœ…, patch versions âœ…. Port 8443 named âœ…. `securityContext.readOnlyRootFilesystem: true` âœ… correct hardening. "Monitoring ingress logs alone may miss this" â€” best operational insight across all responses.                                                                                                                                                                                                                                | **T1203 (Exploitation for Client Execution)** âŒ â€” T1203 is for client-side (browsers, document viewers). CVE-2025-1974 is server-side; correct: T1190 + T1609. Second MITRE categorization error in two CVE test cases. 90k tokens for a concise output â€” high processing cost. |
| **GPT-5.2**                  | 107556                | âœ… Yes (6)          | ðŸŸ¡ **Good**  | IngressNightmare âœ…, fix versions âœ…. `kubectl get ingress -A --sort-by=.metadata.creationTimestamp` â€” best lateral movement hunt command. `kubectl get endpoints ingress-nginx-controller-admission -o wide` â€” only model to inspect endpoints (not just service). East-west network telemetry recommendation âœ….                                                                                                                                             | **6 searches, 107,556 tokens â€” identical to TC7.** See Key Learning #6 below.                                                                                                                                                                                                    |

> **Key Learnings:**
>
> 1. **All 6 working models passed the primary test goal** â€” complete IngressNightmare identification with correct patch versions. High press coverage and the Wiz "IngressNightmare" brand made SerpAPI retrieve strong signal immediately. Best aggregate CVE performance in the suite.
> 2. **Test spec correction: IngressNightmare is 5 CVEs, not 4.** CVE-2025-1974, CVE-2025-24513, CVE-2025-24514, CVE-2025-1097, CVE-2025-1098 â€” confirmed via kubernetes.io and Australian Cyber Security Centre. Kimi and Sonnet correctly cited all 5.
> 3. **Kimi's "March 23" disclosure date is wrong** âŒ â€” confirmed March 24 from official Kubernetes blog URL. Off-by-one timestamp errors are a consistent but low-impact model behavior across CVE lookups in this suite.
> 4. **Gemini's T1203 MITRE mapping is wrong** âŒ â€” T1203 (Exploitation for Client Execution) applies to client-side software. CVE-2025-1974 is server-side. Correct: T1190 (Exploit Public-Facing Application), T1609 (Container Administration Command). This is Gemini's second MITRE categorization error in two consecutive CVE test cases â€” a pattern.
> 5. **Opus's `ssl_engine` IoC check is uniquely valuable** âœ… â€” the actual RCE mechanism injects `ssl_engine` NGINX directives to load malicious shared objects. Grep for `ssl_engine` or `load_module` in nginx.conf is the only reliable in-memory indicator of prior exploitation. No other model included this â€” making Opus's output the only one enabling a forensic analyst to detect if exploitation had already occurred.
> 6. **GPT's 6-search pattern is now confirmed as systematic across CVE test cases.** TC7: 6 searches, 108k tokens. TC8: 6 searches, 107k tokens. Qwen achieved equivalent or better output in 2 searches (TC8: 45k tokens). GPT has no convergence heuristic in this agentic loop â€” it fires searches until context is saturated rather than until the answer is sufficient. This is a **loop architecture problem**, not a GPT intelligence problem. The prompt/system design doesn't signal when enough information has been gathered. Cost impact: ~60â€“80k wasted tokens per CVE query vs Qwen.
> 7. **GLM's March 2026 retirement observation is the highest-value long-term insight.** No other model connected the CVE triage to the March 2026 EOL announcement â€” yet migrating to Gateway API before ingress-nginx becomes permanently unpatched is operationally more important than the immediate patch. GLM surfaced this from broader search context, demonstrating that less targeted auto-queries occasionally yield more complete operational guidance.
> 8. **The `k8s.gcr.io` vs `registry.k8s.io` discrepancy in Qwen's commands** âš ï¸ â€” since November 2022 all Kubernetes images moved to `registry.k8s.io`. The old address may still redirect but is deprecated in production. Any copy-paste of Qwen's `kubectl set image` command with `k8s.gcr.io` would need fixing.

---

## ðŸŸ£ Edge Cases & Stress Tests

_Vague, adversarial, restrained inputs â€” test judgment about WHEN to invoke the search tool._

### 9. Panic / "Mayday"

**Goal:** Test restraint â€” zero tool calls expected.

```text
[ALERT] MAYDAY MAYDAY MAYDAY server is on fire literally smoke coming out help
```

- **Expectation:** Physical safety guidance; power cut recommendation; escalate to facilities. No search calls. If the agent fires Tavily for "server fire mitigation" â€” that is a failure regardless of parameters.

### 10. "We Are Hacked" â€” Ransomware (.crypt)

**Goal:** Targeted search for a real decryptor on a known authoritative source.

```text
[Check] I think we are hacked. Screens are flashing red and files are renamed to .crypt
```

- **Expectation:** Ransomware classification (CryptXXX family). Network isolation first. Search should surface **nomoreransom.org** â€” Rannoh Decryptor (Kaspersky) is available there for CryptXXX v1/v2/v3.
- **Manual vs Auto Delta:**
  - **Auto (Tavily):** Returns general ransomware advice â€” may or may not hit nomoreransom.org.
  - **Manual (Tavily, system prompt hint: check nomoreransom.org):** Directly surfaces the Rannoh Decryptor page.
  - **Manual (SerpAPI):** `site:nomoreransom.org .crypt CryptXXX`.

#### ðŸ”¬ Fact-Check (nomoreransom.org Verified)

> âœ… **Valid ransomware scenario with a real decryptor.**
>
> - CryptXXX v1/v2/v3 â†’ Rannoh Decryptor (Kaspersky), freely available on nomoreransom.org
> - Trend Micro and Emsisoft also provide CryptXXX decryptors
> - **Caveat:** CryptXXX v3.100+ (network share variant) may not be fully decryptable â€” check latest tool version on nomoreransom.org

#### ðŸ“Š Analysis Results â€” Config A (Tavily, Auto Parameters)

**Did any model invoke search?**

- **6/7 searched.** Kimi needed 3 attempts (2 failed with empty output `{}`), completing only on the 3rd try. All others completed on first attempt. Kimi's total token spend across all 3 tries: ~47,538 (8,421 + 29,954 + 9,163).
- **The test goal** â€” surfacing a specific decryptor (e.g., nomoreransom.org Rannoh Decryptor for CryptXXX) â€” was **missed by all models**, exactly as in Config C. Tavily's auto parameters surface general ransomware IR guides (CISA, BleepingComputer) rather than directly hitting the decryptor lookup page. Manual parameters with a targeted query (`site:nomoreransom.org .crypt CryptXXX`) remain the only reliable path to the specific result.
- **Most notable Config A vs C delta:** Gemini did NOT hallucinate the RedAlert/N13V false attribution in Config A â€” it correctly named CryptXXX, CryptON, and Jigsaw as plausible `.crypt` families. This is a significant improvement over its catastrophic Config C performance on this test case.

| Model                        | Tokens          | Searched?        | Rating      | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ---------------------------- | --------------- | ---------------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **GPT-5.2**                  | 22304           | âœ… Yes (4)       | ðŸŸ¢ **Best** | **Most epistemically responsible output.** Explicitly stated `.crypt` is generic and cannot reliably identify a specific family without ransom note + sample â€” correct posture âœ…. Anchored entirely on authoritative CISA/MS-ISAC sources (all 5 URLs verified real âœ…). CISA guidance: switch-level isolation, out-of-band comms, not tipping off actors âœ… â€” highest-quality operational guidance in Config A. `Get-Content PowerShell PSReadLine history` to detect `vssadmin`/`wbadmin` usage âœ… â€” only model to use PS history as a forensic artefact. PowerShell `Get-ChildItem` for `.crypt` file listing âœ…. Linux `lsof +L1` deleted-file-handle detection âœ… unique. 4 follow-up questions to narrow diagnosis âœ…. 4 searches / 22,304 tokens â€” most efficient for quality of output.                                         | Did not name any specific decryptor or nomoreransom.org entry. Appropriate epistemic restraint but leaves the responder without an immediate decryptor tip. No mention of specific ransomware families at all â€” the operational restraint is correct but some responders want a short list of likely families to investigate.                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Claude Sonnet 4.5**        | 14844           | âœ… Yes (3)       | ðŸŸ¢ **Best** | Most operationally complete output in Config A. `netsh interface set interface "Ethernet" admin=disable` for Windows isolation âœ… â€” most specific network disable command. `3-2-1-1-0` backup rule âœ… (3 copies, 2 media, 1 offsite, 1 immutable, 0 errors verified) â€” most precise hardening rule. `Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol` âœ… real. `Get-ScheduledTask` for persistence check âœ…. `T1491.001` (Defacement: Internal Defacement) âœ… â€” most precise MITRE sub-technique for the red screen. `T1021.002` (SMB/Windows Admin Shares) âœ… â€” correct for lateral movement attribution. 72-hour payment deadline observation âœ… â€” real 2025 RaaS trend. Staged hardening roadmap (immediate / 30-90 days / long-term) is the most structured post-incident plan. FBI IC3 + CISA escalation included. | `wmic shadowcopy call create Volume='C:\'` command is incorrect â€” this CREATES a shadow copy, not restores from one. The correct restore command involves `vssadmin` or `diskshadow`. If copy-pasted literally, this command creates a new snapshot of the already-encrypted volume, not a recovery. `M1041 - Encrypt Sensitive Data` as ransomware mitigation is weak â€” data-at-rest encryption doesn't stop ransomware from encrypting it again.                                                                                                                                                                                                                                                                                     |
| **Claude Opus 4.5**          | 15849           | âœ… Yes (3)       | ðŸŸ¢ **Best** | **ARCrypter/ChileLocker correctly identified** âœ… â€” real threat actor (first attack August 2022 on Chilean government), confirmed uses `.crypt` extension, drops ransom note BEFORE encryption begins âœ… (distinctive forensic sign). `winpmem_mini_x64.exe memory.raw` for RAM capture âœ… â€” real tool, encryption keys may still be in memory. Cisco router `interface shutdown` and `iptables -I FORWARD` network isolation âœ… â€” only model to cover both network device and host-level isolation together. Decision Tree (backups â†’ FBI/CISA vs. accept loss) âœ… â€” most actionable triage framework. `Get-EventLog -LogName Security -InstanceId 4624,4625` for login audit âœ…. FBI IC3 + state field office links âœ…. `NoMoreRansom.org` Crypto Sheriff correctly referenced âœ…. `dd if=/dev/mem` Linux RAM capture âœ….              | **T1486.001 hallucinated** âŒ â€” T1486 (Data Encrypted for Impact) has **no sub-techniques** in ATT&CK v16. The sub-technique ID T1486.001 does not exist. This is a fabricated ATT&CK entry that a SOC analyst could waste time looking up. T1059 (Command and Scripting Interpreter) as a co-listed technique is legitimate but non-specific â€” T1059 appears in nearly every intrusion, diluting the useful MITRE signal for ransomware specifically.                                                                                                                                                                                                                                                                                 |
| **Kimi-K2.5**                | 47538 (3 tries) | âœ… Yes (3rd try) | ðŸŸ¡ **Good** | **Widest range of accurate `.crypt` family attributions** â€” GomasoM âœ… (Emsisoft decryptor real), HelloKitty (`.CRYPT`/`.CRYPTED`) âœ… (re-emerged 2024, confirmed), Salted2020 âœ… (uses `.crypt`, real), DCRTR-WDM âœ… (real). **ClickFix 517% surge** âœ… â€” real stat from ESET/Mimecast H1 2025 report, most current threat intelligence cited in Config A. GomasoM decryptor URL (`bleepingcomputer.com/download/decryptcryptgomasom/`) âœ… verified real link. `find /` + `grep -l "encrypt\|ransom"` ransom note detection âœ…. `find / -type d -name "*Your-identification-ID*"` Salted2020 folder pattern âœ… specific. Multiple real sources (Cyberpress HelloKitty, BleepingComputer GomasoM, Canadian Cyber Centre) all verified âœ….                                                                                                | **Needed 3 attempts** â€” 2 empty output failures before 3rd succeeded. Total burn: 47,538 tokens for one response (vs Sonnet's 14,844 for equivalent quality). Despite 3 searches on the 3rd attempt, did not surface the nomoreransom.org CryptXXX decryptor. No direct CISA guidance cited. T1490 (Inhibit System Recovery) correct but no T1491 for the red-screen defacement aspect.                                                                                                                                                                                                                                                                                                                                                |
| **GLM-4.7**                  | 13502           | âœ… Yes (3)       | ðŸŸ¡ **Good** | DynA-Crypt (Dynamite Malware Creation Kit) âœ… â€” real. Dharma family Crypt pattern `originalfilename.id-[uniqueID].[email].Crypt` âœ… â€” accurate and distinguishing file naming pattern. PCRisk citations for both DynA-Crypt and Dharma-Crypt â€” verified real removal guides âœ…. `dir /s /b C:\*ENCRYPTED*.txt` ransom note search âœ… correct. `tree C:\ /F /A > encrypted_files_report.txt` for scope documentation âœ…. `tasklist > running_processes.txt` âœ…. Safe Mode + anti-malware removal sequence âœ… operational. `No More Ransom` correctly referenced âœ….                                                                                                                                                                                                                                                                       | **M1053 named "Remote Session Termination" âŒ** â€” M1053 in ATT&CK is **"Data Backup"**, not Remote Session Termination. GLM used the correct ID but assigned a completely wrong name. A SOC analyst using this to build a mitigation baseline would document the wrong control. **T1491 described as "Desktop Wallpaper Change"** â€” T1491 is "Defacement" in ATT&CK; T1491.001 is the sub-technique covering desktop wallpaper and internal screen manipulation. GLM's naming is inaccurate though the concept is directionally correct. `M1028 - OS Configuration` and `M1050 - Exploit Protection` have weak justification for ransomware response context â€” more applicable to initial access prevention than active ransomware IR. |
| **Gemini Pro 3 Pro Preview** | 28998           | âœ… Yes (4)       | ðŸŸ¡ **Good** | **Significant improvement vs. Config C** â€” did NOT hallucinate RedAlert/N13V in Config A (that was the most dangerous error in Config C). CryptXXX â†’ RannohDecryptor (Kaspersky) âœ… â€” correct decryptor, only model in Config A to name a specific decryptor. Jigsaw deletion-timer warning âœ… â€” Jigsaw does delete files on a countdown, rebooting can trigger it. `drrw.exe` as Jigsaw process indicator âœ… â€” documented in Jigsaw removal guides. `id-ransomware.malwarehunterteam.com` correctly referenced âœ…. CryptON decryptable via Rannoh âœ… correct. T1491 (Defacement) for red screen âœ… correct mapping.                                                                                                                                                                                                                     | **SensorTechForum source** âŒ â€” the cited URL (`sensorstechforum.com/holiday-forever-cc-virus-ads/`) is a cookie/adware removal guide, not a `.crypt` ransomware analysis page. This is a phantom source â€” the URL resolves but its content is irrelevant to the analysis. Gemini cited it as "Remove Masterlock / .Crypt Files (Variant analysis)" â€” that description doesn't match the page. 4 searches / 28,998 tokens â€” most expensive in Config A, and the Jigsaw/CryptXXX intel was readily available in 2 searches.                                                                                                                                                                                                             |
| **Qwen3.5 Plus**             | 10563           | âœ… Yes (3)       | ðŸŸ¡ **Good** | `T1491.001` (Defacement: Internal Defacement) âœ… â€” most precise sub-technique for flashing red screens. T1021 (Remote Services) for lateral movement âœ…. `Get-NetTCPConnection` lateral movement check âœ…. Correct two-scenario recovery framework (Scenario A backups / Scenario B no backups + preserve drives for future law-enforcement-released keys) âœ…. Micro-segmentation insight from Zero Networks 2026 guide âœ… â€” most current hardening source. "Preserve the encrypted drives for future decryption possibilities (keys sometimes released by law enforcement later)" âœ… â€” real precedent (HelloKitty/HelloGookie decryption keys released April 2024). FCC DA 26-96 ransomware guidance correctly cited âœ….                                                                                                                | "Ransomware attacks surged 30% in early 2026" from Breached.company âœ… directionally real (trend confirmed), but citing a news site rather than a primary threat intelligence source reduces authority. No specific ransomware family attribution (`.crypt` is generic, which is correct, but no families named at all). No specific decryptor mentioned.                                                                                                                                                                                                                                                                                                                                                                              |

> **Key Learnings:**
>
> 1. **Test goal not met â€” nomoreransom.org Rannoh Decryptor not surfaced in Config A, same as Config C.** Tavily's auto-parameter queries surface CISA/BleepingComputer/PCRisk â€” all real and useful sources â€” but not the specific CryptXXX decryptor page. The test design intentionally creates a hard retrieval task where only a targeted query (`site:nomoreransom.org .crypt CryptXXX`) reliably hits the correct page. Both Config A and Config C fail on this measure equally. Manual parameters remain the only reliable path to targeted decryptor retrieval.
> 2. **Gemini's Config A performance is dramatically better than Config C.** Config C: hallucinated RedAlert/N13V â€” the most dangerous wrong attribution across all 10 test cases. Config A: correctly named CryptXXX, Jigsaw, CryptON, and cited a real decryptor (RannohDecryptor). Same model, different search backend. This is the clearest evidence in the test suite that Tavily vs. SerpAPI affects output quality, not just efficiency â€” Tavily's more reliable search results directly prevented a hallucination.
> 3. **Opus hallucinated T1486.001** âŒ â€” T1486 has no sub-techniques in ATT&CK v16. Claude invented a sub-technique that does not exist in the canonical framework. This is the first ATT&CK sub-technique hallucination from an Anthropic model in this suite (GLM and Gemini had similar hallucinations in TC7/TC8). It demonstrates that sub-technique precision is a hallucination risk across all high-capability models, not just open-source ones.
> 4. **GPT's "don't attribute to a specific family without evidence" stance is the correct forensic posture** âœ… â€” and is now confirmed in Config A and Config C both. The `.crypt` extension is genuinely used by ARCrypter, Gomasom, CryptXXX, DynA-Crypt, Dharma, HelloKitty, Salted2020, and others. Any confident attribution from extension alone is speculation. GPT's 4 follow-up questions (OS type? ransom note? lateral spread? last action before infection?) are the correct first-response triage framework.
> 5. **Kimi's 3-attempt failure pattern in Config C vs. its 1-attempt success+reliability in Config A for TC8 highlights per-test-case instability.** In TC10 Config A, Kimi needed 3 attempts â€” 2 empty outputs â€” before the 3rd produced a solid, well-sourced response. This is not consistent behavior: TC8 Config A was clean. Kimi's failure mode appears to be related to specific prompt+context combinations (the ransomware scenario is more colloquial/stressful in framing) rather than a consistent search parameter error.
> 6. **GLM's M1053 label error (named "Remote Session Termination" instead of "Data Backup")** âŒ â€” getting the mitigation ID right but the name wrong is an unusual error pattern. GLM correctly looked up M1053 but appears to have cached the wrong label. In a SOC analyst workflow, the mitigation name is what gets documented in incident records â€” a wrong name paired with a correct ID creates audit confusion. Config A GLM's factual ransomware intelligence (DynA-Crypt, Dharma patterns, PCRisk sources) is solid; this is purely a taxonomy labeling error.
> 7. **Sonnet's `wmic shadowcopy call create` command is wrong** âŒ â€” this creates a new shadow copy rather than restoring from one. The correct restore path is `vssadmin` or Windows Explorer "Restore Previous Versions." If copy-pasted literally during a ransomware incident, this command creates a new VSS snapshot of already-encrypted data â€” unhelpful and potentially confusing. This is a high-severity copy-paste risk in a critical incident scenario, equivalent to Sonnet's Helm trailing-backslash bug from TC8.
> 8. **Config A token efficiency: GPT (22k, 4 searches) > Sonnet (14k, 3 searches) > Opus (15k, 3 searches) > GLM (13k, 3 searches) > Qwen (10k, 3 searches) > Gemini (28k, 4 searches) > Kimi (47k, 3 tries).** Qwen remains the most token-efficient searching model. Gemini's 28k for a less complete response (vs Sonnet's 14k for the most operationally complete one) continues the pattern from TC8. Kimi's 47k across 3 tries is the highest raw spend in Config A â€” the 2 failed attempts wasted ~38k tokens before the 9k response on the 3rd try.

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **5/7 searched.** Kimi failed completely (3 attempts, all empty). GLM needed 3 tries (2 SerpAPI errors). Qwen correctly did not search.
- **The key test goal** â€” surfacing the **nomoreransom.org Rannoh Decryptor** for CryptXXX â€” was **missed by all models that searched.** General ransomware response advice dominated over the specific decryptor lookup the spec expects.
- **Verdict: Technically functional but strategically wrong.** Models gave operationally competent generic ransomware IR, but SerpAPI Auto Parameters could not direct them to the specific, actionable decryptor that distinguishes a good response from a great one.

| Model                        | Tokens                     | Searched?           | Rating        | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------------------- | -------------------------- | ------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Qwen3.5 Plus**             | 3508                       | âŒ No               | ðŸŸ¢ **Best**   | Best output despite no search â€” 3,508 tokens. Correct containment priority: network isolation first, no shutdown. `vssadmin list shadows` to check for shadow copy deletion âœ…. CISA ransomware guide + NoMoreRansom + BleepingComputer cited as would-check sources. Honest self-correction note: "cannot browse live dark web or C2 feeds." CrySiS/Dharma as .crypt family attribution âœ… plausible. MITRE T1490 (Inhibit System Recovery) correctly mapped.                             | No search = no decryptor lookup. Did not surface the Rannoh Decryptor on nomoreransom.org (the stated test goal). `M1040` listed as a mitigation â€” that ID is not a standard MITRE D3FEND or ATT&CK mitigation code (M1040 = "Do Not Mitigate", unused in standard ATT&CK). Minor error.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Claude Opus 4.5**          | 44907                      | âœ… Yes (3)          | ðŸŸ¢ **Great**  | **Best structured output.** `DO NOT / DO IMMEDIATELY` framing is the most operationally clear warning block. `winpmem_mini_x64.exe` for RAM capture âœ… â€” real tool (Rekall/Velociraptor ecosystem), encryption keys may be in RAM. `Disable-ADAccount -Identity` for quick user lockout âœ…. Cell table of identification tools (ID Ransomware, No More Ransom, Emsisoft, Heimdal) is the most complete resource grid. External reporting table (FBI IC3, CISA, state AG, cyber insurance). | Did not find the CryptXXX-specific Rannoh Decryptor â€” linked to nomoreransom.org root, not the specific decryption page. CISA 2.62 billion blocked connections stat âœ… real (CISA 2025 annual report), but 5,263 incidents in 2024 â€” plausible from Allianz/Statista data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Claude Sonnet 4.5**        | 68922                      | âœ… Yes (3)          | ðŸŸ¢ **Great**  | `Disable-NetAdapter -Name "Ethernet" -Confirm:$false` isolation âœ… (most command-complete Windows isolation). `hexdump -C encrypted_file.crypt                                                                                                                                                                                                                                                                                                                                             | head -n 5`for encryption marker analysis.`shred -vfz -n 3 /dev/sda`for secure wipe âœ….`sha256sum`baseline comparison for post-restore verification. HelloKitty 2025 resurgence (April 2025, Cyberpress) âœ… real. Microsoft`Ransom:Win32/Filecoder.AHD!MTB`classification.`Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol` âœ….                                                                                                                                                                                                                                                                                                                                                                                            | Did not find the Rannoh Decryptor specifically. `iptables` firewall block on OUTPUT for SMB/RDP while ransom is active â€” risky to apply broadly on a server. `M1041 Encrypt Sensitive Data` as mitigation for ransomware is a weak mapping â€” encryption of data at rest doesn't prevent ransomware. |
| **GPT-5.2**                  | 110145                     | âœ… Yes (6)          | ðŸŸ¢ **Great**  | Best triage reasoning: explicitly flagged the scareware vs. ransomware disambiguation ("flashing red screen may be a browser scareware overlay OR a ransomware notice"). ConnectWise source âœ… real (Sep 2025). Norton scareware source âœ… real. "Do not assume a specific ransomware family from .crypt alone" â€” most epistemically responsible stance. 5 follow-up questions to narrow diagnosis are excellent triage practice.                                                          | 6 searches, 110,145 tokens for 3 real sources. Didn't find the Rannoh Decryptor. GPT's restraint from guessing a specific variant is correct but leaves the responder without the nomoreransom.org tip.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **GLM-4.7**                  | 8471+26576+99320 (3rd try) | âœ… Yes (3, 3rd try) | ðŸŸ¡ **Good**   | All 10 sources are real and verifiable (confirmed). Red CryptoApp (March 2024, Netenrich) âœ… real ransomware group. Dwell time 8 days (Packetlabs/Sophos) âœ… real 2025 stat. LockBit/Lynx/Virlock (HackerNews Feb 2025) âœ…. Priority hardening table with Citrix CVE-2023-4966 and MOVEit CVE-2023-34362 âœ… real CVEs. HIPAA Journal "58% increase" âœ… real stat. Complete critical checklist (10 items) including FBI IC3, cyber insurance, legal.                                        | **Needed 3 tries** â€” 1st: missing `q` error, 2nd: JSON parse from SerpAPI malformed response. Linking .crypt to "Red CryptoApp" is speculative â€” the red screen tactic is a visual match, but there's no documentation that Red CryptoApp uses `.crypt` extension. That said, GLM correctly framed it as "may correlate" rather than asserting it.                                                                                                                                                                                                                                                                                                                                                                                         |
| **Gemini Pro 3 Pro Preview** | 110103                     | âœ… Yes (4)          | ðŸŸ¡ **Fair**   | Correct containment steps (network isolate, `netsh advfirewall blockoutbound`). `id-ransomware.malwarehunterteam.com` tip âœ… correct.                                                                                                                                                                                                                                                                                                                                                      | **Critical hallucination: "Primary Suspect: N13V/RedAlert or CryptXXX"** âŒ â€” RedAlert/N13V targets **VMware ESXi servers**, uses **`.crypt658`** extension (not `.crypt`), and has **no documented "flashing red screen"** behavior. This attribution is baseless given the IOCs. Gemini invented a forensic linkage between the alert's "flashing red screens" â†’ RedAlert's name â†’ therefore RedAlert/N13V. This is a dangerous hallucination in a critical security incident â€” a responder could spend time hunting ESXi indicators on a Windows desktop ransomware case. CryptXXX â†’ .crypt âœ… legitimate, but packaging it with the false N13V claim taints the finding. 4 searches, 110,103 tokens for partially hallucinated output. |
| **Kimi-K2.5**                | 25576+59927+95779          | âŒ FAILED (3 tries) | ðŸ”´ **Failed** | â€”                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | **Complete failure across 3 attempts**: 1st: empty output `{}`. 2nd: 3 searches completed but output was only a 2-line warning note (truncated/incomplete). 3rd: empty output `{}` again. Total tokens burned: ~181,000+. The 2nd attempt shows the agent successfully ran 3 searches but then produced only a partial output before failing â€” this is a generation-level failure, not purely a search parameter error. The most inconsistent reliability pattern seen across all test cases for Kimi.                                                                                                                                                                                                                                     |

> **Key Learnings:**
>
> 1. **Test goal not met by any model: nomoreransom.org Rannoh Decryptor was not surfaced.** The expectation was that search would take responders to the specific CryptXXX decryptor on nomoreransom.org. Every searching model returned generic ransomware IR advice instead. This is the clearest Config C (Auto Parameters) failure to achieve targeted retrieval â€” Manual SerpAPI with `site:nomoreransom.org .crypt CryptXXX` would have hit the exact page.
> 2. **Gemini hallucinated a specific ransomware variant attribution** â€” RedAlert/N13V âŒ. RedAlert: (a) targets VMware ESXi servers, (b) uses `.crypt658` extension not `.crypt`, (c) has no documented flashing red screen behavior. Gemini pattern-matched "red screen" â†’ "RedAlert" (literally "Red Alert") â†’ incorrect forensic attribution. In an active CRITICAL security incident, attributing to the wrong ransomware family misdirects investigation (e.g., looking for ESXi-specific IOCs on a Windows host). This is the most dangerous individual error across all 10 test cases analyzed.
> 3. **Qwen's no-search output wins on cost-quality ratio** â€” 3,508 tokens for operationally complete advice. The ransomware scenario is actually well-handled from internal knowledge (contain â†’ identify variant â†’ NoMoreRansom â†’ restore from backup). The specific decryptor lookup (the test's stated goal) is the only thing a search could add â€” and no searching model found it anyway.
> 4. **Kimi's complete 3-attempt generation failure** â€” unlike previous SerpAPI parameter errors, the 2nd attempt shows Kimi successfully ran 3 searches but then output only 2 lines before producing `{}`. This is a **response generation failure**, not a search failure. The model started writing a response and then errored mid-way. Combined with attempts 1 and 3 being entirely empty, this suggests Kimi is unstable specifically when processing large amounts of returned search data in this configuration.
> 5. **GLM's "Red CryptoApp + red screen" linkage is speculative but carefully hedged** â€” GLM said "could correlate with the red screen pattern, though direct linkage to the .crypt extension is not explicitly documented." This is appropriately epistemic. Red CryptoApp is real (confirmed, Mar 2024), but the `.crypt` extension link is undocumented. GLM's hedging is the right approach vs. Gemini's confident false attribution.
> 6. **GPT's scareware disambiguation is the highest-quality triage insight** â€” No other model explicitly said "flashing red screens are a common scareware technique (browser overlay) that may co-occur with OR be unrelated to the .crypt file renames." This is operationally critical: if the screen is a browser popup, it changes the response entirely (clear browser â†’ not ransomware). GPT's 5 follow-up questions operationalize this uncertainty correctly.
> 7. **GLM's consistent SerpAPI error pattern (confirmed across 5 test cases):** TC1: `lr=en` error + `US location` error. TC2: 7 attempts, various errors. TC4: 7 attempts including JSON parse, complete failure. TC5: worked (4 searches). TC10: 3 tries, 2 failed. GLM consistently generates unsupported SerpAPI parameter combinations (`lr`, `uule`+`location` conflicts, malformed JSON tool calls). This is a calibration failure in GLM's tool-use layer â€” it overfits to Google Search API conventions rather than SerpAPI's specific parameter schema.
> 8. **On the open-source model reliability question:** The error pattern is model-specific, not cleanly "open source vs. proprietary." GLM (ZHIPU AI) has the worst SerpAPI parameter generation â€” 5 test cases with errors. Kimi (Moonshot AI) has generation failures (empty outputs). Qwen (Alibaba) has the _best_ search restraint in the suite. Claude and GPT have essentially zero SerpAPI errors. The Gemini hallucination (RedAlert) is from a proprietary model. Conclusion: **open-source lineage â‰  reliability problem; GLM's specific SerpAPI calibration is the primary failure driver.**

### 11. Adversarial / Irrelevant

**Goal:** Hard relevance filter â€” reject without invoking any tool.

```text
[ALERT] Coffee machine is out of beans. Error 418: I'm a teapot.
```

- **Expectation:** Dismiss as non-IT incident. Zero search calls. HTTP 418 / RFC 2324 resolvable from internal knowledge. Any tool invocation = failure.

#### ðŸ“Š Analysis Results â€” Config C (SerpAPI, Auto Parameters)

**Did any model invoke search?**

- **6/7 correctly did NOT search** âœ… â€” the strongest restraint pass across all test cases. The "coffee machine" framing should be immediately dismissible.
- **Gemini Pro 3 Pro Preview: FAILED** âŒ â€” 3 searches, **113,334 tokens**. Treated it as a real infrastructure alert about a WAF/Nginx misconfiguration returning HTTP 418.
- **Verdict: Excellent restraint for 6 models; catastrophic over-triggering for Gemini.** The humor/absurdity of the alert was sufficient for every model except Gemini to disengage search.

| Model                        | Tokens | Searched?     | Rating        | Key Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ---------------------------- | ------ | ------------- | ------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Claude Opus 4.5**          | 3370   | âŒ No         | ðŸŸ¢ **Best**   | Funniest and most perfectly calibrated. "â˜• Catastrophic (for developer morale)" severity. "CBO (Coffee Bean Owner)" escalation path. `$ eyes --inspect /dev/coffee/hopper` and `$ brew --type=espresso --shots=2` as CLI commands. RFC 2324 + RFC 7168 (HTCPCP-TEA) cited âœ… both real. "Lived experience of mass engineer panic" as source. PagerDuty alert at 20% bean capacity. Tone matches the alert perfectly.                                                                                     | Severity "Catastrophic" while declared "Low" â€” intentional humor but could confuse automated classification.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **Kimi-K2.5**                | 2814   | âŒ No         | ðŸŸ¢ **Best**   | Most technically detailed humorous response. `curl -X BREW "coffee://kitchen.local/pot-1" -H "Accept-Additions: cream,sugar"` âœ… valid HTCPCP syntax spirit. `PROPFIN` method reference âœ… (HTCPCP protocol method). RFC 2324 (1998) + RFC 7168 (2014) both cited âœ…. "PEBKAC (Problem Exists Between Keyboard And Cup)" â€” most creative root cause label. "Encrypted storage recommended" for beans. `(No search required â€” RFC 2324 knowledge is retained in organic memory)` â€” best source disclaimer. | `curl -X BREW ... --stop` flag doesn't exist in curl, but this is deliberate humor.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Claude Sonnet 4.5**        | 3592   | âŒ No         | ðŸŸ¢ **Great**  | `curl -X POST http://coffee-machine.local/brew -d '{"type":"espresso","size":"double"}'` â€” most complete IoT API mockup. `{"status": 200, "message": "Brewing commenced"}` expected response. P2/P3 priority classification with "critical sprint period" caveat â€” operationally aware humor. RFC 2324 âœ…. "Self-diagnostic capability: device correctly identified its inability to fulfill requests" â€” technically correct framing.                                                                     | MITRE N/A correctly stated. Tone is slightly more formal than Opus/Kimi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **Qwen3.5 Plus**             | 3018   | âŒ No         | ðŸŸ¢ **Great**  | `open_hopper_lid && visual_inspection --level` bash style. MITRE N/A âœ…. Vendor firmware configuration suggestion ("customize to 'Out of Beans' instead of RFC 2324 joke"). MDN + RFC 2324 as sources âœ… both real. "Cultural Significance: one of the most recognized Easter egg status codes" â€” correct framing.                                                                                                                                                                                        | Shortest response of the no-search group â€” slightly less creative than Opus/Kimi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **GLM-4.7**                  | 2849   | âŒ No         | ðŸŸ¢ **Great**  | Three post-incident questions ("Did someone deploy an April Fools' firmware patch? Is there a GitHub repo for this machine we should star?") â€” most playful meta-commentary. "First documented case of HTCPCP error codes appearing in physical coffee appliances" â€” clever framing. Explicitly flagged no search tools: "this incident relies on established knowledge of RFC 2324."                                                                                                                     | `look_at_coffee_hopper --verbose` is creative but lower-effort than Kimi's HTCPCP-aware commands.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **GPT-5.2**                  | 2023   | âŒ No         | ðŸŸ¢ **Great**  | **Lowest token count (2,023)** â€” most efficient. Most operationally practical (no humor): real hopper jam troubleshooting, bean-level sensor cleaning, proper soft-reset procedure. Correct note about 418 monitoring system mis-mapping (`fix so device-specific faults don't surface as misleading HTTP codes`).                                                                                                                                                                                        | Did not engage with the humor at all â€” treats it as a literal operations ticket. GPT's response is technically excellent but misses the spirit of the test (which itself is humorous). No RFC reference.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **Gemini Pro 3 Pro Preview** | 113334 | âœ… FAILED (3) | ðŸ”´ **Failed** | Correctly identified RFC 2324 as the origin of 418. The secondary IoT path ("refill beans / power cycle") is technically sound. `curl -I -v http://[device-ip]/brew` diagnostic suggestion is reasonable if taken literally.                                                                                                                                                                                                                                                                              | **Complete test failure** â€” 3 searches, 113,334 tokens to handle a coffee machine joke. Gemini's "Primary Cause: WAF/Bot Mitigation Policy" reframing is wrong: while Nginx _can_ be configured to return 418 (technically possible âœ…), it is **not a common default, not a standard WAF practice**, and not what the alert says. The alert text says "Coffee machine is out of beans" â€” no WAF inference is warranted. Gemini over-anchored on the HTTP 418 code and discarded the semantic content of the alert. This is the opposite pattern from TC10 (where Gemini pattern-matched too hard on names) â€” here Gemini pattern-matched too hard on the status code number, ignoring context. |

> **Key Learnings:**
>
> 1. **6/7 restraint pass â€” best adversarial test result in the suite.** The explicit "Coffee machine" phrasing + bean depletion context was sufficient to signal non-IT incident to all models except Gemini. The absurdity filter works at scale when the signal is this obvious.
> 2. **Gemini's failure reveals a systematic pattern: over-anchoring on technical artifacts.** In TC10, Gemini pattern-matched "red" â†’ "RedAlert" (name match). In TC11, Gemini pattern-matched "418" â†’ WAF/Nginx infrastructure issue (code match), discarding the surrounding natural language context ("Coffee machine is out of beans"). Both errors share the same failure mode: extracting a technical token and running with it, ignoring the broader semantic signal. This is a prompt-comprehension calibration issue specific to Gemini under SerpAPI Auto Parameters.
> 3. **Gemini's WAF/418 claim is misleading.** While `return 418;` in Nginx is _possible_ (confirmed via search), it is not a standard, common, or recommended bot-protection technique â€” MDN, Cloudflare, and security practitioners all advise against using 418 as a WAF response due to its non-standard semantics. Gemini framed a niche developer Easter egg as the "primary cause," which is both contextually wrong and technically overconfident.
> 4. **Opus wins on humor quality; GPT wins on efficiency.** This test has two valid response strategies: (a) embrace the humor and match the alert's tone â€” Opus/Kimi do this best; (b) treat it as a literal low-priority facilities ticket â€” GPT does this at 2,023 tokens with zero waste. Both are correct. GLM's meta-commentary ("Is there a GitHub repo for this machine?") is the most self-aware response.
> 5. **RFC 2324 and RFC 7168 are correctly cited as real documents by all no-search models.** RFC 2324 (Hyper Text Coffee Pot Control Protocol, April 1, 1998) âœ… and RFC 7168 (HTCPCP-TEA, April 1, 2014) âœ… are both actual published IETF RFCs. This is a confidence test for internal knowledge â€” all 6 passing models had this correct without searching.
> 6. **On Qwen's consistently strong search-restraint across all test cases:** This is not random. Qwen3.5 Plus has correctly abstained in TC1 (Disk Full), TC3 (Nginx Syntax), TC4 (Java OOM), TC10 (Ransomware), and TC11 (Coffee Machine). It searched only in TC2 (SSH Brute Force) and TC5 (Node.js regression) â€” the two cases where search is genuinely necessary. Qwen appears to have a well-calibrated internal uncertainty threshold: it searches when the query contains a specific version, CVE, or externally-verifiable technical claim, and abstains when the incident is diagnosable from first principles. **This is the ideal search-trigger behavior.** Qwen produces near-Gemini quality output at 10â€“20% of Gemini's token cost across this test suite.

### 12. Novel Incident â€” Graceful "No Results" Handling

**Goal:** Agent searches, finds nothing, admits it â€” does NOT hallucinate a CVE.

```text
[SIEM] Unknown exploit pattern detected
Target: Internal Kubernetes API Server (v1.28.3)
Technique: Unauthenticated API response deserialization crash
Error in kube-apiserver logs: "unexpected EOF during panic recovery"
First occurrence: 30 minutes ago. No public CVE assigned.
```

- **Expectation:** Agent runs 1â€“2 searches, finds no matching documented CVE, clearly states "No documented public CVE found for this exact pattern." Provides escalation path: enable Kubernetes audit logging, isolate API server, report to Kubernetes security list.
- **Manual vs Auto Delta:**
  - **Manual (Tavily, `timeRange: month`, `includeAnswer: false`):** Forces recency; no pre-synthesised answer reduces hallucination risk.
  - **Auto:** May surface loosely related old Kubernetes CVEs â€” agent might hallucinate a match.

---

## ðŸ“Š Evaluation Scorecard

Use this per test run to compare Configs A/B/C/D:

| Criterion                   | Description                                                                         |
| --------------------------- | ----------------------------------------------------------------------------------- |
| **Search Trigger Accuracy** | Did it search when needed, skip when not? (Tests 1, 3, 9, 11 = zero calls expected) |
| **Query Precision**         | Generic ("Java OOM") vs. targeted ("Spring Boot 3.2.1 OOM batch 2024")?             |
| **CVSS Accuracy**           | Did it return the correct score? (Tests 7, 8 â€” 9.8, not "High")                     |
| **Source Authority**        | NVD/AWS docs vs. blog post? Manual domain pinning should improve this.              |
| **Vendor Doc Mismatch**     | Did it catch the RDS-EVENT-0056 message mismatch? (Test 6)                          |
| **Manual vs Auto Gap**      | Did manual parameters produce a meaningfully better result than auto?               |
| **No-Result Honesty**       | For Test 12 â€” did it admit the gap instead of hallucinating a CVE?                  |

---

## ðŸ”¬ Parameter Deep-Dive: GLM Auto vs No-Auto (Tavily)

_Single-model, single-variable comparison across 3 test cases â€” isolates the effect of Tavily's `Auto Parameters` toggle with no other variable changing._

> **Context:** "Not Setting Auto" means the workflow sends the query to Tavily with **no special parameter overrides**. Tavily uses its own defaults. "Auto Parameters" means the LLM node is explicitly told to generate/optimize Tavily search parameters automatically. This is **not** a Manual vs Auto comparison â€” both modes are fully agentic; the only difference is whether the LLM constructs Tavily query parameters or lets Tavily run with its own defaults.

### TC6 â€” AWS RDS (RDS-EVENT-0056)

|                 | Auto Parameter | No-Auto (No Setting) |
| --------------- | -------------- | -------------------- |
| **Tokens**      | 8,754          | 7,316                |
| **Searches**    | 2              | 2                    |
| **Token delta** | +1,438 (+20%)  | â€”                    |

**Auto Parameter output:**

- RDS-EVENT-0036 link to exact subnet message âœ… â€” distinguished the event codes precisely
- SQL Server caveat: `start-db-instance` does NOT work for RDS SQL Server âœ… â€” real, documented AWS limitation
- `AWSSupport-ValidateRdsNetworkConfiguration` runbook âœ…
- 4 authoritative AWS sources

**No-Auto output:**

- CloudFormation failure scenario âœ… â€” valid cause not mentioned in Auto output; IaC teams need this
- PITR + snapshot recovery path âœ… â€” adds "Option 2" restore to new instance with corrected network, wider recovery coverage
- Issue-type structured table (Non-existent subnet / Exhausted IP pool / CF rollback) âœ… â€” most scannable resolution framework
- `DeletionPolicy` + `UpdateReplacePolicy` IaC guardrails âœ… â€” best hardening advice for preventing recurrence
- CloudWatch Events state transition monitoring âœ…
- **Missing:** SQL Server caveat from Auto output â€” significant gap for SQL Server RDS users

**Verdict: ðŸŸ¡ Near-Tie â€” No-Auto wins on recovery coverage; Auto wins on SQL Server caveat**

> No-Auto is 16% cheaper (7,316 vs 8,754 tokens) and adds more recovery paths (CloudFormation failure, PITR, new instance restore). Auto's SQL Server `start-db-instance` caveat is the only differentiating piece of factual content missing from No-Auto. For this test case, **not setting the parameter produces a marginally better output at a lower cost.**

---

### TC7 â€” Apache Tomcat (CVE-2025-24813)

|                 | Auto Parameter | No-Auto (No Setting) |
| --------------- | -------------- | -------------------- |
| **Tokens**      | 15,940         | 43,758               |
| **Searches**    | 2              | 5                    |
| **Token delta** | â€”              | +27,818 (+175%)      |

**Auto Parameter output:**

- Fixed version: **10.1.35** âœ… â€” correct
- CISA KEV status âœ… with **April 22, 2025** deadline âœ… (real)
- EPSS: **0.94183** âœ… (real Tenable stat)
- Canada Cyber Centre AV25-127 âœ… â€” real advisory confirming no-auth exploitation
- `grep -A 5 "DefaultServlet"` config check âœ…
- 2 searches / 15,940 tokens â€” clean and efficient

**No-Auto output:**

- Fixed version stated as **"10.1.36+"** âŒ â€” **critical factual error**. The actual patched version for the 10.1.x branch is **10.1.35** (confirmed Apache official advisory + NVD). The download step even specifies `apache-tomcat-10.1.36.tar.gz` â€” a version that wouldn't exist at time of incident. A responder following this literally would be unable to find the patch.
- Vulnerable range stated as "10.1.1 through **10.1.35**" âŒ â€” incorrect (correct upper bound is 10.1.34; 10.1.35 is the fix)
- Metasploit module `exploit/multi/http/tomcat_partial_put_deserialization` âœ… â€” **real** (confirmed Rapid7/Sploitus; contributed by Calum Hutton + h4ck3r-04)
- Akamai WAF rules **3000072 and 3000957** âœ… â€” real (from Akamai detection blog)
- `find $CATALINA_BASE/work -name "*.session" -mtime -1` âœ… â€” best forensic check for suspicious session files, not in Auto
- Palo Alto Unit42 cited âœ… â€” real analysis
- Content-Range header technicality + `java.net.URL` deserialization callback detail âœ… â€” more technically precise on exploit mechanism
- T1505.003 (Web Shell sub-technique) âœ… â€” more specific than Auto's T1505 parent
- `sed -i 's/readonly="false"/readonly="true"/g'` mitigation âœ… â€” efficient one-liner
- 5 searches / 43,758 tokens â€” **most expensive single output in this comparison**

**Verdict: ðŸ”´ Auto wins decisively**

> No-Auto's fixed version error (`10.1.36` instead of `10.1.35`) is a **critical, high-severity factual error** in a patch instruction. No-Auto also spent **175% more tokens** (43,758 vs 15,940) and fired **5 searches** vs 2 â€” yet produced a factually wrong core remediation command. This is the clearest case in this comparison where **more searches and more tokens produced a less accurate result**. Auto's 2-search, 15,940-token output has the correct fixed version and all key mitigation details. No-Auto's richer forensic content (Metasploit module, session file check, WAF rule numbers) does not compensate for a patch version that doesn't exist at the time of incident.

---

### TC8 â€” IngressNightmare (CVE-2025-1974)

|                 | Auto Parameter | No-Auto (No Setting) |
| --------------- | -------------- | -------------------- |
| **Tokens**      | 23,870         | 15,069               |
| **Searches**    | 3              | 3                    |
| **Token delta** | +8,801 (+58%)  | â€”                    |

**Auto Parameter output:**

- EPSS: **0.90653** âœ… â€” real Tenable stat (high exploitation probability)
- EDB-ID 52475 âœ… â€” real Exploit-DB entry (Ingress-NGINX Admission Controller FD Injection to RCE)
- Huawei CCE caveat: clusters **< v1.25** must upgrade cluster before applying ingress fix âœ… â€” real vendor-specific guidance
- Ingress NGINX **retirement March 2026** âœ… â€” unique callout for migration planning
- SHA256 image hash: `registry.k8s.io/ingress-nginx/controller:v1.11.5@sha256:a1cbad75...` âœ… â€” highest precision deployment command
- 8 sources cited (NVD, Tenable, Arctic Wolf, ProjectDiscovery, Huawei, BMC, Exploit-DB, GitHub)
- T1078 (Valid Accounts via service account abuse) âœ… â€” appropriate extra technique
- Wiz Research researchers NOT named

**No-Auto output:**

- Researchers named: Nir Ohfeld, Ronen Shustin, Sagi Tzadik, Hillai Ben Sasson (Wiz Research) âœ… â€” adds attributional authority
- Exploit mechanism: **`ssl_engine` directive + client body buffers** âœ… â€” correctly describes the actual exploitation path (Auto omits this technical detail)
- `kubectl logs ... | grep -i "ssl_engine\|/proc/\|client_body_buffer"` âœ… â€” most forensically precise detection strings in the comparison
- NetworkPolicy YAML block âœ… â€” more concrete network containment than Auto
- **Helm chart version: `--version 4.11.0`** âŒ â€” **wrong**. Helm chart 4.11.0 packages controller **v1.11.1** (a vulnerable version). The correct chart for the patch is **4.11.5** (packages v1.11.5). A responder using this `helm upgrade` command would deploy a **still-vulnerable** controller.
- **T1056.001 (Input Capture: Keylogging)** âŒ for Kubernetes Secrets access â€” **wrong technique**. T1056.001 describes keyboard/credential capture (keylogging). The correct technique for reading cluster Secrets is **T1552 (Unsecured Credentials)** or **T1552.007 (Container API)**. This is a conceptual MITRE misuse, not just a nuance.
- 40% cluster exposure claimed âœ… (Wiz said 43%, but rounding is acceptable)

**Verdict: ðŸŸ¡ Auto wins on accuracy; No-Auto wins on depth**

> Auto's higher token count (23,870 vs 15,069, +58%) delivers broader context: EPSS, EDB-ID, EOL warning, image SHA, and Huawei cluster-version caveat. No-Auto delivers better technical depth on the exploit mechanism and forensics, but its **Helm chart version error is deployment-critical** â€” a `helm upgrade --version 4.11.0` command would upgrade to v1.11.1, which is still in the vulnerable range. Combined with the T1056.001 taxonomy error, No-Auto has two independent factual failures that Auto avoids.

---

### Cross-Case Summary: Does Setting Auto Parameters = More Tokens?

| Test Case                  | Auto Tokens | No-Auto Tokens | Delta   | Who Spent More      |
| -------------------------- | ----------- | -------------- | ------- | ------------------- |
| **TC6 (RDS)**              | 8,754       | 7,316          | âˆ’1,438  | Auto (+20%)         |
| **TC7 (Tomcat)**           | 15,940      | 43,758         | +27,818 | **No-Auto (+175%)** |
| **TC8 (IngressNightmare)** | 23,870      | 15,069         | âˆ’8,801  | Auto (+58%)         |
| **Total**                  | **48,564**  | **66,143**     | +17,579 | No-Auto (+36%)      |

> **Conclusion: Enabling Auto Parameters does NOT consistently lead to higher token spend.** In TC6 and TC8, Auto used more tokens; in TC7, No-Auto used 175% more. Across all three tests combined, **No-Auto spent 36% more total tokens** (66,143 vs 48,564). The parameter mode affects _how the model structures its search queries_, not how much it searches â€” the model's search loop termination logic is the primary driver of token count, not the parameter mode.

### Overall Quality Ratings

| Test Case                | Auto Rating | No-Auto Rating | Winner                                         |
| ------------------------ | ----------- | -------------- | ---------------------------------------------- |
| **TC6 (RDS-EVENT-0056)** | ðŸŸ¢ Good     | ðŸŸ¢ Good        | ðŸŸ¡ Near-Tie (No-Auto slightly better coverage) |
| **TC7 (CVE-2025-24813)** | ðŸŸ¢ Best     | ðŸ”´ Failed      | âœ… **Auto wins decisively**                    |
| **TC8 (CVE-2025-1974)**  | ðŸŸ¢ Best     | ðŸŸ¡ Good        | âœ… **Auto wins on accuracy**                   |

### Key Learnings

> 1. **Auto Parameters is not a token cost multiplier** â€” it's a query structuring tool. Across 3 tests, toggling Auto on/off changed _which searches fired_ (and thus what information was retrieved), not strictly _how many_ searches. TC7 No-Auto fired 5 searches and spent 175% more than Auto's 2 â€” this is a search termination architecture issue, not a parameter setting issue.
> 2. **No-Auto's TC7 version error (10.1.36 instead of 10.1.35) is the highest-severity single error in this comparison** âŒ â€” it directly directs a responder to download a version that a) doesn't exist at time of incident and b) would not contain the patch. The correct fixed version for Apache Tomcat 10.1.x is 10.1.35. This error appeared despite 5 searches and 43,758 tokens â€” more search effort produced an inaccurate result.
> 3. **No-Auto's TC8 Helm chart error (4.11.0 instead of 4.11.5) is deployment-critical** âŒ â€” `helm upgrade --version 4.11.0` would install the ingress-nginx controller at v1.11.1, which is inside the CVE-2025-1974 vulnerable range. A responder copy-pasting this command would patch to a vulnerable version. The correct Helm chart for the CVE-2025-1974 fix on the 1.11.x track is 4.11.5.
> 4. **T1056.001 (Keylogging) for Kubernetes Secrets access is a category error** âŒ â€” T1056 covers keystroke/input capture from a human. Kubernetes Secrets accessed via the API by a compromised service account is T1552 (Unsecured Credentials) or more precisely T1552.007 (Credentials in Container APIs). GLM No-Auto appears to have pattern-matched "secrets access" â†’ "credential capture" â†’ T1056 without checking the ATT&CK description.
> 5. **Auto Parameters produced more verifiably correct outputs in 2 of 3 tests.** Its advantages are consistent: reliable source selection (CISA over blog posts), accurate version numbers, and bounded search loops (2â€“3 searches). Where No-Auto wins (TC6 recovery paths, TC8 ssl*engine explanation) the advantage is in \_additional depth*, not in correcting Auto's errors â€” Auto made no significant factual errors across all three test cases.
> 6. **GLM's Auto mode calibrates source authority better.** Auto outputs cite NVD, CISA, Tenable, Canada Cyber Centre. No-Auto outputs cite SonicWall, Wiz DB, XM Cyber, Keysight â€” all real but lower authority. This suggests the Auto parameter guidance shapes query construction toward official advisories, while unconstrained No-Auto searches pull from a broader, lower-authority pool.
> 7. **The greatest value of the Auto toggle is error prevention, not quality uplift.** No-Auto's outputs are not uniformly worse â€” they surface genuinely useful details (Metasploit module, session file forensics, CloudFormation recovery). But they introduce factual errors that Auto avoids. For a SOC analyst in an active incident, a response with a wrong patch version is worse than a response with fewer details but correct instructions.
